<!DOCTYPE html>
<!-- saved from url=(0105)https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436326 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style>
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
</style><meta name="google" content="notranslate"><meta http-equiv="Content-Language" content="en"><title>sparkml_lab - Databricks Community Edition</title><link rel="preload" href="https://community.cloud.databricks.com/pub-conf" as="fetch" crossorigin=""><link rel="preload" href="https://community.cloud.databricks.com/workspaces" as="fetch" crossorigin=""><link rel="icon" href="https://community.cloud.databricks.com/favicon.ico"><link rel="preload" href="https://community.cloud.databricks.com/js/8973.cd76cfcf.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/js/7807.5048a39e.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/js/7032.28b1c9d1.chunk.js" as="script"><link rel="preload" href="./sparkml_lab - Databricks Community Edition_files/3641.7d0a57ea.chunk.css" as="style"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/9135.615fe693.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/7856.670e4c0b.chunk.css"><script type="text/javascript" async="" src="./sparkml_lab - Databricks Community Edition_files/heap-3428506230.js.download"></script><script src="./sparkml_lab - Databricks Community Edition_files/remoteEntry.js.download" async=""></script><script src="./sparkml_lab - Databricks Community Edition_files/remoteEntry.js(1).download" async=""></script><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/9624.7d6c7d60.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/2651.8f007618.chunk.css"><style data-emotion="css" data-s=""></style><style data-emotion="css" data-s=""></style><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/3641.7d0a57ea.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/ClustersCreatePage.f9d27361.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/media/spinner_green.b9455049.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/spinner_red.e709549b.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/pin-inactive.20f63293.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/pin-active.b76ded7a.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/jupyter_favicon.3567d082.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/azure_devops_logo_hover.4f1e3fd4.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/azure_devops_logo.8e2ba35d.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/glyphicons-halflings.25163399.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/newslablight-webfont.9b543473.eot"><link rel="prefetch" href="https://community.cloud.databricks.com/media/newslablight-webfont.69cfbff8.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/newslablight-webfont.a432b296.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/newslablight-webfont.ac42ae0f.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/newslablight-webfont.947cf4d7.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/databricks-regular-webfont.421acd19.eot"><link rel="prefetch" href="https://community.cloud.databricks.com/media/databricks-regular-webfont.ffd92669.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/databricks-regular-webfont.ab15115e.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/databricks-regular-webfont.9c3c6e3b.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.f7c2b4b7.eot"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.d9ee23d5.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.706450d7.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.29800836.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.674f50d2.eot"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.af7ae505.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.fee66e71.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.b06871f2.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fontawesome-webfont.912ec66d.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_AMS-Regular.3d8245dc.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_AMS-Regular.ac1d46d9.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_AMS-Regular.c67be87a.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Caligraphic-Bold.970d3e76.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Caligraphic-Bold.445f96a3.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Caligraphic-Bold.3f61a84d.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Caligraphic-Regular.0ef0f2e3.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Caligraphic-Regular.74f6918c.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Caligraphic-Regular.c3bc8fce.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Fraktur-Bold.950649ba.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Fraktur-Bold.1aca7ef7.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Fraktur-Bold.e11e6bf0.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Fraktur-Regular.135ccd74.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Fraktur-Regular.c5b430bf.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Fraktur-Regular.a9509497.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Bold.82bce349.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Bold.29d4b276.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Bold.db576c7d.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-BoldItalic.13900e55.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-BoldItalic.3f3be43b.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-BoldItalic.cec43f72.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Italic.b488f60f.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Italic.f8a75448.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Italic.85b3329f.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Regular.999cd6ba.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Regular.485696cf.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Main-Regular.f4fe6dca.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Math-Italic.7a31741a.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Math-Italic.8eb56b3f.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Math-Italic.10740d74.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Bold.0d0f967a.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Bold.99bd8743.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Bold.771a1f95.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Italic.b1ac79b9.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Italic.9c3f03ec.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Italic.cb729d47.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Regular.23f1730f.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Regular.fc908397.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_SansSerif-Regular.43b0cb92.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Script-Regular.ae1fad1f.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Script-Regular.60febfa1.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Script-Regular.e9169ca7.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size1-Regular.fda0824e.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size1-Regular.1d6cf6b8.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size1-Regular.f2e296ef.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size2-Regular.a7a0eb93.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size2-Regular.f48e83b7.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size2-Regular.0767ede6.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size3-Regular.397bd687.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size3-Regular.0387ab38.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size3-Regular.882f7234.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size4-Regular.3c14ed11.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size4-Regular.726db3bd.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Size4-Regular.27901d5c.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Typewriter-Regular.895baecf.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Typewriter-Regular.696705de.woff"><link rel="prefetch" href="https://community.cloud.databricks.com/media/KaTeX_Typewriter-Regular.6374f53e.ttf"><link rel="prefetch" href="https://community.cloud.databricks.com/media/mrl8jkM18OlOQN8JLgasD4a1YDtoarzwSXxTHggEXMw.38bca7eb.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/mrl8jkM18OlOQN8JLgasD5bPFduIYtoLzwST68uhz_Y.72b61933.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/leqv3v-yTsJNC7nFznSMqe4s1Ux4PuImWPk5fSr6HPL3rGVtsTkPsbDajuO5ueQw.e82262e6.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/leqv3v-yTsJNC7nFznSMqZkF8H8ye47wsfpWywda8og.5e7f98de.woff2"><link rel="prefetch" href="https://community.cloud.databricks.com/media/spritemap.a012b1b1.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/spritemap@2x.cfe9d800.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/bmt-favicon.24e70a2e.ico"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/spinner.7eb0071e.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/BMT_logo_large.55205282.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/databricks_community_edition.4b5df8f5.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/ml_dashboard_ill_reference_solutions.c74a54c9.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/ml_dashboard_ill_notebook.db945e2d.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/ml_dashboard_ill_training.18f44263.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/ml_dashboard_ill_automl.69cb20ad.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/persona_nav.d621ebcf.gif"><link rel="prefetch" href="https://community.cloud.databricks.com/media/import_illustration.a8f8f5b5.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/notebook_illustration.0ed82de6.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/quickstart_illustration.8855f289.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/references_illustration.dfe73a7e.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/mlflow_notebook_revision_icon.fb30c75b.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/mlflow_cluster_spec_icon.e1a9d318.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/mlflow_cluster_libraries_icon.1e1bbbe8.svg"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/if_lightbulb.32b79969.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/ellipse-2s-30px.d5e7584e.gif"><link rel="prefetch" href="https://community.cloud.databricks.com/media/us-map.be17f64a.json"><link rel="prefetch" href="https://community.cloud.databricks.com/media/world-map.733c99c2.json"><link rel="prefetch" href="https://community.cloud.databricks.com/media/countries.geo.5db0e8c2.json"><link rel="prefetch" href="https://community.cloud.databricks.com/media/usa-albers.geo.1cf0a200.json"><link rel="prefetch" href="https://community.cloud.databricks.com/media/japan.prefectures.geo.069f1b22.json"><link rel="prefetch" href="https://community.cloud.databricks.com/media/General_icon.e1d0c7d0.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/Python_icon.26f13d73.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/R_icon.9b70c497.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/Scala_icon.bf5e6302.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/add_data_icon.84c14774.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/code_icon.db13a367.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/help_doc_icon.cc60a36f.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/icon-import-data.e32bacc6.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/icon-new-notebook.b1dacb7d.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/icon-quickstart-notebook.6697345f.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/icon-upload-data-non-drop-zone.a8a27e15.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/icon-upload-data.38e1c933.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/antd.bcd37934.css"><link rel="prefetch" href="https://community.cloud.databricks.com/media/collapsingAllIcon.ea2ba3e2.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/expandingAllIcon.283f7837.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fa-table.2e493944.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fa-columns.5d83e3d5.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/circle_error.8849b329.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/spinner_blue.5bbd1389.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/book.62733eae.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/cloud.1390841c.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/cluster.86641204.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/folder.3e1ec9d1.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/table.7d5d5c93.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/blocked.45685ab0.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/cancelled.4bc27f62.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/failed.c99465d9.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/paused.8a47333a.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/pending.d8c4da3b.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/running.e7c53db1.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/skipped.aef55ce4.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/success.3e049e69.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/terminated.f4228a0e.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/timed_out.d157a510.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/waiting.f0a3fcaf.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/warning.1bba9d60.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/filled-green-circle.9c2a21ef.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/filled-gray-circle.e6721f2a.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/data-quality.c8deeaa9.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/stitch.ef1319b5.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/fivetran.3e6c82f5.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/qlik.87633461.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/infoworks.ad724fa0.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/streamsets.b85b03e8.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/syncsort.11608e03.jpg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/placeholder_pic.4788048f.png"><link rel="prefetch" href="https://community.cloud.databricks.com/media/view_notebook_revision.60fa88c5.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/logged_model.52a4e455.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/media/registered_model.8745ea83.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/login/login.01615f82.js"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/main.04ca75c7.js.download"><link rel="prefetch" href="https://community.cloud.databricks.com/js/metrics-graphics.8c6e7309.js"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/spinner.gif"><link rel="prefetch" href="https://community.cloud.databricks.com/login/DB_Azure_Lockup_2x.png"><link rel="prefetch" href="https://community.cloud.databricks.com/login/bootstrap.min.css"><link rel="prefetch" href="https://community.cloud.databricks.com/login/databricks_ce_icon.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/login/databricks_logoTM_rgb_TM.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/login/favicon.ico"><link rel="prefetch" href="https://community.cloud.databricks.com/login/logo_2020/azure_databricks.png"><link rel="prefetch" href="https://community.cloud.databricks.com/login/logo_2020/databricks.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/login/logo_2020/databricks_community_edition.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/databricks.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/download.svg"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/retrieve_config.html"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/sharing.css"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/sharing.js"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/apachespark.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/atscale.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/azuresynapse.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/bigquery.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/databricks.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/dremio.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/looker.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/pandas.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/powerbi.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/presto.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/python.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/qlik.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/starburst.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/tableau.png"><link rel="prefetch" href="https://community.cloud.databricks.com/delta_sharing/logo/trino.png"><link rel="prefetch" href="https://community.cloud.databricks.com/static/iframe.html"><link rel="prefetch" href="https://community.cloud.databricks.com/static/css/sparkui-iframe.css"><link rel="prefetch" href="https://community.cloud.databricks.com/static/js/heap/heap-1473692602.js"><link rel="prefetch" href="https://community.cloud.databricks.com/static/js/heap/heap-210092139.js"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/heap-3428506230.js.download"><link rel="prefetch" href="https://community.cloud.databricks.com/login/3077.b927db57.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/2651.8f007618.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/login/7350.5e4b0092.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/737.70b5f1a6.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/css/6098.66f4e205.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/5463.7317c73b.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/GraphqlClustersGetPage.e5ed6c09.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/NewClustersEditPage.f9d27361.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/ClustersMainPage.5bac6c88.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/SimpleClusterCreatePage.f9d27361.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/ClustersCreatePage.f9d27361.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/PoolRoutesPages.2d460e38.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/ClusterPoliciesRouteUtils.5bac6c88.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/AdminConsoleView.588802ae.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/UserSettingsView.b3d41c61.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/LibraryView.422f590b.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/ClustersGetMetricsPage.f9d27361.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/JobCreatePage.ca65da6a.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/JobClusterPage.f9d27361.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/QueryJobDetailsPage.ca65da6a.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/JobViewWithGraphql.f9d27361.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/JobsMainPage.9edf7d02.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/PipelineDetailsPage.b7ebe9a2.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/MLDashboardPage.2dffe569.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/ExperimentObservatoryPage.79e545d3.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/AutoMLConfigurationPage.a5fb753e.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/CreateMlflowExperimentPage.93e07247.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/LatestJobRunViewContainer.20334262.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/JobRunView.20334262.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/ReactNotebookView.c32ea7d2.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/ScheduleLink.b6cfefd1.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/DashboardEditView.5eb76997.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/DashboardPresentView.de6a5e8b.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/TableGetPage.a5fb753e.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/8848.f9d27361.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/9708.a5fb753e.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/2694.18fe782c.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/4473.18fe782c.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/3641.7d0a57ea.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/6662.035b535e.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/5061.3223f1fe.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/2510.90a8b767.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/9749.e636248e.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/7236.f0a63aed.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/5334.6c0c1860.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/9135.615fe693.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/css/554.3d36fa44.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/7856.670e4c0b.chunk.css"><link rel="prefetch" href="./sparkml_lab - Databricks Community Edition_files/9624.7d6c7d60.chunk.css"><link rel="prefetch" href="https://community.cloud.databricks.com/login/3077.a124ec08.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/8188.c7a4b3b5.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/4963.872a6506.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2651.e758324e.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/2176.385c81d2.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/8705.e5c47eb7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2542.451b603d.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6098.016214ed.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5463.9b84f06c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6471.92998f3a.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4602.68fc4997.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2851.a800e6b3.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7028.b63f75b7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9463.543cce73.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7274.76443fa2.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8540.3771363c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3235.c207d1ec.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5198.e9a1d977.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9152.3e58f157.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6362.33242795.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7032.28b1c9d1.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2662.7f44c2cc.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1511.d6892fe7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5355.41580bc9.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7176.52b8c28a.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9946.a5cdd01e.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1730.1851bdf0.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2532.fb6dde15.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5489.e65cb5a3.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8513.729f6df8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7676.eff12f55.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3214.e1a18c35.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2667.5a9cca2f.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3637.c0e05156.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2689.36e72a21.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9981.51246884.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5197.446dac22.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8732.a800484c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3449.b623cf26.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/199.9e607c2d.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3345.506cffce.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8553.1415e205.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6595.e1de59c8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/419.e11acb40.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2380.d15f58d8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/80.d7d62d5c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5070.9a493618.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8571.828d2cb0.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7749.e9e838df.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9957.79ba18a5.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7994.68bbe55c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2882.225d0ae8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8985.0b5a78e1.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4227.c0d821b6.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8848.89a705c0.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9708.344870d5.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4473.e8f4094b.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6808.208fe661.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5225.29d1a599.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6439.09246fa7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6665.c1e21397.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5896.ee48b333.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3878.9114c018.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4724.05d6c913.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2135.b0757e86.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8671.8fbf1327.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3814.c1c32bef.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3837.5f26bfe8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2510.517b95f1.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9424.2d099a91.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8590.6abf8139.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1076.a1004b85.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8917.7b705201.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7945.c1c01e0c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6699.c1fa4397.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4424.3b97b4b6.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/239.dddbc557.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/810.24654a4d.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/9135.f3a6fd9c.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5755.00c3d7c1.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7856.2b700517.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4814.44e1d203.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4039.3d72e643.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2995.49181536.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/589.25332a71.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/5847.617d845e.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2614.e606d2aa.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9063.605b3b0f.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5039.68fdfb2f.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7504.e6165f62.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7989.4625af04.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9465.f3abc6f9.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4395.7fd1a817.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4176.6618c416.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1015.0c049aee.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4612.72dbb94d.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4202.0b476fbb.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5785.72eb2ef7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1317.8e8215d5.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1829.edc5b96f.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/17.7178e9c7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1415.5ec956fc.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3710.3c677576.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6189.65c23c24.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/4903.c29ec2c8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3517.7bd3284b.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2953.130798dd.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9994.398a6187.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/5433.00ecc46e.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/423.8bd9f204.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1418.9ac5becd.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8973.cd76cfcf.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6985.08417690.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/2861.e9d0323e.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3749.2cc88e07.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/login/9624.1f3899a9.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3152.621b63d8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3184.565dbfbe.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/1280.f7706909.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/6446.53621af3.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/3143.d47d85d7.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7784.9f9181d8.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/7807.5048a39e.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/8055.bb245188.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/js/9013.da3ad328.chunk.js"><link rel="prefetch" href="https://community.cloud.databricks.com/favicon.ico"><link rel="prefetch" href="https://community.cloud.databricks.com/login.html"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/GraphqlClustersGetPage.e5ed6c09.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/6662.035b535e.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/5061.3223f1fe.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/2510.90a8b767.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/ReactNotebookView.c32ea7d2.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/9749.e636248e.chunk.css"><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/ScheduleLink.b6cfefd1.chunk.css"><style id="plotly.js-style-global"></style><style id="detectElementResize" type="text/css">@keyframes resizeanim { from { opacity: 0; } to { opacity: 0; } } .resize-triggers { animation: 1ms resizeanim; visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }</style><link rel="stylesheet" type="text/css" href="./sparkml_lab - Databricks Community Edition_files/ClustersMainPage.5bac6c88.chunk.css"></head><body class="light-mode notebook-present"><noscript>You need to enable JavaScript to run this app.</noscript><script>// Prefetch /pubconf, /workspaces, /config
      // We wrap this in a function to not pollute the namespace
      (function() {
        const getParams = (paramsStr) => {
          let match;
          const pl = /\+/g; // Regex for replacing addition symbol with a space
          const search = /([^&=]+)=?([^&]*)/g;
          const decode = function decode(s) {
            return decodeURIComponent(s.replace(pl, ' '));
          };

          const urlParams = {};
          match = search.exec(paramsStr);
          while (match) {
            urlParams[decode(match[1])] = decode(match[2]);
            match = search.exec(paramsStr);
          }
          return urlParams;
        }

        // If we can get it from the params, do that
        const params = getParams(window.location.search.substr(1));
        const workspaceParam = params?.o;

        function fetchWorkspaceConfigUsingParam() {
          let configUsingParamProm = null;
          let configUsingParamOrgId = null;
          if (workspaceParam) {
            configUsingParamOrgId = workspaceParam.toString();
            configUsingParamProm = fetch('/config', {headers: { 'X-Databricks-Org-Id': configUsingParamOrgId }});
          }
          return {
            configUsingParamProm,
            configUsingParamOrgId,
          };
        }

        // Note that this function returns null in cases where there is no workspace or where we want the user to choose a workspace, since we
        // are going to redirect the user anyways
        const maybeGetOrgId = function(workspaceList, pubConf) {
          if (workspaceParam) {
            return workspaceParam;
          }

          // Otherwise we try to infer from the deployment name (apparently this doesn't work for AWS vanity URLs)
          if (pubConf.inferOrgIdFromDeploymentName) {
            const deploymentName = window.location.hostname
                    .split('.')
                    .slice(0, pubConf.numDeploymentNameHostnameLabels)
                    .join('.');
            const targetWorkspace = workspaceList.filter(w => deploymentName === w.deploymentName);
            if (targetWorkspace.length > 0) {
              return targetWorkspace[0].orgId;
            }
          }

          // If we're just going to redirect the user anyways, don't try to fetch the config
          if (pubConf.redirectBrowserOnWorkspaceSelection) {
            return null;
          }

          // Otherwise, if there are either no available workspaces, or multiple confirmed ones, we return null since
          // we will redirect the user anyways
          const confirmedWorkspaces = workspaceList.filter((workspace) => !workspace.needsConfirmation);
          // If there is exactly one confirmed workspace, then we'll pick that one.
          // This is the common path for single tenant
          if (confirmedWorkspaces.length === 1) {
            return confirmedWorkspaces[0].orgId;
          }

          // otherwise we're not sure what workspace they want, so we don't prefetch
          return null;
        };

        const pubConfProm = fetch('/pub-conf').then(r => r.json()).then(json => window.pubConf = json);
        const workspacesProm = fetch('/workspaces').then(r => r.json()).then(json => window.workspaces = json);
        const { configUsingParamProm, configUsingParamOrgId } = fetchWorkspaceConfigUsingParam();
        Promise.all([pubConfProm, workspacesProm])
          .then((values) => maybeGetOrgId(window.workspaces, window.pubConf))
          .then(orgId => {
            if (configUsingParamProm && orgId && orgId === configUsingParamOrgId) {
              return configUsingParamProm;
            } else if (orgId !== null) {
              return fetch('/config', {headers: { 'X-Databricks-Org-Id': orgId.toString() }});
            }
            return Promise.reject("could not determine workspace")
          })
          .then(r => r.json())
          .then(json => window.prefetchedSettings = json);
      })();</script><link rel="preload" href="./sparkml_lab - Databricks Community Edition_files/main.04ca75c7.js.download" as="script"><link rel="preload" href="https://community.cloud.databricks.com/login/8705.e5c47eb7.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/login/8188.c7a4b3b5.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/login/4963.872a6506.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/login/9135.f3a6fd9c.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/js/7856.2b700517.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/login/9624.1f3899a9.chunk.js" as="script"><link rel="preload" href="https://community.cloud.databricks.com/js/2651.e758324e.chunk.js" as="script"><script>function preload(uris) {
        uris.forEach(uri => {
          const preload = document.createElement("link");
          preload.rel = "preload";
          preload.href = uri;
          preload.as = uri.endsWith(".css") ? "style" : "script";
          document.head.appendChild(preload);
        });
      }
      const hash = window.location.hash;
      
      if (hash.indexOf("#notebook/") === 0) {
        preload(["/js/6808.208fe661.chunk.js","/js/5225.29d1a599.chunk.js","/js/6439.09246fa7.chunk.js","/js/6665.c1e21397.chunk.js","/js/3878.9114c018.chunk.js","/js/3837.5f26bfe8.chunk.js","/js/2510.517b95f1.chunk.js","/js/8590.6abf8139.chunk.js","/js/7945.c1c01e0c.chunk.js","/js/4424.3b97b4b6.chunk.js","/js/239.dddbc557.chunk.js","/js/5755.00c3d7c1.chunk.js","/js/4039.3d72e643.chunk.js","/js/2614.e606d2aa.chunk.js","/js/9063.605b3b0f.chunk.js","/js/5039.68fdfb2f.chunk.js","/js/7504.e6165f62.chunk.js","/js/7989.4625af04.chunk.js","/js/9465.f3abc6f9.chunk.js","/js/1015.0c049aee.chunk.js","/js/1829.edc5b96f.chunk.js","/js/6189.65c23c24.chunk.js","/js/2953.130798dd.chunk.js","/js/9994.398a6187.chunk.js","/js/3184.565dbfbe.chunk.js","/js/9013.da3ad328.chunk.js","/js/9957.79ba18a5.chunk.js","/css/3641.7d0a57ea.chunk.css","/css/6662.035b535e.chunk.css","/css/5061.3223f1fe.chunk.css","/css/2510.90a8b767.chunk.css","/css/ReactNotebookView.c32ea7d2.chunk.css"]);
        preload(["/js/6808.208fe661.chunk.js","/js/5225.29d1a599.chunk.js","/js/6439.09246fa7.chunk.js","/js/6665.c1e21397.chunk.js","/js/5896.ee48b333.chunk.js","/js/3878.9114c018.chunk.js","/js/4724.05d6c913.chunk.js","/js/2135.b0757e86.chunk.js","/js/8671.8fbf1327.chunk.js","/js/3814.c1c32bef.chunk.js","/js/9424.2d099a91.chunk.js","/js/1076.a1004b85.chunk.js","/js/6699.c1fa4397.chunk.js","/js/2614.e606d2aa.chunk.js","/js/9063.605b3b0f.chunk.js","/js/5039.68fdfb2f.chunk.js","/js/7504.e6165f62.chunk.js","/js/7989.4625af04.chunk.js","/js/9465.f3abc6f9.chunk.js","/js/4395.7fd1a817.chunk.js","/js/4612.72dbb94d.chunk.js","/js/4202.0b476fbb.chunk.js","/js/5785.72eb2ef7.chunk.js","/js/1317.8e8215d5.chunk.js","/js/17.7178e9c7.chunk.js","/js/3517.7bd3284b.chunk.js","/js/7994.68bbe55c.chunk.js","/css/3641.7d0a57ea.chunk.css","/css/6662.035b535e.chunk.css","/css/9749.e636248e.chunk.css","/css/ScheduleLink.b6cfefd1.chunk.css"]);
      } else if (hash === '') {
        preload(["/js/8973.cd76cfcf.chunk.js","/js/7807.5048a39e.chunk.js","/js/7032.28b1c9d1.chunk.js","/css/3641.7d0a57ea.chunk.css"]);
      } else if (hash.indexOf("#job/") === 0) {
        preload(["/js/6808.208fe661.chunk.js","/js/5225.29d1a599.chunk.js","/js/6439.09246fa7.chunk.js","/js/6665.c1e21397.chunk.js","/js/5896.ee48b333.chunk.js","/js/3878.9114c018.chunk.js","/js/4724.05d6c913.chunk.js","/js/2135.b0757e86.chunk.js","/js/8671.8fbf1327.chunk.js","/js/3814.c1c32bef.chunk.js","/js/3837.5f26bfe8.chunk.js","/js/2510.517b95f1.chunk.js","/js/9424.2d099a91.chunk.js","/js/8590.6abf8139.chunk.js","/js/1076.a1004b85.chunk.js","/js/8917.7b705201.chunk.js","/js/7945.c1c01e0c.chunk.js","/js/4424.3b97b4b6.chunk.js","/js/239.dddbc557.chunk.js","/js/2614.e606d2aa.chunk.js","/js/9063.605b3b0f.chunk.js","/js/5039.68fdfb2f.chunk.js","/js/7504.e6165f62.chunk.js","/js/7989.4625af04.chunk.js","/js/9465.f3abc6f9.chunk.js","/js/4395.7fd1a817.chunk.js","/js/1015.0c049aee.chunk.js","/js/4612.72dbb94d.chunk.js","/js/4202.0b476fbb.chunk.js","/js/5785.72eb2ef7.chunk.js","/js/1829.edc5b96f.chunk.js","/js/17.7178e9c7.chunk.js","/js/1415.5ec956fc.chunk.js","/js/3710.3c677576.chunk.js","/js/6189.65c23c24.chunk.js","/js/4903.c29ec2c8.chunk.js","/js/2953.130798dd.chunk.js","/js/5433.00ecc46e.chunk.js","/js/3152.621b63d8.chunk.js","/js/80.d7d62d5c.chunk.js","/css/3641.7d0a57ea.chunk.css","/css/6662.035b535e.chunk.css","/css/5061.3223f1fe.chunk.css","/css/2510.90a8b767.chunk.css","/css/JobRunView.20334262.chunk.css"]);
      }
      
      preload([]);</script><div id="skip-links"><div class="css-1thbak"><button id="skip-link-content" data-testid="skip-link-content" type="button" class="du-bois-light-btn du-bois-light-btn-sm css-gtkeiv css-1ae9htc">Skip to Content</button></div></div><uses-legacy-bootstrap data-wrapped-element-id="toolbar"><div id="toolbar"></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="tooltip"><div id="tooltip" class="hidden"><p><span id="value"></span></p></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="global-notification-container"><div id="global-notification-container"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div></div></uses-legacy-bootstrap><div id="rmmodal-container"></div><uses-legacy-bootstrap data-wrapped-element-id="topbar"><div id="tb-action-banner-container"></div><div id="topbar" style="padding-left: 56px;"><span id="tb-page-title"></span><h1 class="tb-title-wrapper tb-title-wrapper-central" style="left: 56px;"><span class="tb-title"><span class="notebook-title-wrapper"><span id="nbTitle">sparkml_lab</span></span></span> <span class="tb-title-portal"></span> <span class="tb-title-lang" data-lang="none"><button data-lang="scala" type="button" class="ant-btn tb-lang-link ant-btn-round ant-btn-sm" ant-click-animating-without-extra-node="false"><span>Scala</span></button></span><div class="tb-status"><span class="tb-status-msg tb-status-msg-error"></span> <span class="tb-status-msg tb-status-msg-banner"></span> <span class="tb-status-msg tb-status-msg-locked"></span> <span class="tb-status-msg tb-status-msg-connecting">Connecting...&nbsp;</span> <span class="tb-status-msg tb-status-msg-waiting">Still working...&nbsp;</span> <img class="tb-status-spinner" src="./sparkml_lab - Databricks Community Edition_files/spinner.gif" alt="spinner"></div></h1><div class="tb-title-wrapper tb-title-wrapper-right"><div class="tb-trial-msg"></div><div class="tb-title-icons tb-title-icons-right"></div><div class="tb-status presence"><span class="tb-status-msg tb-status-presence" style=""><!-- presenceTemplate -->

<ul class="noselect">
  
  <li title="Recent Activity" class="presence-history" role="button" aria-label="Click to view Recent Activity">
    <div><i class="fa fa-clock-o" aria-hidden="true"></i></div>
  </li>
</ul>

</span></div><div class="tb-notebook-schedule-link"></div></div><div id="tb-invite-teammate"></div><div id="tb-upgrade"></div><a class="tb-button tb-button-right tb-button-upgrade" title="Upgrade" target="_blank" style="display: none;"><span>Upgrade</span></a></div></uses-legacy-bootstrap><div id="app-root"><uses-legacy-bootstrap data-wrapped-element-id="sidebar"><div id="sidebar" class="sidebar"><div class="sidebar-outer sidebar--theme-unified"><div data-testid="persona-nav-sidebar" class="css-1qq8bvn"><nav aria-label="Main Menu" class="css-1bxvmc"><a aria-label="Databricks" href="https://community.cloud.databricks.com/?o=51032147687641#" data-testid="DatabricksLogo" class="css-1iy4oqv"><span class="glyph css-2edx1n"><svg aria-hidden="true" width="24" height="26" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22.72 10.562l-10.721 5.956L.543 10.152l-.543.3v4.627l11.998 6.672 10.722-5.959v2.458l-10.721 5.962-11.453-6.37-.546.3v.786L11.998 25.6 24 18.928v-4.631l-.543-.3-11.459 6.366L1.28 14.407V11.96L12 17.91 24 11.24V6.672l-.603-.331-11.398 6.338-10.15-5.647 10.15-5.644 8.364 4.65.744-.413v-.559L12 0 0 6.675v.716l11.998 6.672L22.72 8.104v2.458z"></path></svg></span><span class="persona-nav-expanded-text css-1z0rrpl" data-testid="PersonaMenuIconText"><svg aria-hidden="true" width="123" height="21" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#prefix__clip0)"><path d="M14.511 20.258V1.145H11.56V8.29c0 .104-.066.2-.167.238a.256.256 0 01-.279-.072c-1-1.168-2.555-1.838-4.27-1.838-3.646 0-6.503 3.067-6.503 6.986 0 1.92.667 3.69 1.876 4.985a6.262 6.262 0 004.628 2.002c1.684 0 3.241-.7 4.27-1.917a.256.256 0 01.28-.074c.1.036.167.132.167.238v1.423h2.95v-.004zm-7.003-2.336c-2.35 0-4.19-1.898-4.19-4.319 0-2.42 1.84-4.319 4.19-4.319 2.35 0 4.19 1.898 4.19 4.32 0 2.42-1.84 4.318-4.19 4.318zM30.266 20.258V6.948h-2.924v1.336a.253.253 0 01-.448.162c-.99-1.18-2.505-1.83-4.27-1.83-3.646 0-6.503 3.068-6.503 6.987s2.857 6.987 6.504 6.987c1.691 0 3.246-.707 4.267-1.938a.253.253 0 01.448.161v1.445h2.926zm-6.976-2.336c-2.35 0-4.19-1.898-4.19-4.319 0-2.421 1.84-4.319 4.19-4.319 2.35 0 4.19 1.898 4.19 4.32 0 2.42-1.84 4.318-4.19 4.318zM55.266 20.258V6.948h-2.924v1.336a.253.253 0 01-.448.162c-.99-1.18-2.506-1.83-4.27-1.83-3.646 0-6.503 3.068-6.503 6.987s2.857 6.987 6.504 6.987c1.69 0 3.245-.707 4.267-1.938a.255.255 0 01.45.162v1.444h2.924zm-6.974-2.336c-2.35 0-4.19-1.898-4.19-4.319 0-2.421 1.84-4.319 4.19-4.319 2.35 0 4.19 1.898 4.19 4.32 0 2.42-1.842 4.318-4.19 4.318zM60.627 18.677a.244.244 0 01.087-.015c.075 0 .145.032.192.09 1 1.168 2.555 1.838 4.27 1.838 3.646 0 6.504-3.068 6.504-6.987 0-1.919-.666-3.689-1.877-4.985a6.262 6.262 0 00-4.627-2.002c-1.685 0-3.242.7-4.27 1.917a.253.253 0 01-.448-.164l.007-7.227h-2.952l-.006 19.114h2.951v-1.343a.26.26 0 01.169-.236zm-.303-5.074c0-2.421 1.84-4.319 4.19-4.319 2.35 0 4.19 1.898 4.19 4.319 0 2.421-1.84 4.319-4.19 4.319-2.35 0-4.19-1.898-4.19-4.319zM80.174 9.671c.277 0 .535.024.714.066V6.723a2.396 2.396 0 00-.492-.05c-1.53 0-2.943.782-3.692 2.039a.253.253 0 01-.471-.13V6.948h-2.924v13.31h2.952v-5.853c0-2.919 1.499-4.734 3.913-4.734zM85.714 6.948h-2.98v13.31h2.98V6.948zM84.19 1.157c-.996 0-1.807.809-1.807 1.802a1.806 1.806 0 003.613 0 1.804 1.804 0 00-1.807-1.802zM94.468 6.616c-4.09 0-7.059 2.938-7.059 6.987 0 1.968.695 3.749 1.96 5.012 1.271 1.273 3.073 1.973 5.07 1.973 1.654 0 2.944-.328 5.375-2.107l-1.674-1.763c-1.194.791-2.305 1.176-3.395 1.176-2.467 0-4.329-1.844-4.329-4.29 0-2.447 1.862-4.292 4.33-4.292 1.176 0 2.268.385 3.337 1.177l1.872-1.768c-2.173-1.885-4.171-2.105-5.487-2.105zM105 14.388a.257.257 0 01.171-.066h.015c.072.007.138.04.181.094l4.719 5.838 3.63.002-6.106-7.37a.255.255 0 01.015-.34l5.613-5.6h-3.597l-4.831 4.849a.253.253 0 01-.432-.179l.006-10.471h-2.958v19.113h2.952v-5.185a.25.25 0 01.081-.185l.541-.5z"></path><path d="M118.531 20.59c2.421 0 4.869-1.46 4.869-4.251 0-1.819-1.143-3.076-3.493-3.84l-1.606-.526c-1.079-.36-1.606-.874-1.606-1.576 0-.802.721-1.362 1.753-1.362.981 0 1.855.639 2.408 1.753l2.369-1.272c-.866-1.789-2.691-2.9-4.777-2.9-2.644 0-4.566 1.694-4.566 4.03 0 1.844 1.107 3.091 3.38 3.812l1.636.526c1.16.366 1.631.821 1.631 1.576 0 1.128-1.049 1.528-1.944 1.528-1.197 0-2.257-.775-2.777-2.026l-2.39 1.243c.793 2.027 2.746 3.285 5.113 3.285zM38.443 20.454c.932 0 1.776-.083 2.241-.156v-2.544c-.388.05-1.058.095-1.48.095-1.198 0-2.113-.204-2.113-2.778v-5.47c0-.14.113-.253.253-.253h2.875l-.002-2.402-2.873.002a.253.253 0 01-.253-.253V2.836l-2.933.002.003 3.857c0 .14-.113.253-.254.253H31.85l.002 2.402 2.056-.002c.14 0 .254.113.254.253V15.8c-.007 4.655 3.107 4.655 4.28 4.655z"></path></g></svg></span></a><div role="separator" class="css-10doamx"></div><div><span id="persona-switcher-label" class="css-177iafl">Active persona</span><button id="persona-switcher-button" data-testid="PersonaSwitcherButton" aria-haspopup="listbox" aria-expanded="false" aria-labelledby="persona-switcher-label persona-switcher-button" class="css-10b5paf"><span role="presentation" class="css-hqvexg"><span aria-hidden="true" class="css-ashwx7">D</span></span><span class="persona-nav-expanded-text css-1yxhh0r"><span data-testid="SelectedPersona" class="css-aogtgp">Data Science &amp; Engineering</span></span><span role="presentation" class="css-12voij3"><svg aria-hidden="true" width="8" height="5" viewBox="0 0 8 5" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.706145 1.71012L3.29615 4.30012C3.68615 4.69012 4.31615 4.69012 4.70615 4.30012L7.29614 1.71012C7.92615 1.08012 7.47614 0.00012207 6.58614 0.00012207H1.40615C0.516145 0.00012207 0.0761452 1.08012 0.706145 1.71012Z" fill="currentColor"></path></svg></span></button><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="persona-switcher css-ap9pwx persona-switcher-placement-bottomLeft  persona-switcher-hidden" style="min-width: 144px; position: relative; left: -991px; top: -902px;"><div role="listbox" aria-labelledby="persona-switcher-label" data-testid="PersonaSwitcherDropdownMenu" prefixcls="persona-switcher-menu" class="css-nrhq5a"><div class="css-19t2ho9"><div class="css-i9gxme"><a href="https://community.cloud.databricks.com/?o=51032147687641#" aria-current="page" role="option" aria-selected="true" data-testid="PersonaSwitch-data-science" class="css-zmwr0t"><span class="nav-icon css-6vcpyg"><span aria-hidden="true" class="css-ashwx7">D</span></span><span class="button-text css-8uhtka"><span title="Data Science &amp; Engineering">Data Science &amp; Engineering</span></span></a></div><div class="css-1hsw4z0"><button type="button" aria-disabled="true" role="option" aria-label="Pin Data Science &amp; Engineering" aria-selected="true" data-testid="TogglePersona-data-science" data-pin-status="pinned" class="css-1p5b522"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M12 22V17" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><path d="M6.49995 17L17.4999 17C18.736 17 19.4416 15.5889 18.6999 14.6L15.9999 11L15.9999 5C15.9999 3.89543 15.1045 3 13.9999 3L9.99994 3.00001C8.89537 3.00001 7.99993 3.89544 7.99994 5.00001L7.99995 11L5.29995 14.6C4.55831 15.5889 5.26388 17 6.49995 17Z" fill="currentColor" stroke="currentColor" stroke-width="2"></path></g></svg></span></button></div></div><div class="css-19t2ho9"><div class="css-i9gxme"><a href="https://community.cloud.databricks.com/?o=51032147687641#ml/dashboard" role="option" aria-selected="false" data-testid="PersonaSwitch-machine-learning" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><span aria-hidden="true" class="css-ashwx7">M</span></span><span class="button-text css-8uhtka"><span title="Machine Learning">Machine Learning</span></span></a></div><div class="css-1hsw4z0"><button type="button" role="option" aria-label="Pin Machine Learning" aria-selected="false" data-testid="TogglePersona-machine-learning" data-pin-status="false" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0)"><path d="M12 22V17" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path><path d="M6.49995 17L17.4999 17C18.736 17 19.4416 15.5889 18.6999 14.6L15.9999 11L15.9999 5C15.9999 3.89543 15.1045 3 13.9999 3L9.99994 3.00001C8.89537 3.00001 7.99993 3.89544 7.99994 5.00001L7.99995 11L5.29995 14.6C4.55831 15.5889 5.26388 17 6.49995 17Z" stroke="currentColor" stroke-width="2"></path></g></svg></span></button></div></div></div></div></div></div></div><div role="separator" class="css-10doamx"></div><div data-testid="PersonaNavMenus" class="css-b3415i"><div class="css-i9gxme"><div><button id="create-menu-button" type="button" data-testid="PersonaNavCreateMenu" aria-controls="create-menu" aria-expanded="false" aria-haspopup="menu" class="css-rfqg47"><span class="create-button-icon css-1ybpvb6"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 7C11.45 7 11 7.45 11 8V11H8C7.45 11 7 11.45 7 12C7 12.55 7.45 13 8 13H11V16C11 16.55 11.45 17 12 17C12.55 17 13 16.55 13 16V13H16C16.55 13 17 12.55 17 12C17 11.45 16.55 11 16 11H13V8C13 7.45 12.55 7 12 7ZM4 12C4 16.41 7.59 20 12 20C16.41 20 20 16.41 20 12C20 7.59 16.41 4 12 4C7.59 4 4 7.59 4 12Z" fill="currentColor"></path></svg></span><span class="persona-nav-expanded-text">Create</span></button><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="persona-nav-submenu css-jsc8sg persona-nav-submenu-placement-rightTop  persona-nav-submenu-hidden" style="min-width: 178px; position: relative; left: -942px; top: -893px;"><div id="create-menu" role="menu" aria-labelledby="create-menu-button"><button type="button" role="menuitem" data-testid="CreateMenuNotebook" class="css-1ephvzz"><span class="button-text css-8uhtka"><span title="Notebook">Notebook</span></span></button><a href="https://community.cloud.databricks.com/?o=51032147687641#tables/new" role="menuitem" data-testid="CreateMenuTable" class="css-1ephvzz"><span class="button-text css-8uhtka"><span title="Table">Table</span></span></a><a href="https://community.cloud.databricks.com/?o=51032147687641#create/cluster" role="menuitem" data-testid="CreateMenuCluster" class="css-1ephvzz"><span class="button-text css-8uhtka"><span title="Cluster">Cluster</span></span></a></div></div></div></div></div><div role="group"><button type="button" data-testid="Workspace" class="css-zmwr0t" aria-current="page"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H5V3Z" stroke="currentColor" stroke-width="2"></path><line x1="8" y1="17" x2="2" y2="17" stroke="currentColor" stroke-width="2"></line><line x1="8" y1="12" x2="2" y2="12" stroke="currentColor" stroke-width="2"></line><line x1="8" y1="7" x2="2" y2="7" stroke="currentColor" stroke-width="2"></line><line x1="9" y1="3" x2="9" y2="21" stroke="currentColor" stroke-width="2"></line></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Workspace">Workspace</span></span></button><button type="button" data-testid="Recents" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"></circle><path d="M12 5L12 12L16 16" stroke="currentColor" stroke-width="2"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Recents">Recents</span></span></button><button type="button" data-testid="Search" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="10" cy="10" r="8" stroke="currentColor" stroke-width="2"></circle><path d="M22 22L15.5 15.5" stroke="currentColor" stroke-width="2"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Search">Search</span></span></button><div role="separator" class="css-10doamx"></div><button type="button" data-testid="Tables" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><rect x="14" y="14" width="8" height="8" stroke="currentColor" stroke-width="2"></rect><circle cx="6" cy="18" r="4" stroke="currentColor" stroke-width="2"></circle><path d="M7.63073 10L12 2.07184L16.3693 10H7.63073Z" stroke="currentColor" stroke-width="2"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Data">Data</span></span></button><a href="https://community.cloud.databricks.com/?o=51032147687641#setting/clusters" data-testid="Compute" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="4" cy="20" r="2" stroke="currentColor" stroke-width="2"></circle><circle cx="12" cy="20" r="2" stroke="currentColor" stroke-width="2"></circle><circle cx="20" cy="20" r="2" stroke="currentColor" stroke-width="2"></circle><path d="M12 18V9" stroke="currentColor" stroke-width="2"></path><path d="M4 18V15C4 13.8954 4.89543 13 6 13H18C19.1046 13 20 13.8954 20 15V18" stroke="currentColor" stroke-width="2"></path><path d="M3.76389 11C3.28885 10.4692 3 9.76835 3 9C3 7.34315 4.34315 6 6 6H7C7 3.79086 9.01472 2 11.5 2C13.5968 2 15.3587 3.27477 15.8582 5H18C19.6569 5 21 6.61178 21 8.6C21 9.52203 20.7111 10.3631 20.2361 11" stroke="currentColor" stroke-width="2"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Compute">Compute</span></span></a><a href="https://community.cloud.databricks.com/?o=51032147687641#joblist" data-testid="Jobs" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M22 5L11 5" stroke="currentColor" stroke-width="2"></path><path d="M22 12L11 12" stroke="currentColor" stroke-width="2"></path><path d="M22 19L2 19" stroke="currentColor" stroke-width="2"></path><path d="M2 11L4.5 13.5L9 9" stroke="currentColor" stroke-width="2"></path><path d="M2 4L4.5 6.5L9 2" stroke="currentColor" stroke-width="2"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Jobs">Jobs</span></span></a><div role="separator" class="css-10doamx"></div></div></div><div role="group"><div><button type="button" aria-controls="persona-nav-help-menu" aria-haspopup="menu" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 10C0 4.48 4.48 0 10 0C15.52 0 20 4.48 20 10C20 15.52 15.52 20 10 20C4.48 20 0 15.52 0 10ZM2 10C2 14.41 5.59 18 10 18C14.41 18 18 14.41 18 10C18 5.59 14.41 2 10 2C5.59 2 2 5.59 2 10ZM11 14V16H9V14H11ZM6.18 6.83C6.73 5.01 8.55 3.74 10.61 4.04C12.35 4.3 13.72 5.77 13.96 7.51C14.1881 9.12354 13.2957 9.90209 12.4344 10.6535C12.2762 10.7916 12.119 10.9288 11.97 11.07C11.85 11.18 11.74 11.29 11.64 11.41C11.635 11.415 11.63 11.4225 11.625 11.43C11.62 11.4375 11.615 11.445 11.61 11.45C11.51 11.57 11.41 11.7 11.33 11.84C11.32 11.855 11.3125 11.87 11.305 11.885C11.2975 11.9 11.29 11.915 11.28 11.93C11.11 12.23 11 12.58 11 13H9C9 12.5 9.08 12.09 9.2 11.75C9.20438 11.7368 9.20685 11.7256 9.20907 11.7155C9.21192 11.7025 9.21438 11.6912 9.22 11.68C9.225 11.665 9.2325 11.6525 9.24 11.64C9.2475 11.6275 9.255 11.615 9.26 11.6C9.33 11.42 9.42 11.25 9.51 11.1C9.515 11.09 9.52 11.0825 9.525 11.075C9.53 11.0675 9.535 11.06 9.54 11.05C9.54 11.045 9.5425 11.0425 9.545 11.04C9.5475 11.0375 9.55 11.035 9.55 11.03C9.89058 10.5171 10.3473 10.1658 10.7745 9.83728C11.3883 9.3652 11.941 8.94014 12 8.15C12.08 7.18 11.38 6.25 10.43 6.05C9.4 5.83 8.45 6.44 8.13 7.33C7.99 7.71 7.66 8 7.25 8H7.05C6.44 8 6 7.41 6.18 6.83Z" fill="currentColor"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Help">Help</span></span></button></div><div><button type="button" data-testid="Settings" aria-controls="settings-menu" aria-haspopup="menu" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3 10.1053V13.8947L5.45227 14.7122L4.29626 17.0242L6.97582 19.7037L9.28784 18.5477L10.1053 21H13.8947L14.7122 18.5477L17.0242 19.7037L19.7037 17.0242L18.5477 14.7122L21 13.8947L21 10.1053L18.5477 9.28784L19.7037 6.97582L17.0242 4.29626L14.7122 5.45227L13.8947 3H10.1053L9.28784 5.45227L6.97582 4.29626L4.29626 6.97582L5.45227 9.28784L3 10.1053Z" stroke="currentColor" stroke-width="2"></path><circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"></circle></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Settings">Settings</span></span></button></div><div><button type="button" aria-controls="account-menu" aria-haspopup="menu" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 22V18C5 15.7909 6.79086 14 9 14H15C17.2091 14 19 15.7909 19 18V22" stroke="currentColor" stroke-width="2"></path><circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"></circle></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="tuccio@kth.se">tuccio@kth.se</span></span></button></div><div role="separator" class="css-10doamx"></div><div><button type="button" data-testid="PersonaMenuOptionsButton" aria-controls="menu-options-menu" aria-haspopup="menu" class="css-1ephvzz"><span class="nav-icon css-6vcpyg"><svg aria-hidden="true" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 3H19C20.1 3 21 3.9 21 5V19C21 20.1 20.1 21 19 21H5C3.9 21 3 20.1 3 19V5C3 3.9 3.9 3 5 3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M9 21V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg></span><span class="persona-nav-expanded-text css-8uhtka"><span title="Menu options">Menu options</span></span></button></div></div></div></nav></div><div class="sidebar-alt"><div></div><div></div></div></div></div></uses-legacy-bootstrap></div><div id="legacy-app-root">
      <div id="overallView" class="new-notebook" style="left: 56px;"><div style="height: 100%;"><div><uses-legacy-bootstrap data-wrapped-element-id="Notifications"><div class="databricks-notification-wrapper"><div class="notifications-wrapper"></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="ContextBarView"><div class="new-notebook context-bar" id="context-bar"><div class="context-bar__left"><div class="attach-cluster-select-wrapper"><i class="fa fa-sitemap" style="text-align: center;"></i><div class="control-field clusters attach-cluster-select webapp-css-wwrqjh-container"><span aria-live="polite" aria-atomic="false" aria-relevant="additions text" class="webapp-css-7pg0cj-a11yText"></span><div class="react-select__control webapp-css-zapze6-control"><div class="react-select__value-container react-select__value-container--has-value webapp-css-12n3d9a"><span class="single-value single-value--with-icon webapp-css-1o1xctj-singleValue"><i data-testid="status-indicator-icon" class="fa fa-circle fa-fw status-indicator-icon ok " style="text-align: center;"></i>lab1_scala</span><div class="webapp-css-1kdqmo9"><div class="react-select__input" style="display: inline-block;"><input autocapitalize="none" autocomplete="off" autocorrect="off" id="react-select-23-input" spellcheck="false" tabindex="0" type="text" aria-autocomplete="list" aria-label="Select Cluster" value="" style="box-sizing: content-box; width: 2px; background: 0px center; border: 0px; font-size: inherit; opacity: 1; outline: 0px; padding: 0px; color: inherit;"><div style="position: absolute; top: 0px; left: 0px; visibility: hidden; height: 0px; overflow: scroll; white-space: pre; font-size: 13px; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-weight: 400; font-style: normal; letter-spacing: normal; text-transform: none;"></div></div></div></div><div class="react-select__indicators webapp-css-1wy0on6"><span class="react-select__indicator-separator webapp-css-e8cnu0-indicatorSeparator"></span><div class="react-select__indicator react-select__dropdown-indicator webapp-css-w7andi-indicatorContainer" aria-hidden="true"><svg height="20" width="20" viewBox="0 0 20 20" aria-hidden="true" focusable="false" class="webapp-css-8mmkcg"><path d="M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"></path></svg></div></div></div></div></div><div class="dropdown actions-dropdown"><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="actions-dropdown-link" data-name="File"><i aria-hidden="true" class="fa fa-file-text-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">File</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="dropdown edit-dropdown"><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="edit-dropdown-link" data-name="Edit"><i aria-hidden="true" class="fa fa-edit contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Edit</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="dropdown view-dropdown"><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="view-mode-link" data-name="Current View Mode"><i aria-hidden="true" class="fa fa-picture-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">View: Standard</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div><div class="highlight-inactive"><a role="button" disabled="" class="no-click context-bar-item permissions" id="share" data-name="[object Object]"><i aria-hidden="true" class="fa fa-lock contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Permissions</span></a></div><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="0.9447774269483971" data-name="Run All"><i aria-hidden="true" class="fa fa-play-circle-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Run All</span></a></div><div class="dropdown clear-dropdown"><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="clear-results-link" data-name="Clear"><i aria-hidden="true" class="fa fa-eraser contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Clear</span> <i aria-hidden="true" class="fa fa-caret-down caretDown--js" style="text-align: center;"></i></a></div></div></div><div class="context-bar__right"><div class="context-bar-right-links"><div id="shortcut-wrapper"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="shortcut-menu-icon" title="Open keyboard shortcuts reference dialog"><i aria-hidden="true" class="fa fa-keyboard-o" style="text-align: center;"></i></a></div><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="publish-notebook" data-name="Publish"><i aria-hidden="true" class="fa fa-share-square-o contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Publish</span></a></div><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="show-comments" data-name="Comments"><i aria-hidden="true" class="fa fa-comments contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Comments</span></a></div><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="view-mlflow-runs" data-name="[object Object]"><span><span><i class="fa fa-flask contextBarIcon--js" style="text-align: center;"></i></span></span><span class="context-bar-link-text">Experiment</span></a></div><div class="highlight-inactive"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="context-bar-item" id="show-history" data-name="Revision history"><i aria-hidden="true" class="fa fa-history contextBarIcon--js" style="text-align: center;"></i> <span class="context-bar-link-text">Revision history</span></a></div></div></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="FindReplaceBarView"></uses-legacy-bootstrap><div><div><section class="ant-layout"><main class="ant-layout-content input-widget-panel-3 webapp-css-7rcple" id="notebook-input-widget-panel-3"><ul class="webapp-css-1yqcnnw"></ul><div class="widget-panel-settings"><i class="fa fa-edit webapp-css-1c5nttp" style="text-align: center; cursor: pointer;"></i><i class="fa fa-cog webapp-css-1c5nttp" style="text-align: center; cursor: pointer;"></i><i class="fa fa-thumb-tack webapp-css-14xbq74" style="text-align: center; cursor: pointer;"></i></div></main></section></div></div><uses-legacy-bootstrap data-wrapped-element-id="RevisionNotice"></uses-legacy-bootstrap><div id="content" class="new-notebook" style="top: 26px;"><section class="ant-layout ant-layout-has-sider notebook-view" style="height: 100%; background-color: var(--primary-background-color);"><aside class="notebook-table-of-contents-sidebar ant-layout-sider ant-layout-sider-light" style="flex: 0 0 200px; max-width: 200px; min-width: 200px; width: 200px;"><div class="ant-layout-sider-children"><div class="ant-tree notebook-table-of-contents-content ant-tree-icon-hide ant-tree-block-node"><div role="tree"><input tabindex="0" value="" style="width: 0px; height: 0px; display: flex; overflow: hidden; opacity: 0; border: 0px; padding: 0px; margin: 0px;"></div><div class="ant-tree-list"><div><div class="ant-tree-list-holder-inner" style="display: flex; flex-direction: column;"><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last" style="font-weight: bold;"><span class="ant-tree-switcher ant-tree-switcher_open"><span role="img" aria-label="caret-down" class="anticon anticon-caret-down ant-tree-switcher-icon"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="caret-down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"></path></svg></span></span><span title="Machine Learning With Spark ML" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-open"><span class="ant-tree-title">Machine Learning With Spark ML</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="2.1. Schema and dimension" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">2.1. Schema and dimension</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="2.2. Look at the data" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">2.2. Look at the data</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="2.3. Statistical summary" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">2.3. Statistical summary</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="2.4. Breakdown the data by categorical data" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">2.4. Breakdown the data by categorical data</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="2.5. Correlation among attributes" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">2.5. Correlation among attributes</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="2.6. Combine and make new attributes" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">2.6. Combine and make new attributes</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher_open"><span role="img" aria-label="caret-down" class="anticon anticon-caret-down ant-tree-switcher-icon"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="caret-down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"></path></svg></span></span><span title="3.1. Prepare continuse attributes" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-open"><span class="ant-tree-title">3.1. Prepare continuse attributes</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-start ant-tree-indent-unit-end"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="Scaling" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">Scaling</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher_open"><span role="img" aria-label="caret-down" class="anticon anticon-caret-down ant-tree-switcher-icon"><svg viewBox="0 0 1024 1024" focusable="false" data-icon="caret-down" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M840.4 300H183.6c-19.7 0-30.7 20.8-18.5 35l328.4 380.8c9.4 10.9 27.5 10.9 37 0L858.9 335c12.2-14.2 1.2-35-18.5-35z"></path></svg></span></span><span title="3.2. Prepare categorical attributes" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-open"><span class="ant-tree-title">3.2. Prepare categorical attributes</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-start"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="String indexer" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">String indexer</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span><span class="ant-tree-indent-unit ant-tree-indent-unit-end"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="One-hot encoding" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">One-hot encoding</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="5.1. Linear regression model" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">5.1. Linear regression model</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="5.2. Decision tree regression" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">5.2. Decision tree regression</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="5.3. Random forest regression" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">5.3. Random forest regression</span></span></div><div class="ant-tree-treenode ant-tree-treenode-switcher-open ant-tree-treenode-leaf-last"><span aria-hidden="true" class="ant-tree-indent"><span class="ant-tree-indent-unit ant-tree-indent-unit-end"></span></span><span class="ant-tree-switcher ant-tree-switcher-noop"></span><span title="5.4. Gradient-boosted tree regression" class="ant-tree-node-content-wrapper ant-tree-node-content-wrapper-normal"><span class="ant-tree-title">5.4. Gradient-boosted tree regression</span></span></div></div></div></div></div></div><span class="ant-layout-sider-zero-width-trigger ant-layout-sider-zero-width-trigger-left"><i class="fa fa-angle-left" style="text-align: center;"></i></span></aside><main class="ant-layout-content" style="position: relative; max-width: 100%;"><uses-legacy-bootstrap data-wrapped-element-id="CommandListView"><div class="new-notebook overallContainer"><div class="sessionPane"></div><div class="has-headings shell-top new-notebook"><img alt="Loading..." class="load-spinner" src="./sparkml_lab - Databricks Community Edition_files/spinner.7eb0071e.svg"><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436283"><i class="fa fa-link" style="text-align: center;"></i>Cmd 1</a><div class="new-notebook command mainCommand command-finished cellIndex-0 cell-475989419436282-475989419436283" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-0 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-0 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">Machine</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Learning</span><span class="cm-header header-1"> </span><span class="cm-header header-1">With</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Spark</span><span class="cm-header header-1"> </span><span class="cm-header header-1">ML</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>In</span><span> </span><span>this</span><span> </span><span>lab</span><span> </span><span>assignment,</span><span> </span><span>you</span><span> </span><span>will</span><span> </span><span>complete</span><span> </span><span>a</span><span> </span><span>project</span><span> </span><span>by</span><span> </span><span>going</span><span> </span><span>through</span><span> </span><span>the</span><span> </span><span>following</span><span> </span><span>steps</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Get</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable-2">2. </span><span class="cm-variable-2">Discover</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">gain</span><span class="cm-variable-2"> </span><span class="cm-variable-2">insights.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable-2">3. </span><span class="cm-variable-2">Prepare</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data</span><span class="cm-variable-2"> </span><span class="cm-variable-2">for</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Machine</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Learning</span><span class="cm-variable-2"> </span><span class="cm-variable-2">algorithms.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable-2">4. </span><span class="cm-variable-2">Select</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">train</span><span class="cm-variable-2"> </span><span class="cm-variable-2">it.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable-2">5. </span><span class="cm-variable-2">Fine-tune</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">your</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-variable-2">6. </span><span class="cm-variable-2">Present</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">your</span><span class="cm-variable-2"> </span><span class="cm-variable-2">solution.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span>As</span><span> </span><span>a</span><span> </span><span>dataset,</span><span> </span><span>we</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span>California</span><span> </span><span>Housing</span><span> </span><span>Prices</span><span> </span><span>dataset</span><span> </span><span>from</span><span> </span><span>the</span><span> </span><span>StatLib</span><span> </span><span>repository.</span><span> </span><span>This</span><span> </span><span>dataset</span><span> </span><span>was</span><span> </span><span>based</span><span> </span><span>on</span><span> </span><span>data</span><span> </span><span>from</span><span> </span><span>the</span><span> </span><span>1990</span><span> </span><span>California</span><span> </span><span>census.</span><span> </span><span>The</span><span> </span><span>dataset</span><span> </span><span>has</span><span> </span><span>the</span><span> </span><span>following</span><span> </span><span>columns</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">longitude</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">measure</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">how</span><span class="cm-variable-2"> </span><span class="cm-variable-2">far</span><span class="cm-variable-2"> </span><span class="cm-variable-2">west</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">house</span><span class="cm-variable-2"> </span><span class="cm-variable-2">is</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">higher</span><span class="cm-variable-2"> </span><span class="cm-variable-2">value</span><span class="cm-variable-2"> </span><span class="cm-variable-2">is</span><span class="cm-variable-2"> </span><span class="cm-variable-2">farther</span><span class="cm-variable-2"> </span><span class="cm-variable-2">west)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-variable-2">2. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">latitude</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">measure</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">how</span><span class="cm-variable-2"> </span><span class="cm-variable-2">far</span><span class="cm-variable-2"> </span><span class="cm-variable-2">north</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">house</span><span class="cm-variable-2"> </span><span class="cm-variable-2">is</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">higher</span><span class="cm-variable-2"> </span><span class="cm-variable-2">value</span><span class="cm-variable-2"> </span><span class="cm-variable-2">is</span><span class="cm-variable-2"> </span><span class="cm-variable-2">farther</span><span class="cm-variable-2"> </span><span class="cm-variable-2">north)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-variable-2">3. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">housing</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">,median</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">age</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">median</span><span class="cm-variable-2"> </span><span class="cm-variable-2">age</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">house</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">lower</span><span class="cm-variable-2"> </span><span class="cm-variable-2">number</span><span class="cm-variable-2"> </span><span class="cm-variable-2">is</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">newer</span><span class="cm-variable-2"> </span><span class="cm-variable-2">building)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span class="cm-variable-2">4. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">total</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">rooms</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">total</span><span class="cm-variable-2"> </span><span class="cm-variable-2">number</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">rooms</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-variable-2">5. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">total</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">bedrooms</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">total</span><span class="cm-variable-2"> </span><span class="cm-variable-2">number</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">bedrooms</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable-2">6. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">population</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">total</span><span class="cm-variable-2"> </span><span class="cm-variable-2">number</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">people</span><span class="cm-variable-2"> </span><span class="cm-variable-2">residing</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-variable-2">7. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">households</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">total</span><span class="cm-variable-2"> </span><span class="cm-variable-2">number</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">households,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">group</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">people</span><span class="cm-variable-2"> </span><span class="cm-variable-2">residing</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">home</span><span class="cm-variable-2"> </span><span class="cm-variable-2">unit,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">for</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span class="cm-variable-2">8. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">median</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">income</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">median</span><span class="cm-variable-2"> </span><span class="cm-variable-2">income</span><span class="cm-variable-2"> </span><span class="cm-variable-2">for</span><span class="cm-variable-2"> </span><span class="cm-variable-2">households</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">houses</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">20</div></div><span class="cm-variable-2">9. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">median</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">house</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">value</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">median</span><span class="cm-variable-2"> </span><span class="cm-variable-2">house</span><span class="cm-variable-2"> </span><span class="cm-variable-2">value</span><span class="cm-variable-2"> </span><span class="cm-variable-2">for</span><span class="cm-variable-2"> </span><span class="cm-variable-2">households</span><span class="cm-variable-2"> </span><span class="cm-variable-2">within</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">block</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">21</div></div><span class="cm-variable-2">10. </span><span class="cm-variable-2"></span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">ocean</span><span class="cm-comment variable-2">_</span><span class="cm-comment variable-2">proximity</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">location</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">house</span><span class="cm-variable-2"> </span><span class="cm-variable-2">w.r.t</span><span class="cm-variable-2"> </span><span class="cm-variable-2">ocean/sea</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">22</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">23</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">24</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">1.</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Get</span><span class="cm-header header-1"> </span><span class="cm-header header-1">the</span><span class="cm-header header-1"> </span><span class="cm-header header-1">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">25</div></div><span>Let</span><span>'</span><span>s</span><span> </span><span>start</span><span> </span><span>the</span><span> </span><span>lab</span><span> </span><span>by</span><span> </span><span>loading</span><span> </span><span>the</span><span> </span><span>dataset.</span><span> </span><span>The</span><span> </span><span>can</span><span> </span><span>find</span><span> </span><span>the</span><span> </span><span>dataset</span><span> </span><span>at</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">data/housing.csv</span><span class="cm-comment">`</span><span>.</span><span> </span><span>To</span><span> </span><span>infer</span><span> </span><span>column</span><span> </span><span>types</span><span> </span><span>automatically,</span><span> </span><span>when</span><span> </span><span>you</span><span> </span><span>are</span><span> </span><span>reading</span><span> </span><span>the</span><span> </span><span>file,</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>set</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">inferSchema</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>true.</span><span> </span><span>Moreover</span><span> </span><span>enable</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">header</span><span class="cm-comment">`</span><span> </span><span>option</span><span> </span><span>to</span><span> </span><span>read</span><span> </span><span>the</span><span> </span><span>columns</span><span>'</span><span> </span><span>name</span><span> </span><span>from</span><span> </span><span>the</span><span> </span><span>file.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="3910f42b-c271-4cb0-b881-6e2bd6aadeb2" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h1>Machine Learning With Spark ML</h1>
<p>In this lab assignment, you will complete a project by going through the following steps:</p>
<ol>
<li>Get the data.</li>
<li>Discover the data to gain insights.</li>
<li>Prepare the data for Machine Learning algorithms.</li>
<li>Select a model and train it.</li>
<li>Fine-tune your model.</li>
<li>Present your solution.</li>
</ol>
<p>As a dataset, we use the California Housing Prices dataset from the StatLib repository. This dataset was based on data from the 1990 California census. The dataset has the following columns</p>
<ol>
<li><code>longitude</code>: a measure of how far west a house is (a higher value is farther west)</li>
<li><code>latitude</code>: a measure of how far north a house is (a higher value is farther north)</li>
<li><code>housing_,median_age</code>: median age of a house within a block (a lower number is a newer building)</li>
<li><code>total_rooms</code>: total number of rooms within a block</li>
<li><code>total_bedrooms</code>: total number of bedrooms within a block</li>
<li><code>population</code>: total number of people residing within a block</li>
<li><code>households</code>: total number of households, a group of people residing within a home unit, for a block</li>
<li><code>median_income</code>: median income for households within a block of houses</li>
<li><code>median_house_value</code>: median house value for households within a block</li>
<li><code>ocean_proximity</code>: location of the house w.r.t ocean/sea</li>
</ol>
<hr>
<h1>1. Get the data</h1>
<p>Let's start the lab by loading the dataset. The can find the dataset at <code>data/housing.csv</code>. To infer column types automatically, when you are reading the file, you need to set <code>inferSchema</code> to true. Moreover enable the <code>header</code> option to read the columns' name from the file.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436284"><i class="fa fa-link" style="text-align: center;"></i>Cmd 2</a><div class="new-notebook command mainCommand command-finished cellIndex-1 cell-475989419436282-475989419436284" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-1 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>1</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">housing</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-variable">read</span>.<span class="cm-variable">option</span>(<span class="cm-string">"inferSchema"</span>, <span class="cm-string">"true"</span>).<span class="cm-variable">option</span>(<span class="cm-string">"header"</span>,<span class="cm-string">"true"</span>).<span class="cm-variable">csv</span>(<span class="cm-string">"/FileStore/tables/housing.csv"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">housing:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 8 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">housing: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 8 more fields]
</div></div></div><div class="command-result-stats">Command took <span>8.62 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:38:56 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436285"><i class="fa fa-link" style="text-align: center;"></i>Cmd 3</a><div class="new-notebook command mainCommand command-finished cellIndex-2 cell-475989419436282-475989419436285" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-2 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-2 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">2.</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Discover</span><span class="cm-header header-1"> </span><span class="cm-header header-1">the</span><span class="cm-header header-1"> </span><span class="cm-header header-1">data</span><span class="cm-header header-1"> </span><span class="cm-header header-1">to</span><span class="cm-header header-1"> </span><span class="cm-header header-1">gain</span><span class="cm-header header-1"> </span><span class="cm-header header-1">insights</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>Now</span><span> </span><span>it</span><span> </span><span>is</span><span> </span><span>time</span><span> </span><span>to</span><span> </span><span>take</span><span> </span><span>a</span><span> </span><span>look</span><span> </span><span>at</span><span> </span><span>the</span><span> </span><span>data.</span><span> </span><span>In</span><span> </span><span>this</span><span> </span><span>step</span><span> </span><span>we</span><span> </span><span>are</span><span> </span><span>going</span><span> </span><span>to</span><span> </span><span>take</span><span> </span><span>a</span><span> </span><span>look</span><span> </span><span>at</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>a</span><span> </span><span>few</span><span> </span><span>different</span><span> </span><span>ways</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">See</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">schema</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">dimension</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">dataset</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Look</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">at</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data</span><span class="cm-variable-2"> </span><span class="cm-variable-2">itself</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Statistical</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">summary</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">attributes</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Breakdown</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data</span><span class="cm-variable-2"> </span><span class="cm-variable-2">by</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">categorical</span><span class="cm-variable-2"> </span><span class="cm-variable-2">attribute</span><span class="cm-variable-2"> </span><span class="cm-variable-2">variable</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Find</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">correlation</span><span class="cm-variable-2"> </span><span class="cm-variable-2">among</span><span class="cm-variable-2"> </span><span class="cm-variable-2">different</span><span class="cm-variable-2"> </span><span class="cm-variable-2">attributes</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Make</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">new</span><span class="cm-variable-2"> </span><span class="cm-variable-2">attributes</span><span class="cm-variable-2"> </span><span class="cm-variable-2">by</span><span class="cm-variable-2"> </span><span class="cm-variable-2">combining</span><span class="cm-variable-2"> </span><span class="cm-variable-2">existing</span><span class="cm-variable-2"> </span><span class="cm-variable-2">attributes</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="212355f8-82f5-4953-94d5-b2397fcdec04" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><hr>
<h1>2. Discover the data to gain insights</h1>
<p>Now it is time to take a look at the data. In this step we are going to take a look at the data a few different ways:</p>
<ul>
<li>See the schema and dimension of the dataset</li>
<li>Look at the data itself</li>
<li>Statistical summary of the attributes</li>
<li>Breakdown of the data by the categorical attribute variable</li>
<li>Find the correlation among different attributes</li>
<li>Make new attributes by combining existing attributes</li>
</ul>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436286"><i class="fa fa-link" style="text-align: center;"></i>Cmd 4</a><div class="new-notebook command mainCommand command-finished cellIndex-3 cell-475989419436282-475989419436286" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-3 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-3 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">2.1.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Schema</span><span class="cm-header header-2"> </span><span class="cm-header header-2">and</span><span class="cm-header header-2"> </span><span class="cm-header header-2">dimension</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>schema</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>dataset</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="e2b9b0d8-e910-44f3-be34-6f5fdbd77140" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>2.1. Schema and dimension</h2>
<p>Print the schema of the dataset</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436287"><i class="fa fa-link" style="text-align: center;"></i>Cmd 5</a><div class="new-notebook command mainCommand command-finished cellIndex-4 cell-475989419436282-475989419436287" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-4 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 55.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 25.5938px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">printSchema</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">root
 |-- longitude: double (nullable = true)
 |-- latitude: double (nullable = true)
 |-- housing_median_age: double (nullable = true)
 |-- total_rooms: double (nullable = true)
 |-- total_bedrooms: double (nullable = true)
 |-- population: double (nullable = true)
 |-- households: double (nullable = true)
 |-- median_income: double (nullable = true)
 |-- median_house_value: double (nullable = true)
 |-- ocean_proximity: string (nullable = true)

</div></div></div><div class="command-result-stats">Command took <span>0.29 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:39:16 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436288"><i class="fa fa-link" style="text-align: center;"></i>Cmd 6</a><div class="new-notebook command mainCommand command-finished cellIndex-5 cell-475989419436282-475989419436288" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-5 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-5 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>records</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>dataset.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="ea210391-556f-4a03-968c-3c1f5ab71c91" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Print the number of records in the dataset.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436289"><i class="fa fa-link" style="text-align: center;"></i>Cmd 7</a><div class="new-notebook command mainCommand command-finished cellIndex-6 cell-475989419436282-475989419436289" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-6 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 55.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 25.5938px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">count</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">res2: Long = 20640
</div></div></div><div class="command-result-stats">Command took <span>1.07 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:39:26 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436290"><i class="fa fa-link" style="text-align: center;"></i>Cmd 8</a><div class="new-notebook command mainCommand command-finished cellIndex-7 cell-475989419436282-475989419436290" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-7 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-7 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">2.2.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Look</span><span class="cm-header header-2"> </span><span class="cm-header header-2">at</span><span class="cm-header header-2"> </span><span class="cm-header header-2">the</span><span class="cm-header header-2"> </span><span class="cm-header header-2">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>first</span><span> </span><span>five</span><span> </span><span>records</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>dataset.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="bca941ab-51a2-4a81-98f2-7552a5171530" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>2.2. Look at the data</h2>
<p>Print the first five records of the dataset.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436291"><i class="fa fa-link" style="text-align: center;"></i>Cmd 9</a><div class="new-notebook command mainCommand command-finished cellIndex-8 cell-475989419436282-475989419436291" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-8 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 55.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 25.5938px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+---------+--------+------------------+-----------+--------------+----------+----------+-------------+------------------+---------------+
|longitude|latitude|housing_median_age|total_rooms|total_bedrooms|population|households|median_income|median_house_value|ocean_proximity|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+------------------+---------------+
|  -122.23|   37.88|              41.0|      880.0|         129.0|     322.0|     126.0|       8.3252|          452600.0|       NEAR BAY|
|  -122.22|   37.86|              21.0|     7099.0|        1106.0|    2401.0|    1138.0|       8.3014|          358500.0|       NEAR BAY|
|  -122.24|   37.85|              52.0|     1467.0|         190.0|     496.0|     177.0|       7.2574|          352100.0|       NEAR BAY|
|  -122.25|   37.85|              52.0|     1274.0|         235.0|     558.0|     219.0|       5.6431|          341300.0|       NEAR BAY|
|  -122.25|   37.85|              52.0|     1627.0|         280.0|     565.0|     259.0|       3.8462|          342200.0|       NEAR BAY|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+------------------+---------------+
only showing top 5 rows

</div></div></div><div class="command-result-stats">Command took <span>0.80 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:39:38 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436292"><i class="fa fa-link" style="text-align: center;"></i>Cmd 10</a><div class="new-notebook command mainCommand command-finished cellIndex-9 cell-475989419436282-475989419436292" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-9 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-9 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>records</span><span> </span><span>with</span><span> </span><span>population</span><span> </span><span>more</span><span> </span><span>than</span><span> </span><span>10000.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="4fe556ba-c561-4477-968b-d262606fe5d8" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Print the number of records with population more than 10000.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436293"><i class="fa fa-link" style="text-align: center;"></i>Cmd 11</a><div class="new-notebook command mainCommand command-finished cellIndex-10 cell-475989419436282-475989419436293" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-10 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 49.3333px; left: 391.031px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 361.031px; top: 37.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">filter</span>(<span class="cm-variable">$</span><span class="cm-string">"population"</span> <span class="cm-operator">&gt;</span> <span class="cm-number">10000</span>).<span class="cm-variable">count</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">res7: Long = 23
</div></div></div><div class="command-result-stats">Command took <span>1.04 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:42:07 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436294"><i class="fa fa-link" style="text-align: center;"></i>Cmd 12</a><div class="new-notebook command mainCommand command-finished cellIndex-11 cell-475989419436282-475989419436294" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-11 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-11 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">2.3.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Statistical</span><span class="cm-header header-2"> </span><span class="cm-header header-2">summary</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Print</span><span> </span><span>a</span><span> </span><span>summary</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>table</span><span> </span><span>statistics</span><span> </span><span>for</span><span> </span><span>the</span><span> </span><span>attributes</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">housing</span><span class="cm-comment">_</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">age</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">total</span><span class="cm-comment">_</span><span class="cm-comment">rooms</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">house</span><span class="cm-comment">_</span><span class="cm-comment">value</span><span class="cm-comment">`</span><span>,</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">population</span><span class="cm-comment">`</span><span>.</span><span> </span><span>You</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">describe</span><span class="cm-comment">`</span><span> </span><span>command.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8e3edb93-2bdf-47d4-b23d-a72e6a832ed0" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>2.3. Statistical summary</h2>
<p>Print a summary of the table statistics for the attributes <code>housing_median_age</code>, <code>total_rooms</code>, <code>median_house_value</code>, and <code>population</code>. You can use the <code>describe</code> command.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436295"><i class="fa fa-link" style="text-align: center;"></i>Cmd 13</a><div class="new-notebook command mainCommand command-finished cellIndex-12 cell-475989419436282-475989419436295" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-12 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 49.3334px; left: 726.438px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 696.438px; top: 37.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">describe</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-string">"housing_median_age"</span>, <span class="cm-string">"total_rooms"</span>, <span class="cm-string">"median_house_value"</span>, <span class="cm-string">"population"</span><span class=" CodeMirror-matchingbracket">)</span>.<span class="cm-variable">show</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+-------+------------------+------------------+------------------+------------------+
|summary|housing_median_age|       total_rooms|median_house_value|        population|
+-------+------------------+------------------+------------------+------------------+
|  count|             20640|             20640|             20640|             20640|
|   mean|28.639486434108527|2635.7630813953488|206855.81690891474|1425.4767441860465|
| stddev| 12.58555761211163|2181.6152515827944|115395.61587441359|  1132.46212176534|
|    min|               1.0|               2.0|           14999.0|               3.0|
|    max|              52.0|           39320.0|          500001.0|           35682.0|
+-------+------------------+------------------+------------------+------------------+

</div></div></div><div class="command-result-stats">Command took <span>2.56 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:42:57 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436296"><i class="fa fa-link" style="text-align: center;"></i>Cmd 14</a><div class="new-notebook command mainCommand command-finished cellIndex-13 cell-475989419436282-475989419436296" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-13 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-13 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>maximum</span><span> </span><span>age</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">housing</span><span class="cm-comment">_</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">age</span><span class="cm-comment">`</span><span>),</span><span> </span><span>the</span><span> </span><span>minimum</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>rooms</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">total</span><span class="cm-comment">_</span><span class="cm-comment">rooms</span><span class="cm-comment">`</span><span>),</span><span> </span><span>and</span><span> </span><span>the</span><span> </span><span>average</span><span> </span><span>of</span><span> </span><span>house</span><span> </span><span>values</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">house</span><span class="cm-comment">_</span><span class="cm-comment">value</span><span class="cm-comment">`</span><span>).</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="47d51e76-5b83-440b-b8cd-e66c7d0306cc" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Print the maximum age (<code>housing_median_age</code>), the minimum number of rooms (<code>total_rooms</code>), and the average of house values (<code>median_house_value</code>).</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436297"><i class="fa fa-link" style="text-align: center;"></i>Cmd 15</a><div class="new-notebook command mainCommand command-finished cellIndex-14 cell-475989419436282-475989419436297" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-14 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 86.6667px; left: 710.854px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 129px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 680.854px; top: 74.6667px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">functions</span>.<span class="cm-keyword">_</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">select</span>(<span class="cm-variable">max</span>(<span class="cm-string">"housing_median_age"</span>), <span class="cm-variable">min</span>(<span class="cm-string">"total_rooms"</span>), <span class="cm-variable">avg</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-string">"median_house_value"</span><span class=" CodeMirror-matchingbracket">)</span>).<span class="cm-variable">show</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 129px;"></div><div class="CodeMirror-gutters" style="height: 142px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+-----------------------+----------------+-----------------------+
|max(housing_median_age)|min(total_rooms)|avg(median_house_value)|
+-----------------------+----------------+-----------------------+
|                   52.0|             2.0|     206855.81690891474|
+-----------------------+----------------+-----------------------+

import org.apache.spark.sql.functions._
</div></div></div><div class="command-result-stats">Command took <span>1.50 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:43:54 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436298"><i class="fa fa-link" style="text-align: center;"></i>Cmd 16</a><div class="new-notebook command mainCommand command-finished cellIndex-15 cell-475989419436282-475989419436298" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-15 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-15 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">2.4.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Breakdown</span><span class="cm-header header-2"> </span><span class="cm-header header-2">the</span><span class="cm-header header-2"> </span><span class="cm-header header-2">data</span><span class="cm-header header-2"> </span><span class="cm-header header-2">by</span><span class="cm-header header-2"> </span><span class="cm-header header-2">categorical</span><span class="cm-header header-2"> </span><span class="cm-header header-2">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>houses</span><span> </span><span>in</span><span> </span><span>different</span><span> </span><span>areas</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">ocean</span><span class="cm-comment">_</span><span class="cm-comment">proximity</span><span class="cm-comment">`</span><span>),</span><span> </span><span>and</span><span> </span><span>sort</span><span> </span><span>them</span><span> </span><span>in</span><span> </span><span>descending</span><span> </span><span>order.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="478c6925-0c42-4f6b-b3f2-1a9e26c4cdca" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>2.4. Breakdown the data by categorical data</h2>
<p>Print the number of houses in different areas (<code>ocean_proximity</code>), and sort them in descending order.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436299"><i class="fa fa-link" style="text-align: center;"></i>Cmd 17</a><div class="new-notebook command mainCommand command-finished cellIndex-16 cell-475989419436282-475989419436299" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-16 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 68px; left: 523.656px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 111px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>5</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 493.656px; top: 56px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">groupBy</span>(<span class="cm-string">"ocean_proximity"</span>).<span class="cm-variable">count</span>().<span class="cm-variable">show</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">groupBy</span>(<span class="cm-string">"ocean_proximity"</span>).<span class="cm-variable">count</span>().<span class="cm-variable">sort</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">desc</span>(<span class="cm-string">"count"</span>)<span class=" CodeMirror-matchingbracket">)</span>.<span class="cm-variable">show</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 111px;"></div><div class="CodeMirror-gutters" style="height: 124px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(4) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+---------------+-----+
|ocean_proximity|count|
+---------------+-----+
|         ISLAND|    5|
|     NEAR OCEAN| 2658|
|       NEAR BAY| 2290|
|      &lt;1H OCEAN| 9136|
|         INLAND| 6551|
+---------------+-----+

+---------------+-----+
|ocean_proximity|count|
+---------------+-----+
|      &lt;1H OCEAN| 9136|
|         INLAND| 6551|
|     NEAR OCEAN| 2658|
|       NEAR BAY| 2290|
|         ISLAND|    5|
+---------------+-----+

</div></div></div><div class="command-result-stats">Command took <span>3.50 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:46:05 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436300"><i class="fa fa-link" style="text-align: center;"></i>Cmd 18</a><div class="new-notebook command mainCommand command-finished cellIndex-17 cell-475989419436282-475989419436300" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-17 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-17 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>average</span><span> </span><span>value</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>houses</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">house</span><span class="cm-comment">_</span><span class="cm-comment">value</span><span class="cm-comment">`</span><span>)</span><span> </span><span>in</span><span> </span><span>different</span><span> </span><span>areas</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">ocean</span><span class="cm-comment">_</span><span class="cm-comment">proximity</span><span class="cm-comment">`</span><span>),</span><span> </span><span>and</span><span> </span><span>call</span><span> </span><span>the</span><span> </span><span>new</span><span> </span><span>column</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">avg</span><span class="cm-comment">_</span><span class="cm-comment">value</span><span class="cm-comment">`</span><span> </span><span>when</span><span> </span><span>print</span><span> </span><span>it.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="9f5c6946-4f8f-4ab0-8e6e-17bea4aa66e8" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Print the average value of the houses (<code>median_house_value</code>) in different areas (<code>ocean_proximity</code>), and call the new column <code>avg_value</code> when print it.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436301"><i class="fa fa-link" style="text-align: center;"></i>Cmd 19</a><div class="new-notebook command mainCommand command-finished cellIndex-18 cell-475989419436282-475989419436301" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-18 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 49.3333px; left: 866.833px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 92px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>3</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 836.833px; top: 37.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">groupBy</span>(<span class="cm-string">"ocean_proximity"</span>).<span class="cm-variable">avg</span>(<span class="cm-string">"median_house_value"</span>).<span class="cm-variable">withColumnRenamed</span>(<span class="cm-string">"avg(median_house_value)"</span>,<span class="cm-string">"avg_value"</span>).<span class="cm-variable">show</span>()</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 92px;"></div><div class="CodeMirror-gutters" style="height: 105px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+---------------+------------------+
|ocean_proximity|         avg_value|
+---------------+------------------+
|         ISLAND|          380440.0|
|     NEAR OCEAN|249433.97742663656|
|       NEAR BAY|259212.31179039303|
|      &lt;1H OCEAN|240084.28546409807|
|         INLAND|124805.39200122119|
+---------------+------------------+

</div></div></div><div class="command-result-stats">Command took <span>1.59 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:46:55 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436302"><i class="fa fa-link" style="text-align: center;"></i>Cmd 20</a><div class="new-notebook command mainCommand command-finished cellIndex-19 cell-475989419436282-475989419436302" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-19 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-19 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Rewrite</span><span> </span><span>the</span><span> </span><span>above</span><span> </span><span>question</span><span> </span><span>in</span><span> </span><span>SQL.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="e8a3f1df-81e7-4319-8e24-6e1a2bd7bf12" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Rewrite the above question in SQL.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436303"><i class="fa fa-link" style="text-align: center;"></i>Cmd 21</a><div class="new-notebook command mainCommand command-finished cellIndex-20 cell-475989419436282-475989419436303" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-20 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 105.333px; left: 625.031px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 129px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 595.031px; top: 93.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">//TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housing</span>.<span class="cm-variable">createOrReplaceTempView</span>(<span class="cm-string">"df"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">housingSQL</span> <span class="cm-operator">=</span> <span class="cm-variable">spark</span>.<span class="cm-variable">sql</span>(<span class="cm-string">"SELECT ocean_proximity, AVG(median_house_value) FROM df GROUP BY ocean_proximity"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housingSQL</span>.<span class="cm-variable">show</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housingSQL</span>.<span class="cm-variable">withColumnRenamed</span>(<span class="cm-string">"avg(median_house_value)"</span>, <span class="cm-string">"avg_value"</span>).<span class="cm-variable">show</span><span class=" CodeMirror-matchingbracket">(</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 129px;"></div><div class="CodeMirror-gutters" style="height: 142px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(4) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">housingSQL:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [ocean_proximity: string, avg(median_house_value): double]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+---------------+-----------------------+
|ocean_proximity|avg(median_house_value)|
+---------------+-----------------------+
|         ISLAND|               380440.0|
|     NEAR OCEAN|     249433.97742663656|
|       NEAR BAY|     259212.31179039303|
|      &lt;1H OCEAN|     240084.28546409807|
|         INLAND|     124805.39200122119|
+---------------+-----------------------+

+---------------+------------------+
|ocean_proximity|         avg_value|
+---------------+------------------+
|         ISLAND|          380440.0|
|     NEAR OCEAN|249433.97742663656|
|       NEAR BAY|259212.31179039303|
|      &lt;1H OCEAN|240084.28546409807|
|         INLAND|124805.39200122119|
+---------------+------------------+

housingSQL: org.apache.spark.sql.DataFrame = [ocean_proximity: string, avg(median_house_value): double]
</div></div></div><div class="command-result-stats">Command took <span>2.45 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:47:44 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436304"><i class="fa fa-link" style="text-align: center;"></i>Cmd 22</a><div class="new-notebook command mainCommand command-finished cellIndex-21 cell-475989419436282-475989419436304" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-21 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-21 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">2.5.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Correlation</span><span class="cm-header header-2"> </span><span class="cm-header header-2">among</span><span class="cm-header header-2"> </span><span class="cm-header header-2">attributes</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Print</span><span> </span><span>the</span><span> </span><span>correlation</span><span> </span><span>among</span><span> </span><span>the</span><span> </span><span>attributes</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">housing</span><span class="cm-comment">_</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">age</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">total</span><span class="cm-comment">_</span><span class="cm-comment">rooms</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">house</span><span class="cm-comment">_</span><span class="cm-comment">value</span><span class="cm-comment">`</span><span>,</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">population</span><span class="cm-comment">`</span><span>.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>so,</span><span> </span><span>first</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>put</span><span> </span><span>these</span><span> </span><span>attributes</span><span> </span><span>into</span><span> </span><span>one</span><span> </span><span>vector.</span><span> </span><span>Then,</span><span> </span><span>compute</span><span> </span><span>the</span><span> </span><span>standard</span><span> </span><span>correlation</span><span> </span><span>coefficient</span><span> </span><span>(</span><span>Pearson)</span><span> </span><span>between</span><span> </span><span>every</span><span> </span><span>pair</span><span> </span><span>of</span><span> </span><span>attributes</span><span> </span><span>in</span><span> </span><span>this</span><span> </span><span>new</span><span> </span><span>vector.</span><span> </span><span>To</span><span> </span><span>make</span><span> </span><span>a</span><span> </span><span>vector</span><span> </span><span>of</span><span> </span><span>these</span><span> </span><span>attributes,</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">VectorAssembler</span><span class="cm-comment">`</span><span> </span><span>Transformer.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="a79cb34d-e6be-42c4-896a-832d0b36426d" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>2.5. Correlation among attributes</h2>
<p>Print the correlation among the attributes <code>housing_median_age</code>, <code>total_rooms</code>, <code>median_house_value</code>, and <code>population</code>. To do so, first you need to put these attributes into one vector. Then, compute the standard correlation coefficient (Pearson) between every pair of attributes in this new vector. To make a vector of these attributes, you can use the <code>VectorAssembler</code> Transformer.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436305"><i class="fa fa-link" style="text-align: center;"></i>Cmd 23</a><div class="new-notebook command mainCommand command-finished cellIndex-22 cell-475989419436282-475989419436305" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-22 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 180px; left: 196.021px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 204px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 166.021px; top: 168px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">feature</span>.<span class="cm-variable">VectorAssembler</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">va</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">VectorAssembler</span>().<span class="cm-variable">setInputCols</span>(<span class="cm-type">Array</span>(<span class="cm-string">"housing_median_age"</span>, <span class="cm-string">"total_rooms"</span>,<span class="cm-string">"median_house_value"</span>, <span class="cm-string">"population"</span>)).<span class="cm-variable">setOutputCol</span>(<span class="cm-string">"features"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">housingAttrs</span> <span class="cm-operator">=</span> <span class="cm-variable">va</span>.<span class="cm-variable">transform</span>(<span class="cm-variable">housing</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housingAttrs</span>.<span class="cm-variable">show</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-number">5</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 204px;"></div><div class="CodeMirror-gutters" style="height: 217px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">housingAttrs:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 9 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-1ehnzue" tabindex="0"><div class="results"><div class="ansiout">+---------+--------+------------------+-----------+--------------+----------+----------+-------------+------------------+---------------+--------------------+
|longitude|latitude|housing_median_age|total_rooms|total_bedrooms|population|households|median_income|median_house_value|ocean_proximity|            features|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+------------------+---------------+--------------------+
|  -122.23|   37.88|              41.0|      880.0|         129.0|     322.0|     126.0|       8.3252|          452600.0|       NEAR BAY|[41.0,880.0,45260...|
|  -122.22|   37.86|              21.0|     7099.0|        1106.0|    2401.0|    1138.0|       8.3014|          358500.0|       NEAR BAY|[21.0,7099.0,3585...|
|  -122.24|   37.85|              52.0|     1467.0|         190.0|     496.0|     177.0|       7.2574|          352100.0|       NEAR BAY|[52.0,1467.0,3521...|
|  -122.25|   37.85|              52.0|     1274.0|         235.0|     558.0|     219.0|       5.6431|          341300.0|       NEAR BAY|[52.0,1274.0,3413...|
|  -122.25|   37.85|              52.0|     1627.0|         280.0|     565.0|     259.0|       3.8462|          342200.0|       NEAR BAY|[52.0,1627.0,3422...|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+------------------+---------------+--------------------+
only showing top 5 rows

import org.apache.spark.ml.feature.VectorAssembler
va: org.apache.spark.ml.feature.VectorAssembler = VectorAssembler: uid=vecAssembler_eec0a62d13a0, handleInvalid=error, numInputCols=4
housingAttrs: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 9 more fields]
</div></div></div><div class="command-result-stats">Command took <span>1.97 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:24:55 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436306"><i class="fa fa-link" style="text-align: center;"></i>Cmd 24</a><div class="new-notebook command mainCommand command-finished cellIndex-23 cell-475989419436282-475989419436306" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-23 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 124px; left: 601.667px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 185px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>9</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 571.667px; top: 112px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">linalg</span>.<span class="cm-variable">Matrix</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">stat</span>.<span class="cm-variable">Correlation</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">sql</span>.<span class="cm-variable">Row</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">Row</span>(<span class="cm-variable">coeff</span>: <span class="cm-variable">Matrix</span>) <span class="cm-operator">=</span> <span class="cm-variable">Correlation</span>.<span class="cm-variable">corr</span>(<span class="cm-variable">housingAttrs</span>, <span class="cm-string">"features"</span>).<span class="cm-variable">head</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">println</span>(<span class="cm-variable">s</span><span class="cm-string">"The standard correlation coefficient:\n ${coeff}"</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 185px;"></div><div class="CodeMirror-gutters" style="height: 198px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(4) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">The standard correlation coefficient:
 1.0                   -0.3612622012223152  0.10562341249321029    -0.29624423977353675   
-0.3612622012223152   1.0                  0.13415311380656375    0.8571259728659744     
0.10562341249321029   0.13415311380656375  1.0                    -0.024649678888894997  
-0.29624423977353675  0.8571259728659744   -0.024649678888894997  1.0                    
import org.apache.spark.ml.linalg.Matrix
import org.apache.spark.ml.stat.Correlation
import org.apache.spark.sql.Row
coeff: org.apache.spark.ml.linalg.Matrix =
1.0                   -0.3612622012223152  0.10562341249321029    -0.29624423977353675
-0.3612622012223152   1.0                  0.13415311380656375    0.8571259728659744
0.10562341249321029   0.13415311380656375  1.0                    -0.024649678888894997
-0.29624423977353675  0.8571259728659744   -0.024649678888894997  1.0
</div></div></div><div class="command-result-stats">Command took <span>5.81 seconds</span> -- by tuccio@kth.se at 12/11/2021, 09:52:00 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436307"><i class="fa fa-link" style="text-align: center;"></i>Cmd 25</a><div class="new-notebook command mainCommand command-finished cellIndex-24 cell-475989419436282-475989419436307" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-24 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-24 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">2.6.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Combine</span><span class="cm-header header-2"> </span><span class="cm-header header-2">and</span><span class="cm-header header-2"> </span><span class="cm-header header-2">make</span><span class="cm-header header-2"> </span><span class="cm-header header-2">new</span><span class="cm-header header-2"> </span><span class="cm-header header-2">attributes</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Now,</span><span> </span><span>let</span><span>'</span><span>s</span><span> </span><span>try</span><span> </span><span>out</span><span> </span><span>various</span><span> </span><span>attribute</span><span> </span><span>combinations.</span><span> </span><span>In</span><span> </span><span>the</span><span> </span><span>given</span><span> </span><span>dataset,</span><span> </span><span>the</span><span> </span><span>total</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>rooms</span><span> </span><span>in</span><span> </span><span>a</span><span> </span><span>block</span><span> </span><span>is</span><span> </span><span>not</span><span> </span><span>very</span><span> </span><span>useful,</span><span> </span><span>if</span><span> </span><span>we</span><span> </span><span>don</span><span>'</span><span>t</span><span> </span><span>know</span><span> </span><span>how</span><span> </span><span>many</span><span> </span><span>households</span><span> </span><span>there</span><span> </span><span>are.</span><span> </span><span>What</span><span> </span><span>we</span><span> </span><span>really</span><span> </span><span>want</span><span> </span><span>is</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>rooms</span><span> </span><span>per</span><span> </span><span>household.</span><span> </span><span>Similarly,</span><span> </span><span>the</span><span> </span><span>total</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>bedrooms</span><span> </span><span>by</span><span> </span><span>itself</span><span> </span><span>is</span><span> </span><span>not</span><span> </span><span>very</span><span> </span><span>useful,</span><span> </span><span>and</span><span> </span><span>we</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>compare</span><span> </span><span>it</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>rooms.</span><span> </span><span>And</span><span> </span><span>the</span><span> </span><span>population</span><span> </span><span>per</span><span> </span><span>household</span><span> </span><span>seems</span><span> </span><span>like</span><span> </span><span>also</span><span> </span><span>an</span><span> </span><span>interesting</span><span> </span><span>attribute</span><span> </span><span>combination</span><span> </span><span>to</span><span> </span><span>look</span><span> </span><span>at.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>so,</span><span> </span><span>add</span><span> </span><span>the</span><span> </span><span>three</span><span> </span><span>new</span><span> </span><span>columns</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>dataset</span><span> </span><span>as</span><span> </span><span>below.</span><span> </span><span>We</span><span> </span><span>will</span><span> </span><span>call</span><span> </span><span>the</span><span> </span><span>new</span><span> </span><span>dataset</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">housingExtra</span><span class="cm-comment">`</span><span>.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-comment">```</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-comment">rooms_per_household = total_rooms / households</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-comment">bedrooms_per_room = total_bedrooms / total_rooms</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-comment">population_per_household = population / households</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-comment">```</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="72cc01fb-7d0f-4ab2-997a-a20e663ed59b" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>2.6. Combine and make new attributes</h2>
<p>Now, let's try out various attribute combinations. In the given dataset, the total number of rooms in a block is not very useful, if we don't know how many households there are. What we really want is the number of rooms per household. Similarly, the total number of bedrooms by itself is not very useful, and we want to compare it to the number of rooms. And the population per household seems like also an interesting attribute combination to look at. To do so, add the three new columns to the dataset as below. We will call the new dataset the <code>housingExtra</code>.</p>
<pre><code>rooms_per_household = total_rooms / households
bedrooms_per_room = total_bedrooms / total_rooms
population_per_household = population / households
</code></pre></div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436308"><i class="fa fa-link" style="text-align: center;"></i>Cmd 26</a><div class="new-notebook command mainCommand command-finished cellIndex-25 cell-475989419436282-475989419436308" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-25 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 86.6667px; left: 531.417px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 148px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>7</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 501.417px; top: 74.6667px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">housingCol1</span> <span class="cm-operator">=</span> <span class="cm-variable">housing</span>.<span class="cm-variable">withColumn</span>(<span class="cm-string">"rooms_per_household"</span>, <span class="cm-variable">col</span>(<span class="cm-string">"total_rooms"</span>)<span class="cm-operator">/</span><span class="cm-variable">col</span>(<span class="cm-string">"households"</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">housingCol2</span> <span class="cm-operator">=</span> <span class="cm-variable">housingCol1</span>.<span class="cm-variable">withColumn</span>(<span class="cm-string">"bedrooms_per_room"</span>, <span class="cm-variable">col</span>(<span class="cm-string">"total_bedrooms"</span>)<span class="cm-operator">/</span><span class="cm-variable">col</span>(<span class="cm-string">"total_rooms"</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">housingExtra</span> <span class="cm-operator">=</span> <span class="cm-variable">housingCol2</span>.<span class="cm-variable">withColumn</span>(<span class="cm-string">"population_per_household"</span>, <span class="cm-variable">col</span>(<span class="cm-string">"population"</span>) <span class="cm-operator">/</span> <span class="cm-variable">col</span>(<span class="cm-string">"households"</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">housingExtra</span>.<span class="cm-variable">select</span>(<span class="cm-string">"rooms_per_household"</span>, <span class="cm-string">"bedrooms_per_room"</span>, <span class="cm-string">"population_per_household"</span>).<span class="cm-variable">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 148px;"></div><div class="CodeMirror-gutters" style="height: 161px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(1) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">housingCol1:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 9 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">housingCol2:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 10 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">housingExtra:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 11 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+-------------------+-------------------+------------------------+
|rooms_per_household|  bedrooms_per_room|population_per_household|
+-------------------+-------------------+------------------------+
|  6.984126984126984|0.14659090909090908|      2.5555555555555554|
|  6.238137082601054|0.15579659106916466|       2.109841827768014|
|  8.288135593220339|0.12951601908657123|      2.8022598870056497|
| 5.8173515981735155|0.18445839874411302|       2.547945205479452|
|  6.281853281853282| 0.1720958819913952|      2.1814671814671813|
+-------------------+-------------------+------------------------+
only showing top 5 rows

housingCol1: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 9 more fields]
housingCol2: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 10 more fields]
housingExtra: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 11 more fields]
</div></div></div><div class="command-result-stats">Command took <span>1.49 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:02:25 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436309"><i class="fa fa-link" style="text-align: center;"></i>Cmd 27</a><div class="new-notebook command mainCommand command-finished cellIndex-26 cell-475989419436282-475989419436309" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-26 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-26 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">3.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Prepare</span><span class="cm-header header-2"> </span><span class="cm-header header-2">the</span><span class="cm-header header-2"> </span><span class="cm-header header-2">data</span><span class="cm-header header-2"> </span><span class="cm-header header-2">for</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Machine</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Learning</span><span class="cm-header header-2"> </span><span class="cm-header header-2">algorithms</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>Before</span><span> </span><span>going</span><span> </span><span>through</span><span> </span><span>the</span><span> </span><span>Machine</span><span> </span><span>Learning</span><span> </span><span>steps,</span><span> </span><span>let</span><span>'</span><span>s</span><span> </span><span>first</span><span> </span><span>rename</span><span> </span><span>the</span><span> </span><span>label</span><span> </span><span>column</span><span> </span><span>from</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">median</span><span class="cm-comment">_</span><span class="cm-comment">house</span><span class="cm-comment">_</span><span class="cm-comment">value</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">label</span><span class="cm-comment">`</span><span>.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="aa7fb9d3-a977-4323-8a71-6cb4063a2707" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><hr>
<h2>3. Prepare the data for Machine Learning algorithms</h2>
<p>Before going through the Machine Learning steps, let's first rename the label column from <code>median_house_value</code> to <code>label</code>.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436310"><i class="fa fa-link" style="text-align: center;"></i>Cmd 28</a><div class="new-notebook command mainCommand command-finished cellIndex-27 cell-475989419436282-475989419436310" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-27 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 49.3333px; left: 679.646px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 649.646px; top: 37.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">renamedHousing</span> <span class="cm-operator">=</span> <span class="cm-variable">housingExtra</span>.<span class="cm-variable">withColumnRenamed</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-string">"median_house_value"</span>, <span class="cm-string">"label"</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">renamedHousing:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 11 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">renamedHousing: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 11 more fields]
</div></div></div><div class="command-result-stats">Command took <span>0.75 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:06:29 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436311"><i class="fa fa-link" style="text-align: center;"></i>Cmd 29</a><div class="new-notebook command mainCommand command-finished cellIndex-28 cell-475989419436282-475989419436311" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-28 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-28 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Now,</span><span> </span><span>we</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>separate</span><span> </span><span>the</span><span> </span><span>numerical</span><span> </span><span>attributes</span><span> </span><span>from</span><span> </span><span>the</span><span> </span><span>categorical</span><span> </span><span>attribute</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">ocean</span><span class="cm-comment">_</span><span class="cm-comment">proximity</span><span class="cm-comment">`</span><span>)</span><span> </span><span>and</span><span> </span><span>keep</span><span> </span><span>their</span><span> </span><span>column</span><span> </span><span>names</span><span> </span><span>in</span><span> </span><span>two</span><span> </span><span>different</span><span> </span><span>lists.</span><span> </span><span>Moreover,</span><span> </span><span>sice</span><span> </span><span>we</span><span> </span><span>don</span><span>'</span><span>t</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>apply</span><span> </span><span>the</span><span> </span><span>same</span><span> </span><span>transformations</span><span> </span><span>to</span><span> </span><span>the</span><span> </span><span>predictors</span><span> </span><span>(</span><span>features)</span><span> </span><span>and</span><span> </span><span>the</span><span> </span><span>label,</span><span> </span><span>we</span><span> </span><span>should</span><span> </span><span>remove</span><span> </span><span>the</span><span> </span><span>label</span><span> </span><span>attribute</span><span> </span><span>from</span><span> </span><span>the</span><span> </span><span>list</span><span> </span><span>of</span><span> </span><span>predictors.</span><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="80ff1932-bbce-4cd2-971f-b4b5defee553" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Now, we want to separate the numerical attributes from the categorical attribute (<code>ocean_proximity</code>) and keep their column names in two different lists. Moreover, sice we don't want to apply the same transformations to the predictors (features) and the label, we should remove the label attribute from the list of predictors. </p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436312"><i class="fa fa-link" style="text-align: center;"></i>Cmd 30</a><div class="new-notebook command mainCommand command-finished cellIndex-29 cell-475989419436282-475989419436312" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-29 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 105.333px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 167px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 93.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// label columns</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">colLabel</span> <span class="cm-operator">=</span> <span class="cm-string">"label"</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// categorical columns</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">colCat</span> <span class="cm-operator">=</span> <span class="cm-string">"ocean_proximity"</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// numerical columns</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">colNum</span> <span class="cm-operator">=</span> <span class="cm-variable">renamedHousing</span>.<span class="cm-variable">columns</span>.<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span> <span class="cm-operator">!=</span> <span class="cm-variable">colLabel</span>).<span class="cm-variable">filter</span>(<span class="cm-keyword">_</span> <span class="cm-operator">!=</span> <span class="cm-variable">colCat</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 167px;"></div><div class="CodeMirror-gutters" style="height: 180px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">colLabel: String = label
colCat: String = ocean_proximity
colNum: Array[String] = Array(longitude, latitude, housing_median_age, total_rooms, total_bedrooms, population, households, median_income, rooms_per_household, bedrooms_per_room, population_per_household)
</div></div></div><div class="command-result-stats">Command took <span>0.43 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:37:24 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436313"><i class="fa fa-link" style="text-align: center;"></i>Cmd 31</a><div class="new-notebook command mainCommand command-finished cellIndex-30 cell-475989419436282-475989419436313" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-30 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-30 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">3.1.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Prepare</span><span class="cm-header header-2"> </span><span class="cm-header header-2">continuse</span><span class="cm-header header-2"> </span><span class="cm-header header-2">attributes</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-3">### </span><span class="cm-header header-3">Data</span><span class="cm-header header-3"> </span><span class="cm-header header-3">cleaning</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>Most</span><span> </span><span>Machine</span><span> </span><span>Learning</span><span> </span><span>algorithms</span><span> </span><span>cannot</span><span> </span><span>work</span><span> </span><span>with</span><span> </span><span>missing</span><span> </span><span>features,</span><span> </span><span>so</span><span> </span><span>we</span><span> </span><span>should</span><span> </span><span>take</span><span> </span><span>care</span><span> </span><span>of</span><span> </span><span>them.</span><span> </span><span>As</span><span> </span><span>a</span><span> </span><span>first</span><span> </span><span>step,</span><span> </span><span>let</span><span>'</span><span>s</span><span> </span><span>find</span><span> </span><span>the</span><span> </span><span>columns</span><span> </span><span>with</span><span> </span><span>missing</span><span> </span><span>values</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>numerical</span><span> </span><span>attributes.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>so,</span><span> </span><span>we</span><span> </span><span>can</span><span> </span><span>print</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>missing</span><span> </span><span>values</span><span> </span><span>of</span><span> </span><span>each</span><span> </span><span>continues</span><span> </span><span>attributes,</span><span> </span><span>listed</span><span> </span><span>in</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">colNum</span><span class="cm-comment">`</span><span>.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="d408563e-44ba-4d8b-b527-68eb30d0c325" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>3.1. Prepare continuse attributes</h2>
<h3>Data cleaning</h3>
<p>Most Machine Learning algorithms cannot work with missing features, so we should take care of them. As a first step, let's find the columns with missing values in the numerical attributes. To do so, we can print the number of missing values of each continues attributes, listed in <code>colNum</code>.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436314"><i class="fa fa-link" style="text-align: center;"></i>Cmd 32</a><div class="new-notebook command mainCommand command-finished cellIndex-31 cell-475989419436282-475989419436314" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-31 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 86.6667px; left: 484.625px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 129px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>6</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 454.625px; top: 74.6667px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">for</span> (<span class="cm-variable">c</span> <span class="cm-operator">&lt;-</span> <span class="cm-variable">colNum</span>) {</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">val</span> <span class="cm-def">missing</span> <span class="cm-operator">=</span> <span class="cm-variable">renamedHousing</span>.<span class="cm-variable">filter</span>(<span class="cm-variable">col</span>(<span class="cm-variable">c</span>).<span class="cm-variable">isNull</span>).<span class="cm-variable">count</span>()</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">println</span>(<span class="cm-variable">s</span><span class="cm-string">"Number of missing values in column ${c}: $</span><span class="cm-string CodeMirror-matchingbracket">{</span><span class="cm-string">missing</span><span class="cm-string CodeMirror-matchingbracket">}</span><span class="cm-string">"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 129px;"></div><div class="CodeMirror-gutters" style="height: 142px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(22) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">Number of missing values in column longitude: 0
Number of missing values in column latitude: 0
Number of missing values in column housing_median_age: 0
Number of missing values in column total_rooms: 0
Number of missing values in column total_bedrooms: 207
Number of missing values in column population: 0
Number of missing values in column households: 0
Number of missing values in column median_income: 0
Number of missing values in column rooms_per_household: 0
Number of missing values in column bedrooms_per_room: 207
Number of missing values in column population_per_household: 0
</div></div></div><div class="spark-advisor-container spark-advisor-expanded"><img class="spark-advisor-lightbulb" src="./sparkml_lab - Databricks Community Edition_files/if_lightbulb.32b79969.svg"><ul><li><span class="spark-advisor-header"><span class="spark-advisor-header-text">Accelerate queries with Delta</span>: </span><span class="spark-advisor-text">This query contains a highly selective filter. To improve the performance of queries, convert the table to Delta and run the OPTIMIZE ZORDER BY command on the table dbfs:/FileStore/tables/housing.csv.</span><span class="spark-advisor-urls"><a data-test-id="spark-advisor--docs-link" href="https://docs.databricks.com/delta/quick-start.html#optimize-a-table" rel="noreferrer" target="_blank">Learn&nbsp;more</a><a data-test-id="spark-advisor--ignore-link" class="spark-advisor-dismiss-url">Don't&nbsp;show&nbsp;me&nbsp;this&nbsp;again</a><i class="fa fa-question-circle help-icon" style="text-align: center; color: rgb(28, 160, 194);"></i></span></li></ul><span class="spark-advisor-top-right"><i title="Notebook settings" class="fa fa-cog" style="text-align: center; cursor: pointer;"> </i><i title="Close advisor" class="fa fa-times-circle" style="text-align: center; cursor: pointer;"> </i></span></div><div class="command-result-stats">Command took <span>6.04 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:11:04 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436315"><i class="fa fa-link" style="text-align: center;"></i>Cmd 33</a><div class="new-notebook command mainCommand command-finished cellIndex-32 cell-475989419436282-475989419436315" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-32 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-32 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>As</span><span> </span><span>we</span><span> </span><span>observerd</span><span> </span><span>above,</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">total</span><span class="cm-comment">_</span><span class="cm-comment">bedrooms</span><span class="cm-comment">`</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">bedrooms</span><span class="cm-comment">_</span><span class="cm-comment">per</span><span class="cm-comment">_</span><span class="cm-comment">room</span><span class="cm-comment">`</span><span> </span><span>attributes</span><span> </span><span>have</span><span> </span><span>some</span><span> </span><span>missing</span><span> </span><span>values.</span><span> </span><span>One</span><span> </span><span>way</span><span> </span><span>to</span><span> </span><span>take</span><span> </span><span>care</span><span> </span><span>of</span><span> </span><span>missing</span><span> </span><span>values</span><span> </span><span>is</span><span> </span><span>to</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Imputer</span><span class="cm-comment">`</span><span> </span><span>Transformer,</span><span> </span><span>which</span><span> </span><span>completes</span><span> </span><span>missing</span><span> </span><span>values</span><span> </span><span>in</span><span> </span><span>a</span><span> </span><span>dataset,</span><span> </span><span>either</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span>mean</span><span> </span><span>or</span><span> </span><span>the</span><span> </span><span>median</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>columns</span><span> </span><span>in</span><span> </span><span>which</span><span> </span><span>the</span><span> </span><span>missing</span><span> </span><span>values</span><span> </span><span>are</span><span> </span><span>located.</span><span> </span><span>To</span><span> </span><span>use</span><span> </span><span>it,</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>create</span><span> </span><span>an</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Imputer</span><span class="cm-comment">`</span><span> </span><span>instance,</span><span> </span><span>specifying</span><span> </span><span>that</span><span> </span><span>you</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>replace</span><span> </span><span>each</span><span> </span><span>attribute</span><span>'</span><span>s</span><span> </span><span>missing</span><span> </span><span>values</span><span> </span><span>with</span><span> </span><span>the</span><span> </span><span>"</span><span>median</span><span>"</span><span> </span><span>of</span><span> </span><span>that</span><span> </span><span>attribute.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="1b44b468-14d5-497c-bd8c-bb08f844cf52" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>As we observerd above, the <code>total_bedrooms</code> and <code>bedrooms_per_room</code> attributes have some missing values. One way to take care of missing values is to use the <code>Imputer</code> Transformer, which completes missing values in a dataset, either using the mean or the median of the columns in which the missing values are located. To use it, you need to create an <code>Imputer</code> instance, specifying that you want to replace each attribute's missing values with the "median" of that attribute.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436316"><i class="fa fa-link" style="text-align: center;"></i>Cmd 34</a><div class="new-notebook command mainCommand command-finished cellIndex-33 cell-475989419436282-475989419436316" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-33 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 105.333px; left: 734.25px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 204px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 704.25px; top: 93.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">feature</span>.<span class="cm-variable">Imputer</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">imputer</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">Imputer</span>().<span class="cm-variable">setStrategy</span>(<span class="cm-string">"median"</span>).<span class="cm-variable">setInputCols</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-type">Array</span>(<span class="cm-string">"total_bedrooms"</span>,<span class="cm-string">"bedrooms_per_room"</span>)<span class=" CodeMirror-matchingbracket">)</span>.<span class="cm-variable">setOutputCols</span>(<span class="cm-type">Array</span>(<span class="cm-string">"total_bedrooms"</span>,<span class="cm-string">"bedrooms_per_room"</span>)) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">imputedHousing</span> <span class="cm-operator">=</span> <span class="cm-variable">imputer</span>.<span class="cm-variable">fit</span>(<span class="cm-variable">renamedHousing</span>).<span class="cm-variable">transform</span>(<span class="cm-variable">renamedHousing</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">imputedHousing</span>.<span class="cm-variable">select</span>(<span class="cm-string">"total_bedrooms"</span>, <span class="cm-string">"bedrooms_per_room"</span>).<span class="cm-variable">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 204px;"></div><div class="CodeMirror-gutters" style="height: 217px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(5) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">imputedHousing:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 11 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+--------------+-------------------+
|total_bedrooms|  bedrooms_per_room|
+--------------+-------------------+
|         129.0|0.14659090909090908|
|        1106.0|0.15579659106916466|
|         190.0|0.12951601908657123|
|         235.0|0.18445839874411302|
|         280.0| 0.1720958819913952|
+--------------+-------------------+
only showing top 5 rows

import org.apache.spark.ml.feature.Imputer
imputer: org.apache.spark.ml.feature.Imputer = imputer_d02d86a86833
imputedHousing: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 11 more fields]
</div></div></div><div class="command-result-stats">Command took <span>4.08 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:18:03 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436317"><i class="fa fa-link" style="text-align: center;"></i>Cmd 35</a><div class="new-notebook command mainCommand command-finished cellIndex-34 cell-475989419436282-475989419436317" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-34 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-34 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-3">### </span><span class="cm-header header-3">Scaling</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>One</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>most</span><span> </span><span>important</span><span> </span><span>transformations</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>apply</span><span> </span><span>to</span><span> </span><span>your</span><span> </span><span>data</span><span> </span><span>is</span><span> </span><span>feature</span><span> </span><span>scaling.</span><span> </span><span>With</span><span> </span><span>few</span><span> </span><span>exceptions,</span><span> </span><span>Machine</span><span> </span><span>Learning</span><span> </span><span>algorithms</span><span> </span><span>don</span><span>'</span><span>t</span><span> </span><span>perform</span><span> </span><span>well</span><span> </span><span>when</span><span> </span><span>the</span><span> </span><span>input</span><span> </span><span>numerical</span><span> </span><span>attributes</span><span> </span><span>have</span><span> </span><span>very</span><span> </span><span>different</span><span> </span><span>scales.</span><span> </span><span>This</span><span> </span><span>is</span><span> </span><span>the</span><span> </span><span>case</span><span> </span><span>for</span><span> </span><span>the</span><span> </span><span>housing</span><span> </span><span>data</span><span>:</span><span> </span><span>the</span><span> </span><span>total</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>rooms</span><span> </span><span>ranges</span><span> </span><span>from</span><span> </span><span>about</span><span> </span><span>6</span><span> </span><span>to</span><span> </span><span>39,320,</span><span> </span><span>while</span><span> </span><span>the</span><span> </span><span>median</span><span> </span><span>incomes</span><span> </span><span>only</span><span> </span><span>range</span><span> </span><span>from</span><span> </span><span>0</span><span> </span><span>to</span><span> </span><span>15.</span><span> </span><span>Note</span><span> </span><span>that</span><span> </span><span>scaling</span><span> </span><span>the</span><span> </span><span>label</span><span> </span><span>attribues</span><span> </span><span>is</span><span> </span><span>generally</span><span> </span><span>not</span><span> </span><span>required.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span>One</span><span> </span><span>way</span><span> </span><span>to</span><span> </span><span>get</span><span> </span><span>all</span><span> </span><span>attributes</span><span> </span><span>to</span><span> </span><span>have</span><span> </span><span>the</span><span> </span><span>same</span><span> </span><span>scale</span><span> </span><span>is</span><span> </span><span>to</span><span> </span><span>use</span><span> </span><span>standardization.</span><span> </span><span>In</span><span> </span><span>standardization,</span><span> </span><span>for</span><span> </span><span>each</span><span> </span><span>value,</span><span> </span><span>first</span><span> </span><span>it</span><span> </span><span>subtracts</span><span> </span><span>the</span><span> </span><span>mean</span><span> </span><span>value</span><span> </span><span>(</span><span>so</span><span> </span><span>standardized</span><span> </span><span>values</span><span> </span><span>always</span><span> </span><span>have</span><span> </span><span>a</span><span> </span><span>zero</span><span> </span><span>mean),</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>it</span><span> </span><span>divides</span><span> </span><span>by</span><span> </span><span>the</span><span> </span><span>variance</span><span> </span><span>so</span><span> </span><span>that</span><span> </span><span>the</span><span> </span><span>resulting</span><span> </span><span>distribution</span><span> </span><span>has</span><span> </span><span>unit</span><span> </span><span>variance.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>this,</span><span> </span><span>we</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">StandardScaler</span><span class="cm-comment">`</span><span> </span><span>Estimator.</span><span> </span><span>To</span><span> </span><span>use</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">StandardScaler</span><span class="cm-comment">`</span><span>,</span><span> </span><span>again</span><span> </span><span>we</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>convert</span><span> </span><span>all</span><span> </span><span>the</span><span> </span><span>numerical</span><span> </span><span>attributes</span><span> </span><span>into</span><span> </span><span>a</span><span> </span><span>big</span><span> </span><span>vectore</span><span> </span><span>of</span><span> </span><span>features</span><span> </span><span>using</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">VectorAssembler</span><span class="cm-comment">`</span><span>,</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>call</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">StandardScaler</span><span class="cm-comment">`</span><span> </span><span>on</span><span> </span><span>that</span><span> </span><span>vactor.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="8e85b240-166c-4d5d-895e-6f1ac4fa67cb" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>Scaling</h3>
<p>One of the most important transformations you need to apply to your data is feature scaling. With few exceptions, Machine Learning algorithms don't perform well when the input numerical attributes have very different scales. This is the case for the housing data: the total number of rooms ranges from about 6 to 39,320, while the median incomes only range from 0 to 15. Note that scaling the label attribues is generally not required.</p>
<p>One way to get all attributes to have the same scale is to use standardization. In standardization, for each value, first it subtracts the mean value (so standardized values always have a zero mean), and then it divides by the variance so that the resulting distribution has unit variance. To do this, we can use the <code>StandardScaler</code> Estimator. To use <code>StandardScaler</code>, again we need to convert all the numerical attributes into a big vectore of features using <code>VectorAssembler</code>, and then call <code>StandardScaler</code> on that vactor.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436318"><i class="fa fa-link" style="text-align: center;"></i>Cmd 36</a><div class="new-notebook command mainCommand command-finished cellIndex-35 cell-475989419436282-475989419436318" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-35 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 161.333px; left: 820.073px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 241px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>12</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 790.073px; top: 149.333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">feature</span>.{<span class="cm-variable">VectorAssembler</span>, <span class="cm-variable">StandardScaler</span>}</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">va</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">VectorAssembler</span>().<span class="cm-variable">setInputCols</span>(<span class="cm-variable">colNum</span>).<span class="cm-variable">setOutputCol</span>(<span class="cm-string">"features"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">featuredHousing</span> <span class="cm-operator">=</span> <span class="cm-variable">va</span>.<span class="cm-variable">transform</span>(<span class="cm-variable">imputedHousing</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">9</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">scaler</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">StandardScaler</span>().<span class="cm-variable">setInputCol</span>(<span class="cm-string">"features"</span>).<span class="cm-variable">setOutputCol</span>(<span class="cm-string">"fetaures"</span>).<span class="cm-variable">setWithMean</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-atom">true</span><span class=" CodeMirror-matchingbracket">)</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">10</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">scaledHousing</span> <span class="cm-operator">=</span> <span class="cm-variable">scaler</span>.<span class="cm-variable">fit</span>(<span class="cm-variable">featuredHousing</span>).<span class="cm-variable">transform</span>(<span class="cm-variable">featuredHousing</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">11</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">12</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">scaledHousing</span>.<span class="cm-variable">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 241px;"></div><div class="CodeMirror-gutters" style="height: 254px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">featuredHousing:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 12 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">scaledHousing:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 13 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-1ehnzue" tabindex="0"><div class="results"><div class="ansiout">+---------+--------+------------------+-----------+--------------+----------+----------+-------------+--------+---------------+-------------------+-------------------+------------------------+--------------------+--------------------+
|longitude|latitude|housing_median_age|total_rooms|total_bedrooms|population|households|median_income|   label|ocean_proximity|rooms_per_household|  bedrooms_per_room|population_per_household|            features|            fetaures|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+--------+---------------+-------------------+-------------------+------------------------+--------------------+--------------------+
|  -122.23|   37.88|              41.0|      880.0|         129.0|     322.0|     126.0|       8.3252|452600.0|       NEAR BAY|  6.984126984126984|0.14659090909090908|      2.5555555555555554|[-122.23,37.88,41...|[-1.3278030546902...|
|  -122.22|   37.86|              21.0|     7099.0|        1106.0|    2401.0|    1138.0|       8.3014|358500.0|       NEAR BAY|  6.238137082601054|0.15579659106916466|       2.109841827768014|[-122.22,37.86,21...|[-1.3228118684350...|
|  -122.24|   37.85|              52.0|     1467.0|         190.0|     496.0|     177.0|       7.2574|352100.0|       NEAR BAY|  8.288135593220339|0.12951601908657123|      2.8022598870056497|[-122.24,37.85,52...|[-1.3327942409452...|
|  -122.25|   37.85|              52.0|     1274.0|         235.0|     558.0|     219.0|       5.6431|341300.0|       NEAR BAY| 5.8173515981735155|0.18445839874411302|       2.547945205479452|[-122.25,37.85,52...|[-1.3377854272003...|
|  -122.25|   37.85|              52.0|     1627.0|         280.0|     565.0|     259.0|       3.8462|342200.0|       NEAR BAY|  6.281853281853282| 0.1720958819913952|      2.1814671814671813|[-122.25,37.85,52...|[-1.3377854272003...|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+--------+---------------+-------------------+-------------------+------------------------+--------------------+--------------------+
only showing top 5 rows

import org.apache.spark.ml.feature.{VectorAssembler, StandardScaler}
va: org.apache.spark.ml.feature.VectorAssembler = VectorAssembler: uid=vecAssembler_055d77b66828, handleInvalid=error, numInputCols=11
featuredHousing: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 12 more fields]
scaler: org.apache.spark.ml.feature.StandardScaler = stdScal_46643d4b01a4
scaledHousing: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 13 more fields]
</div></div></div><div class="command-result-stats">Command took <span>2.11 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:30:34 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436319"><i class="fa fa-link" style="text-align: center;"></i>Cmd 37</a><div class="new-notebook command mainCommand command-finished cellIndex-36 cell-475989419436282-475989419436319" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-36 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-36 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">3.2.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Prepare</span><span class="cm-header header-2"> </span><span class="cm-header header-2">categorical</span><span class="cm-header header-2"> </span><span class="cm-header header-2">attributes</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>After</span><span> </span><span>imputing</span><span> </span><span>and</span><span> </span><span>scaling</span><span> </span><span>the</span><span> </span><span>continuse</span><span> </span><span>attributes,</span><span> </span><span>we</span><span> </span><span>should</span><span> </span><span>take</span><span> </span><span>care</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>categorical</span><span> </span><span>attributes.</span><span> </span><span>Let</span><span>'</span><span>s</span><span> </span><span>first</span><span> </span><span>print</span><span> </span><span>the</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>distict</span><span> </span><span>values</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>categirical</span><span> </span><span>attribute</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">ocean</span><span class="cm-comment">_</span><span class="cm-comment">proximity</span><span class="cm-comment">`</span><span>.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="e2c8cb7a-f5a5-4988-8071-43d482e582f5" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>3.2. Prepare categorical attributes</h2>
<p>After imputing and scaling the continuse attributes, we should take care of the categorical attributes. Let's first print the number of distict values of the categirical attribute <code>ocean_proximity</code>.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436320"><i class="fa fa-link" style="text-align: center;"></i>Cmd 38</a><div class="new-notebook command mainCommand command-finished cellIndex-37 cell-475989419436282-475989419436320" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-37 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 49.3333px; left: 469.031px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 73px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 439.031px; top: 37.3333px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">renamedHousing</span>.<span class="cm-variable">select</span><span class=" CodeMirror-matchingbracket">(</span><span class="cm-variable">countDistinct</span>(<span class="cm-string">"ocean_proximity"</span>)<span class=" CodeMirror-matchingbracket">)</span>.<span class="cm-variable">show</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 73px;"></div><div class="CodeMirror-gutters" style="height: 86px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">+-------------------------------+
|count(DISTINCT ocean_proximity)|
+-------------------------------+
|                              5|
+-------------------------------+

</div></div></div><div class="command-result-stats">Command took <span>1.31 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:32:24 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436321"><i class="fa fa-link" style="text-align: center;"></i>Cmd 39</a><div class="new-notebook command mainCommand command-finished cellIndex-38 cell-475989419436282-475989419436321" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-38 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-38 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-3">### </span><span class="cm-header header-3">String</span><span class="cm-header header-3"> </span><span class="cm-header header-3">indexer</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Most</span><span> </span><span>Machine</span><span> </span><span>Learning</span><span> </span><span>algorithms</span><span> </span><span>prefer</span><span> </span><span>to</span><span> </span><span>work</span><span> </span><span>with</span><span> </span><span>numbers.</span><span> </span><span>So</span><span> </span><span>let</span><span>'</span><span>s</span><span> </span><span>convert</span><span> </span><span>the</span><span> </span><span>categorical</span><span> </span><span>attribute</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">ocean</span><span class="cm-comment">_</span><span class="cm-comment">proximity</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>numbers.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>so,</span><span> </span><span>we</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">StringIndexer</span><span class="cm-comment">`</span><span> </span><span>that</span><span> </span><span>encodes</span><span> </span><span>a</span><span> </span><span>string</span><span> </span><span>column</span><span> </span><span>of</span><span> </span><span>labels</span><span> </span><span>to</span><span> </span><span>a</span><span> </span><span>column</span><span> </span><span>of</span><span> </span><span>label</span><span> </span><span>indices.</span><span> </span><span>The</span><span> </span><span>indices</span><span> </span><span>are</span><span> </span><span>in</span><span> </span><span class="cm-link">[</span><span class="cm-link">0,</span><span class="cm-link"> </span><span class="cm-link">numLabels),</span><span class="cm-link"> </span><span class="cm-link">ordered</span><span class="cm-link"> </span><span class="cm-link">by</span><span class="cm-link"> </span><span class="cm-link">label</span><span class="cm-link"> </span><span class="cm-link">frequencies,</span><span class="cm-link"> </span><span class="cm-link">so</span><span class="cm-link"> </span><span class="cm-link">the</span><span class="cm-link"> </span><span class="cm-link">most</span><span class="cm-link"> </span><span class="cm-link">frequent</span><span class="cm-link"> </span><span class="cm-link">label</span><span class="cm-link"> </span><span class="cm-link">gets</span><span class="cm-link"> </span><span class="cm-link">index</span><span class="cm-link"> </span><span class="cm-link">0.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="864a062c-bf86-46f0-9a02-8ac47f9d381a" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>String indexer</h3>
<p>Most Machine Learning algorithms prefer to work with numbers. So let's convert the categorical attribute <code>ocean_proximity</code> to numbers. To do so, we can use the <code>StringIndexer</code> that encodes a string column of labels to a column of label indices. The indices are in [0, numLabels), ordered by label frequencies, so the most frequent label gets index 0.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436322"><i class="fa fa-link" style="text-align: center;"></i>Cmd 40</a><div class="new-notebook command mainCommand command-finished cellIndex-39 cell-475989419436282-475989419436322" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-39 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 167px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like">x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">feature</span>.<span class="cm-variable">StringIndexer</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">indexer</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">StringIndexer</span>().<span class="cm-variable">setInputCol</span>(<span class="cm-string">"ocean_proximity"</span>).<span class="cm-variable">setOutputCol</span>(<span class="cm-string">"index_ocean_proximity"</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">idxHousing</span> <span class="cm-operator">=</span> <span class="cm-variable">indexer</span>.<span class="cm-variable">fit</span>(<span class="cm-variable">renamedHousing</span>).<span class="cm-variable">transform</span>(<span class="cm-variable">renamedHousing</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">idxHousing</span>.<span class="cm-variable">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 167px;"></div><div class="CodeMirror-gutters" style="height: 180px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(3) Spark Jobs</p></div></div><div class="dataset-info-view"><div class=""><a class="tree-toggler"><i class="fa fa-caret-right fa-fw" style="text-align: center;"></i><i class="fa fa-list-alt fa-fw" style="text-align: center;"></i><span class="spacing-left">idxHousing:</span><span class="spacing-left">org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 12 more fields]</span></a></div><div class="webapp-css-i4itxs"><div class="outer-most-struct"></div></div></div><div class="webapp-css-1ehnzue" tabindex="0"><div class="results"><div class="ansiout">+---------+--------+------------------+-----------+--------------+----------+----------+-------------+--------+---------------+-------------------+-------------------+------------------------+---------------------+
|longitude|latitude|housing_median_age|total_rooms|total_bedrooms|population|households|median_income|   label|ocean_proximity|rooms_per_household|  bedrooms_per_room|population_per_household|index_ocean_proximity|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+--------+---------------+-------------------+-------------------+------------------------+---------------------+
|  -122.23|   37.88|              41.0|      880.0|         129.0|     322.0|     126.0|       8.3252|452600.0|       NEAR BAY|  6.984126984126984|0.14659090909090908|      2.5555555555555554|                  3.0|
|  -122.22|   37.86|              21.0|     7099.0|        1106.0|    2401.0|    1138.0|       8.3014|358500.0|       NEAR BAY|  6.238137082601054|0.15579659106916466|       2.109841827768014|                  3.0|
|  -122.24|   37.85|              52.0|     1467.0|         190.0|     496.0|     177.0|       7.2574|352100.0|       NEAR BAY|  8.288135593220339|0.12951601908657123|      2.8022598870056497|                  3.0|
|  -122.25|   37.85|              52.0|     1274.0|         235.0|     558.0|     219.0|       5.6431|341300.0|       NEAR BAY| 5.8173515981735155|0.18445839874411302|       2.547945205479452|                  3.0|
|  -122.25|   37.85|              52.0|     1627.0|         280.0|     565.0|     259.0|       3.8462|342200.0|       NEAR BAY|  6.281853281853282| 0.1720958819913952|      2.1814671814671813|                  3.0|
+---------+--------+------------------+-----------+--------------+----------+----------+-------------+--------+---------------+-------------------+-------------------+------------------------+---------------------+
only showing top 5 rows

import org.apache.spark.ml.feature.StringIndexer
indexer: org.apache.spark.ml.feature.StringIndexer = strIdx_316a7feea0d6
idxHousing: org.apache.spark.sql.DataFrame = [longitude: double, latitude: double ... 12 more fields]
</div></div></div><div class="command-result-stats">Command took <span>2.44 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:39:17 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436323"><i class="fa fa-link" style="text-align: center;"></i>Cmd 41</a><div class="new-notebook command mainCommand command-finished cellIndex-40 cell-475989419436282-475989419436323" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-40 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-40 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Now</span><span> </span><span>we</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>this</span><span> </span><span>numerical</span><span> </span><span>data</span><span> </span><span>in</span><span> </span><span>any</span><span> </span><span>Machine</span><span> </span><span>Learning</span><span> </span><span>algorithm.</span><span> </span><span>You</span><span> </span><span>can</span><span> </span><span>look</span><span> </span><span>at</span><span> </span><span>the</span><span> </span><span>mapping</span><span> </span><span>that</span><span> </span><span>this</span><span> </span><span>encoder</span><span> </span><span>has</span><span> </span><span>learned</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">labels</span><span class="cm-comment">`</span><span> </span><span>method</span><span>:</span><span> </span><span>"</span><span>&lt;</span><span>1H</span><span> </span><span>OCEAN</span><span>"</span><span> </span><span>is</span><span> </span><span>mapped</span><span> </span><span>to</span><span> </span><span>0,</span><span> </span><span>"</span><span>INLAND</span><span>"</span><span> </span><span>is</span><span> </span><span>mapped</span><span> </span><span>to</span><span> </span><span>1,</span><span> </span><span>etc.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="564fb2ae-79f8-49db-af12-c475d209505b" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Now we can use this numerical data in any Machine Learning algorithm. You can look at the mapping that this encoder has learned using the <code>labels</code> method: "&lt;1H OCEAN" is mapped to 0, "INLAND" is mapped to 1, etc.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436324"><i class="fa fa-link" style="text-align: center;"></i>Cmd 42</a><div class="new-notebook command mainCommand command-finished cellIndex-41 cell-475989419436282-475989419436324" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-41 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 12px; left: 344.229px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 36px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre class="CodeMirror-line-like"><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 314.229px; top: 0px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation"><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">indexer</span>.<span class="cm-variable">fit</span>(<span class="cm-variable">renamedHousing</span>).<span class="cm-variable">labelsArray</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 36px;"></div><div class="CodeMirror-gutters" style="height: 49px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"><div class="command-stage-info " data-test-id="collapsible-command-result-metadata-container"><p data-test-id="command-result-metadata-collapse-toggle" class="clickable-text"><i data-test-id="commmand-result-metadata-collapse-icon" class="fa fa-caret-right fa-fw" style="text-align: center;"></i>(2) Spark Jobs</p></div></div><div class="webapp-css-i4itxs"><div class="results"><div class="ansiout">res59: Array[Array[String]] = Array(Array(&lt;1H OCEAN, INLAND, NEAR OCEAN, NEAR BAY, ISLAND))
</div></div></div><div class="command-result-stats">Command took <span>0.77 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:41:11 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436325"><i class="fa fa-link" style="text-align: center;"></i>Cmd 43</a><div class="new-notebook command mainCommand command-finished cellIndex-42 cell-475989419436282-475989419436325" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-42 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-42 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-3">### </span><span class="cm-header header-3">One-hot</span><span class="cm-header header-3"> </span><span class="cm-header header-3">encoding</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Now,</span><span> </span><span>convert</span><span> </span><span>the</span><span> </span><span>label</span><span> </span><span>indices</span><span> </span><span>built</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>last</span><span> </span><span>step</span><span> </span><span>into</span><span> </span><span>one-hot</span><span> </span><span>vectors.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>this,</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>take</span><span> </span><span>advantage</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">OneHotEncoderEstimator</span><span class="cm-comment">`</span><span> </span><span>Estimator.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="eb956f97-f617-4131-9859-b47a0a740248" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h3>One-hot encoding</h3>
<p>Now, convert the label indices built in the last step into one-hot vectors. To do this, you can take advantage of the <code>OneHotEncoderEstimator</code> Estimator.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436326"><i class="fa fa-link" style="text-align: center;"></i>Cmd 44</a><div class="new-notebook command mainCommand command-active command-focused is-editing command-error cellIndex-43 cell-475989419436282-475989419436326" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-43 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-edit command-text-error"><div class="command-box wrappable"><div><textarea class="command-box-textarea codeeditor" tabindex="1" spellcheck="false" title="CodeMirrorTextArea" data-testid="CommandInput" style="display: none;"></textarea><div class="CodeMirror cm-s-eclipse-focus CodeMirror-wrap CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 142.667px; left: 40px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="1" title="CodeMirrorHiddenTextArea" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 30px; margin-bottom: -17px; border-right-width: 13px; min-height: 185px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><div class="CodeMirror-linenumber CodeMirror-gutter-elt"><div>8</div></div></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 10px; top: 130.667px; height: 18.6667px;">&nbsp;</div></div><div class="CodeMirror-code" role="presentation" style=""><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">1</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// TODO: Replace &lt;FILL IN&gt; with appropriate code</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">2</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">3</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">org</span>.<span class="cm-variable">apache</span>.<span class="cm-variable">spark</span>.<span class="cm-variable">ml</span>.<span class="cm-variable">feature</span>.<span class="cm-variable">OneHotEncoderEstimator</span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">4</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">5</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">encoder</span> <span class="cm-operator">=</span> <span class="cm-keyword">new</span> <span class="cm-variable">OneHotEncoderEstimator</span>().<span class="cm-variable">setInputCols</span>(<span class="cm-type">Array</span>(<span class="cm-string">"index_ocean_proximity"</span>)).<span class="cm-variable">setOutputCols</span>(<span class="cm-type">Array</span>(<span class="cm-string">"ocean_one_hot"</span>))</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">6</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">val</span> <span class="cm-def">ohHousing</span> <span class="cm-operator">=</span> <span class="cm-variable">encoder</span>.<span class="cm-variable">fit</span>(<span class="cm-variable">idxHousing</span>).<span class="cm-variable">transform</span>(<span class="cm-variable">idxHousing</span>)</span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">7</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span cm-text=""></span></span></pre></div><div style="position: relative;"><div class="CodeMirror-gutter-wrapper" style="left: -30px;"><div class="CodeMirror-linenumber CodeMirror-gutter-elt" style="left: 0px; width: 13px;">8</div></div><pre class=" CodeMirror-line " role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">ohHousing</span>.<span class="cm-variable">show</span>(<span class="cm-number">5</span>)</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 13px; width: 1px; border-bottom: 0px solid transparent; top: 185px;"></div><div class="CodeMirror-gutters" style="height: 198px; left: 0px;"><div class="CodeMirror-gutter CodeMirror-linenumbers" style="width: 21px;"></div></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div><div class="rich-command-error"><div><span class="ansiout command-result-error-summary"><div class="error-summary"><div class="ansiout"><a onclick="window.jumpToCommand(475989419436326, 3)">command-475989419436326:3</a>: error: object OneHotEncoderEstimator is not a member of package org.apache.spark.ml.feature
import org.apache.spark.ml.feature.OneHotEncoderEstimator
       ^
<a onclick="window.jumpToCommand(475989419436326, 5)">command-475989419436326:5</a>: error: not found: type OneHotEncoderEstimator
val encoder = new OneHotEncoderEstimator().setInputCols(Array("index_ocean_proximity")).setOutputCols(Array("ocean_one_hot"))
                  ^
</div></div></span></div></div><div class="command-result-stats">Command took <span>0.07 seconds</span> -- by tuccio@kth.se at 12/11/2021, 10:45:55 on lab1_scala</div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436327"><i class="fa fa-link" style="text-align: center;"></i>Cmd 45</a><div class="new-notebook command mainCommand command-finished cellIndex-44 cell-475989419436282-475989419436327" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-44 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-44 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">4.</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Pipeline</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>As</span><span> </span><span>you</span><span> </span><span>can</span><span> </span><span>see,</span><span> </span><span>there</span><span> </span><span>are</span><span> </span><span>many</span><span> </span><span>data</span><span> </span><span>transformation</span><span> </span><span>steps</span><span> </span><span>that</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>be</span><span> </span><span>executed</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>right</span><span> </span><span>order.</span><span> </span><span>For</span><span> </span><span>example,</span><span> </span><span>you</span><span> </span><span>called</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Imputer</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">VectorAssembler</span><span class="cm-comment">`</span><span>,</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">StandardScaler</span><span class="cm-comment">`</span><span> </span><span>from</span><span> </span><span>left</span><span> </span><span>to</span><span> </span><span>right.</span><span> </span><span>However,</span><span> </span><span>we</span><span> </span><span>can</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Pipeline</span><span class="cm-comment">`</span><span> </span><span>class</span><span> </span><span>to</span><span> </span><span>define</span><span> </span><span>a</span><span> </span><span>sequence</span><span> </span><span>of</span><span> </span><span>Transformers/Estimators,</span><span> </span><span>and</span><span> </span><span>run</span><span> </span><span>them</span><span> </span><span>in</span><span> </span><span>order.</span><span> </span><span>A</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Pipeline</span><span class="cm-comment">`</span><span> </span><span>is</span><span> </span><span>an</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Estimator</span><span class="cm-comment">`</span><span>,</span><span> </span><span>thus,</span><span> </span><span>after</span><span> </span><span>a</span><span> </span><span>Pipeline</span><span>'</span><span>s</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">fit</span><span class="cm-comment">(</span><span class="cm-comment">)</span><span class="cm-comment">`</span><span> </span><span>method</span><span> </span><span>runs,</span><span> </span><span>it</span><span> </span><span>produces</span><span> </span><span>a</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">PipelineModel</span><span class="cm-comment">`</span><span>,</span><span> </span><span>which</span><span> </span><span>is</span><span> </span><span>a</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">Transformer</span><span class="cm-comment">`</span><span>.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span>Now,</span><span> </span><span>let</span><span>'</span><span>s</span><span> </span><span>create</span><span> </span><span>a</span><span> </span><span>pipeline</span><span> </span><span>called</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">numPipeline</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>call</span><span> </span><span>the</span><span> </span><span>numerical</span><span> </span><span>transformers</span><span> </span><span>you</span><span> </span><span>built</span><span> </span><span>above</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">imputer</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">va</span><span class="cm-comment">`</span><span>,</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">scaler</span><span class="cm-comment">`</span><span>)</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>right</span><span> </span><span>order</span><span> </span><span>from</span><span> </span><span>left</span><span> </span><span>to</span><span> </span><span>right,</span><span> </span><span>as</span><span> </span><span>well</span><span> </span><span>as</span><span> </span><span>a</span><span> </span><span>pipeline</span><span> </span><span>called</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">catPipeline</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>call</span><span> </span><span>the</span><span> </span><span>categorical</span><span> </span><span>transformers</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">indexer</span><span class="cm-comment">`</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">encoder</span><span class="cm-comment">`</span><span>).</span><span> </span><span>Then,</span><span> </span><span>put</span><span> </span><span>these</span><span> </span><span>two</span><span> </span><span>pipelines</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">numPipeline</span><span class="cm-comment">`</span><span> </span><span>and</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">catPipeline</span><span class="cm-comment">`</span><span> </span><span>into</span><span> </span><span>one</span><span> </span><span>pipeline.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="c08b6181-2638-4464-b501-05f2a95b2097" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><hr>
<h1>4. Pipeline</h1>
<p>As you can see, there are many data transformation steps that need to be executed in the right order. For example, you called the <code>Imputer</code>, <code>VectorAssembler</code>, and <code>StandardScaler</code> from left to right. However, we can use the <code>Pipeline</code> class to define a sequence of Transformers/Estimators, and run them in order. A <code>Pipeline</code> is an <code>Estimator</code>, thus, after a Pipeline's <code>fit()</code> method runs, it produces a <code>PipelineModel</code>, which is a <code>Transformer</code>.</p>
<p>Now, let's create a pipeline called <code>numPipeline</code> to call the numerical transformers you built above (<code>imputer</code>, <code>va</code>, and <code>scaler</code>) in the right order from left to right, as well as a pipeline called <code>catPipeline</code> to call the categorical transformers (<code>indexer</code> and <code>encoder</code>). Then, put these two pipelines <code>numPipeline</code> and <code>catPipeline</code> into one pipeline.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436328"><i class="fa fa-link" style="text-align: center;"></i>Cmd 46</a><div class="new-notebook command mainCommand command-finished cellIndex-45 cell-475989419436282-475989419436328" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-45 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span>{</span><span class="cm-variable">Pipeline</span><span>,</span><span> </span><span class="cm-variable">PipelineModel</span><span>,</span><span> </span><span class="cm-variable">PipelineStage</span><span>}</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">numPipeline</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">catPipeline</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">pipeline</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">Pipeline</span><span>(</span><span>)</span><span>.</span><span class="cm-property">setStages</span><span>(</span><span class="cm-variable">Array</span><span>(</span><span class="cm-variable">numPipeline</span><span>,</span><span> </span><span class="cm-variable">catPipeline</span><span>)</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">newHousing</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">pipeline</span><span>.</span><span class="cm-property">fit</span><span>(</span><span class="cm-variable">renamedHousing</span><span>)</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">renamedHousing</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">newHousing</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436329"><i class="fa fa-link" style="text-align: center;"></i>Cmd 47</a><div class="new-notebook command mainCommand command-finished cellIndex-46 cell-475989419436282-475989419436329" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-46 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-46 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Now,</span><span> </span><span>use</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">VectorAssembler</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>put</span><span> </span><span>all</span><span> </span><span>attributes</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>final</span><span> </span><span>dataset</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">newHousing</span><span class="cm-comment">`</span><span> </span><span>into</span><span> </span><span>a</span><span> </span><span>big</span><span> </span><span>vector,</span><span> </span><span>and</span><span> </span><span>call</span><span> </span><span>the</span><span> </span><span>new</span><span> </span><span>column</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">features</span><span class="cm-comment">`</span><span>.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="424a8ced-1258-404b-be47-dbb18488dd88" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Now, use <code>VectorAssembler</code> to put all attributes of the final dataset <code>newHousing</code> into a big vector, and call the new column <code>features</code>.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436330"><i class="fa fa-link" style="text-align: center;"></i>Cmd 48</a><div class="new-notebook command mainCommand command-finished cellIndex-47 cell-475989419436282-475989419436330" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-47 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">va2</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">VectorAssembler</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">dataset</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">va2</span><span>.</span><span class="cm-property">transform</span><span>(</span><span class="cm-variable">newHousing</span><span>)</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"features"</span><span>,</span><span> </span><span class="cm-string">"label"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">dataset</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436331"><i class="fa fa-link" style="text-align: center;"></i>Cmd 49</a><div class="new-notebook command mainCommand command-finished cellIndex-48 cell-475989419436282-475989419436331" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-48 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-48 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">5.</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Make</span><span class="cm-header header-1"> </span><span class="cm-header header-1">a</span><span class="cm-header header-1"> </span><span class="cm-header header-1">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>Here</span><span> </span><span>we</span><span> </span><span>going</span><span> </span><span>to</span><span> </span><span>make</span><span> </span><span>four</span><span> </span><span>different</span><span> </span><span>regression</span><span> </span><span>models</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Linear</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">regression</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Decission</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">tree</span><span class="cm-variable-2"> </span><span class="cm-variable-2">regression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Random</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">forest</span><span class="cm-variable-2"> </span><span class="cm-variable-2">regression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Gradient-booster</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">forest</span><span class="cm-variable-2"> </span><span class="cm-variable-2">regression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span>But,</span><span> </span><span>before</span><span> </span><span>giving</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>to</span><span> </span><span>train</span><span> </span><span>a</span><span> </span><span>Machine</span><span> </span><span>Learning</span><span> </span><span>model,</span><span> </span><span>let</span><span>'</span><span>s</span><span> </span><span>first</span><span> </span><span>split</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>into</span><span> </span><span>training</span><span> </span><span>dataset</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">trainSet</span><span class="cm-comment">`</span><span>)</span><span> </span><span>with</span><span> </span><span>80%</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>whole</span><span> </span><span>data,</span><span> </span><span>and</span><span> </span><span>test</span><span> </span><span>dataset</span><span> </span><span>(</span><span class="cm-comment">`</span><span class="cm-comment">testSet</span><span class="cm-comment">`</span><span>)</span><span> </span><span>with</span><span> </span><span>20%</span><span> </span><span>of</span><span> </span><span>it.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="867525d0-c504-4e71-b035-25bce5f6d75b" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><hr>
<h1>5. Make a model</h1>
<p>Here we going to make four different regression models:</p>
<ul>
<li>Linear regression model</li>
<li>Decission tree regression</li>
<li>Random forest regression</li>
<li>Gradient-booster forest regression</li>
</ul>
<p>But, before giving the data to train a Machine Learning model, let's first split the data into training dataset (<code>trainSet</code>) with 80% of the whole data, and test dataset (<code>testSet</code>) with 20% of it.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436332"><i class="fa fa-link" style="text-align: center;"></i>Cmd 50</a><div class="new-notebook command mainCommand command-finished cellIndex-49 cell-475989419436282-475989419436332" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-49 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">Array</span><span>(</span><span class="cm-variable">trainSet</span><span>,</span><span> </span><span class="cm-variable">testSet</span><span>)</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">dataset</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436333"><i class="fa fa-link" style="text-align: center;"></i>Cmd 51</a><div class="new-notebook command mainCommand command-finished cellIndex-50 cell-475989419436282-475989419436333" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-50 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-50 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">5.1.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Linear</span><span class="cm-header header-2"> </span><span class="cm-header header-2">regression</span><span class="cm-header header-2"> </span><span class="cm-header header-2">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Now,</span><span> </span><span>train</span><span> </span><span>a</span><span> </span><span>Linear</span><span> </span><span>Regression</span><span> </span><span>model</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">LinearRegression</span><span class="cm-comment">`</span><span> </span><span>class.</span><span> </span><span>Then,</span><span> </span><span>print</span><span> </span><span>the</span><span> </span><span>coefficients</span><span> </span><span>and</span><span> </span><span>intercept</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>model,</span><span> </span><span>as</span><span> </span><span>well</span><span> </span><span>as</span><span> </span><span>the</span><span> </span><span>summary</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>over</span><span> </span><span>the</span><span> </span><span>training</span><span> </span><span>set</span><span> </span><span>by</span><span> </span><span>calling</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">summary</span><span class="cm-comment">`</span><span> </span><span>method.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="4e2fc988-3f1a-45d4-8ebe-993b0cb8cab1" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>5.1. Linear regression model</h2>
<p>Now, train a Linear Regression model using the <code>LinearRegression</code> class. Then, print the coefficients and intercept of the model, as well as the summary of the model over the training set by calling the <code>summary</code> method.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436334"><i class="fa fa-link" style="text-align: center;"></i>Cmd 52</a><div class="new-notebook command mainCommand command-finished cellIndex-51 cell-475989419436282-475989419436334" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-51 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">regression</span><span>.</span><span class="cm-property">LinearRegression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">train</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">lr</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">lrModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lr</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">trainingSummary</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lrModel</span><span>.</span><span class="cm-property">summary</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"Coefficients: &lt;FILL IN&gt;, Intercept: &lt;FILL IN&gt;"</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"RMSE: &lt;FILL IN&gt;"</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436335"><i class="fa fa-link" style="text-align: center;"></i>Cmd 53</a><div class="new-notebook command mainCommand command-finished cellIndex-52 cell-475989419436282-475989419436335" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-52 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-52 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span>Now,</span><span> </span><span>use</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">RegressionEvaluator</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>measure</span><span> </span><span>the</span><span> </span><span>root-mean-square-erroe</span><span> </span><span>(</span><span>RMSE)</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>model</span><span> </span><span>on</span><span> </span><span>the</span><span> </span><span>test</span><span> </span><span>dataset.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="f4684f37-6a3e-4910-b7a8-102db7632893" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><p>Now, use <code>RegressionEvaluator</code> to measure the root-mean-square-erroe (RMSE) of the model on the test dataset.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436336"><i class="fa fa-link" style="text-align: center;"></i>Cmd 54</a><div class="new-notebook command mainCommand command-finished cellIndex-53 cell-475989419436282-475989419436336" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-53 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">evaluation</span><span>.</span><span class="cm-property">RegressionEvaluator</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">make</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-variable">on</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">lrModel</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable">predictions</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"prediction"</span><span>,</span><span> </span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"features"</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">select</span><span> </span><span>(</span><span class="cm-variable">prediction</span><span>,</span><span> </span><span class="cm-variable">true</span><span> </span><span class="cm-variable">label</span><span>)</span><span> </span><span class="cm-keyword">and</span><span> </span><span class="cm-variable">compute</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">error</span><span>.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-property">val</span><span> </span><span class="cm-variable">evaluator</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">RegressionEvaluator</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rmse</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">evaluator</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"Root Mean Squared Error (RMSE) on test data = $rmse"</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436337"><i class="fa fa-link" style="text-align: center;"></i>Cmd 55</a><div class="new-notebook command mainCommand command-finished cellIndex-54 cell-475989419436282-475989419436337" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-54 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-54 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">5.2.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Decision</span><span class="cm-header header-2"> </span><span class="cm-header header-2">tree</span><span class="cm-header header-2"> </span><span class="cm-header header-2">regression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Repeat</span><span> </span><span>what</span><span> </span><span>you</span><span> </span><span>have</span><span> </span><span>done</span><span> </span><span>on</span><span> </span><span>Regression</span><span> </span><span>Model</span><span> </span><span>to</span><span> </span><span>build</span><span> </span><span>a</span><span> </span><span>Decision</span><span> </span><span>Tree</span><span> </span><span>model.</span><span> </span><span>Use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">DecisionTreeRegressor</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>make</span><span> </span><span>a</span><span> </span><span>model</span><span> </span><span>and</span><span> </span><span>then</span><span> </span><span>measure</span><span> </span><span>its</span><span> </span><span>RMSE</span><span> </span><span>on</span><span> </span><span>the</span><span> </span><span>test</span><span> </span><span>dataset.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="f3c2c918-71d6-4ee7-b3c0-96d18a3b4c1a" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>5.2. Decision tree regression</h2>
<p>Repeat what you have done on Regression Model to build a Decision Tree model. Use the <code>DecisionTreeRegressor</code> to make a model and then measure its RMSE on the test dataset.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436338"><i class="fa fa-link" style="text-align: center;"></i>Cmd 56</a><div class="new-notebook command mainCommand command-finished cellIndex-55 cell-475989419436282-475989419436338" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-55 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">regression</span><span>.</span><span class="cm-property">DecisionTreeRegressor</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">evaluation</span><span>.</span><span class="cm-property">RegressionEvaluator</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">dt</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">DecisionTreeRegressor</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">train</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">dtModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">dt</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">make</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-variable">on</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">dtModel</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-variable">predictions</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"prediction"</span><span>,</span><span> </span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"features"</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">select</span><span> </span><span>(</span><span class="cm-variable">prediction</span><span>,</span><span> </span><span class="cm-variable">true</span><span> </span><span class="cm-variable">label</span><span>)</span><span> </span><span class="cm-keyword">and</span><span> </span><span class="cm-variable">compute</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">error</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">evaluator</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">RegressionEvaluator</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rmse</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">evaluator</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"Root Mean Squared Error (RMSE) on test data = $rmse"</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436339"><i class="fa fa-link" style="text-align: center;"></i>Cmd 57</a><div class="new-notebook command mainCommand command-finished cellIndex-56 cell-475989419436282-475989419436339" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-56 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-56 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">5.3.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Random</span><span class="cm-header header-2"> </span><span class="cm-header header-2">forest</span><span class="cm-header header-2"> </span><span class="cm-header header-2">regression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Let</span><span>'</span><span>s</span><span> </span><span>try</span><span> </span><span>the</span><span> </span><span>test</span><span> </span><span>error</span><span> </span><span>on</span><span> </span><span>a</span><span> </span><span>Random</span><span> </span><span>Forest</span><span> </span><span>Model.</span><span> </span><span>Youcan</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">RandomForestRegressor</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>make</span><span> </span><span>a</span><span> </span><span>Random</span><span> </span><span>Forest</span><span> </span><span>model.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="68778556-27f4-4296-bbc4-c4ae61f47585" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>5.3. Random forest regression</h2>
<p>Let's try the test error on a Random Forest Model. Youcan use the <code>RandomForestRegressor</code> to make a Random Forest model.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436340"><i class="fa fa-link" style="text-align: center;"></i>Cmd 58</a><div class="new-notebook command mainCommand command-finished cellIndex-57 cell-475989419436282-475989419436340" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-57 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">regression</span><span>.</span><span class="cm-property">RandomForestRegressor</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">evaluation</span><span>.</span><span class="cm-property">RegressionEvaluator</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rf</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">RandomForestRegressor</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">train</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rfModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">rf</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">make</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-variable">on</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">rfModel</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-variable">predictions</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"prediction"</span><span>,</span><span> </span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"features"</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">select</span><span> </span><span>(</span><span class="cm-variable">prediction</span><span>,</span><span> </span><span class="cm-variable">true</span><span> </span><span class="cm-variable">label</span><span>)</span><span> </span><span class="cm-keyword">and</span><span> </span><span class="cm-variable">compute</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">error</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">evaluator</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">RegressionEvaluator</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rmse</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">evaluator</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"Root Mean Squared Error (RMSE) on test data = $rmse"</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"><i class="fa fa-minus-square-o" style="text-align: center; cursor: pointer;"></i></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436341"><i class="fa fa-link" style="text-align: center;"></i>Cmd 59</a><div class="new-notebook command mainCommand command-finished cellIndex-58 cell-475989419436282-475989419436341" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-58 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-58 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-header header-2">## </span><span class="cm-header header-2">5.4.</span><span class="cm-header header-2"> </span><span class="cm-header header-2">Gradient-boosted</span><span class="cm-header header-2"> </span><span class="cm-header header-2">tree</span><span class="cm-header header-2"> </span><span class="cm-header header-2">regression</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span>Fianlly,</span><span> </span><span>we</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>build</span><span> </span><span>a</span><span> </span><span>Gradient-boosted</span><span> </span><span>Tree</span><span> </span><span>Regression</span><span> </span><span>model</span><span> </span><span>and</span><span> </span><span>test</span><span> </span><span>the</span><span> </span><span>RMSE</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>test</span><span> </span><span>data.</span><span> </span><span>Use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">GBTRegressor</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>build</span><span> </span><span>the</span><span> </span><span>model.</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="20aa0ecf-f422-4966-ad2b-495a98332e71" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><h2>5.4. Gradient-boosted tree regression</h2>
<p>Fianlly, we want to build a Gradient-boosted Tree Regression model and test the RMSE of the test data. Use the <code>GBTRegressor</code> to build the model.</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436342"><i class="fa fa-link" style="text-align: center;"></i>Cmd 60</a><div class="new-notebook command mainCommand command-finished cellIndex-59 cell-475989419436282-475989419436342" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-59 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">regression</span><span>.</span><span class="cm-property">GBTRegressor</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">evaluation</span><span>.</span><span class="cm-property">RegressionEvaluator</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">gb</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">GBTRegressor</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">train</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">model</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">gbModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">gb</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">make</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-variable">on</span><span> </span><span class="cm-variable">the</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">data</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">gbModel</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-variable">predictions</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"prediction"</span><span>,</span><span> </span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"features"</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">select</span><span> </span><span>(</span><span class="cm-variable">prediction</span><span>,</span><span> </span><span class="cm-variable">true</span><span> </span><span class="cm-variable">label</span><span>)</span><span> </span><span class="cm-keyword">and</span><span> </span><span class="cm-variable">compute</span><span> </span><span class="cm-variable">test</span><span> </span><span class="cm-variable">error</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">evaluator</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">RegressionEvaluator</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rmse</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">evaluator</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">19</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"Root Mean Squared Error (RMSE) on test data = $rmse"</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436343"><i class="fa fa-link" style="text-align: center;"></i>Cmd 61</a><div class="new-notebook command mainCommand command-finished cellIndex-60 cell-475989419436282-475989419436343" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-60 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-60 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">6.</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Hyperparameter</span><span class="cm-header header-1"> </span><span class="cm-header header-1">tuning</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>An</span><span> </span><span>important</span><span> </span><span>task</span><span> </span><span>in</span><span> </span><span>Machie</span><span> </span><span>Learning</span><span> </span><span>is</span><span> </span><span>model</span><span> </span><span>selection,</span><span> </span><span>or</span><span> </span><span>using</span><span> </span><span>data</span><span> </span><span>to</span><span> </span><span>find</span><span> </span><span>the</span><span> </span><span>best</span><span> </span><span>model</span><span> </span><span>or</span><span> </span><span>parameters</span><span> </span><span>for</span><span> </span><span>a</span><span> </span><span>given</span><span> </span><span>task.</span><span> </span><span>This</span><span> </span><span>is</span><span> </span><span>also</span><span> </span><span>called</span><span> </span><span>tuning.</span><span> </span><span>Tuning</span><span> </span><span>may</span><span> </span><span>be</span><span> </span><span>done</span><span> </span><span>for</span><span> </span><span>individual</span><span> </span><span>Estimators</span><span> </span><span>such</span><span> </span><span>as</span><span> </span><span>LinearRegression,</span><span> </span><span>or</span><span> </span><span>for</span><span> </span><span>entire</span><span> </span><span>Pipelines</span><span> </span><span>which</span><span> </span><span>include</span><span> </span><span>multiple</span><span> </span><span>algorithms,</span><span> </span><span>featurization,</span><span> </span><span>and</span><span> </span><span>other</span><span> </span><span>steps.</span><span> </span><span>Users</span><span> </span><span>can</span><span> </span><span>tune</span><span> </span><span>an</span><span> </span><span>entire</span><span> </span><span>Pipeline</span><span> </span><span>at</span><span> </span><span>once,</span><span> </span><span>rather</span><span> </span><span>than</span><span> </span><span>tuning</span><span> </span><span>each</span><span> </span><span>element</span><span> </span><span>in</span><span> </span><span>the</span><span> </span><span>Pipeline</span><span> </span><span>separately.</span><span> </span><span>MLlib</span><span> </span><span>supports</span><span> </span><span>model</span><span> </span><span>selection</span><span> </span><span>tools,</span><span> </span><span>such</span><span> </span><span>as</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">CrossValidator</span><span class="cm-comment">`</span><span>.</span><span> </span><span>These</span><span> </span><span>tools</span><span> </span><span>require</span><span> </span><span>the</span><span> </span><span>following</span><span> </span><span>items</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Estimator</span><span class="cm-variable-2"></span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">algorithm</span><span class="cm-variable-2"> </span><span class="cm-variable-2">or</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Pipeline</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">tune</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">setEstimator</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Set</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">ParamMaps</span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">parameters</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">choose</span><span class="cm-variable-2"> </span><span class="cm-variable-2">from,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">sometimes</span><span class="cm-variable-2"> </span><span class="cm-variable-2">called</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">"</span><span class="cm-variable-2">parameter</span><span class="cm-variable-2"> </span><span class="cm-variable-2">grid</span><span class="cm-variable-2">"</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">search</span><span class="cm-variable-2"> </span><span class="cm-variable-2">over</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">setEstimatorParamMaps</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable-2">* </span><span class="cm-variable-2">Evaluator</span><span class="cm-variable-2"></span><span class="cm-variable-2">:</span><span class="cm-variable-2"> </span><span class="cm-variable-2">metric</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">measure</span><span class="cm-variable-2"> </span><span class="cm-variable-2">how</span><span class="cm-variable-2"> </span><span class="cm-variable-2">well</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">fitted</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Model</span><span class="cm-variable-2"> </span><span class="cm-variable-2">does</span><span class="cm-variable-2"> </span><span class="cm-variable-2">on</span><span class="cm-variable-2"> </span><span class="cm-variable-2">held-out</span><span class="cm-variable-2"> </span><span class="cm-variable-2">test</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">setEvaluator</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span class="cm-comment">`</span><span class="cm-comment">CrossValidator</span><span class="cm-comment">`</span><span> </span><span>begins</span><span> </span><span>by</span><span> </span><span>splitting</span><span> </span><span>the</span><span> </span><span>dataset</span><span> </span><span>into</span><span> </span><span>a</span><span> </span><span>set</span><span> </span><span>of</span><span> </span><span>folds,</span><span> </span><span>which</span><span> </span><span>are</span><span> </span><span>used</span><span> </span><span>as</span><span> </span><span>separate</span><span> </span><span>training</span><span> </span><span>and</span><span> </span><span>test</span><span> </span><span>datasets.</span><span> </span><span>For</span><span> </span><span>example</span><span> </span><span>with</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">k=3</span><span class="cm-comment">`</span><span> </span><span>folds,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">CrossValidator</span><span class="cm-comment">`</span><span> </span><span>will</span><span> </span><span>generate</span><span> </span><span>3</span><span> </span><span>(</span><span>training,</span><span> </span><span>test)</span><span> </span><span>dataset</span><span> </span><span>pairs,</span><span> </span><span>each</span><span> </span><span>of</span><span> </span><span>which</span><span> </span><span>uses</span><span> </span><span>2/3</span><span> </span><span>of</span><span> </span><span>the</span><span> </span><span>data</span><span> </span><span>for</span><span> </span><span>training</span><span> </span><span>and</span><span> </span><span>1/3</span><span> </span><span>for</span><span> </span><span>testing.</span><span> </span><span>To</span><span> </span><span>evaluate</span><span> </span><span>a</span><span> </span><span>particular</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">ParamMap</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">CrossValidator</span><span class="cm-comment">`</span><span> </span><span>computes</span><span> </span><span>the</span><span> </span><span>average</span><span> </span><span>evaluation</span><span> </span><span>metric</span><span> </span><span>for</span><span> </span><span>the</span><span> </span><span>3</span><span> </span><span>Models</span><span> </span><span>produced</span><span> </span><span>by</span><span> </span><span>fitting</span><span> </span><span>the</span><span> </span><span>Estimator</span><span> </span><span>on</span><span> </span><span>the</span><span> </span><span>3</span><span> </span><span>different</span><span> </span><span>(</span><span>training,</span><span> </span><span>test)</span><span> </span><span>dataset</span><span> </span><span>pairs.</span><span> </span><span>After</span><span> </span><span>identifying</span><span> </span><span>the</span><span> </span><span>best</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">ParamMap</span><span class="cm-comment">`</span><span>,</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">CrossValidator</span><span class="cm-comment">`</span><span> </span><span>finally</span><span> </span><span>re-fits</span><span> </span><span>the</span><span> </span><span>Estimator</span><span> </span><span>using</span><span> </span><span>the</span><span> </span><span>best</span><span> </span><span>ParamMap</span><span> </span><span>and</span><span> </span><span>the</span><span> </span><span>entire</span><span> </span><span>dataset.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span>Below,</span><span> </span><span>use</span><span> </span><span>the</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">CrossValidator</span><span class="cm-comment">`</span><span> </span><span>to</span><span> </span><span>select</span><span> </span><span>the</span><span> </span><span>best</span><span> </span><span>Random</span><span> </span><span>Forest</span><span> </span><span>model.</span><span> </span><span>To</span><span> </span><span>do</span><span> </span><span>so,</span><span> </span><span>you</span><span> </span><span>need</span><span> </span><span>to</span><span> </span><span>define</span><span> </span><span>a</span><span> </span><span>grid</span><span> </span><span>of</span><span> </span><span>parameters.</span><span> </span><span>Let</span><span>'</span><span>s</span><span> </span><span>say</span><span> </span><span>we</span><span> </span><span>want</span><span> </span><span>to</span><span> </span><span>do</span><span> </span><span>the</span><span> </span><span>search</span><span> </span><span>among</span><span> </span><span>the</span><span> </span><span>different</span><span> </span><span>number</span><span> </span><span>of</span><span> </span><span>trees</span><span> </span><span>(</span><span>1,</span><span> </span><span>5,</span><span> </span><span>and</span><span> </span><span>10),</span><span> </span><span>and</span><span> </span><span>different</span><span> </span><span>tree</span><span> </span><span>depth</span><span> </span><span>(</span><span>5,</span><span> </span><span>10,</span><span> </span><span>and</span><span> </span><span>15).</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="23ad732c-4ff7-458c-916e-56b3a27dca4c" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><hr>
<h1>6. Hyperparameter tuning</h1>
<p>An important task in Machie Learning is model selection, or using data to find the best model or parameters for a given task. This is also called tuning. Tuning may be done for individual Estimators such as LinearRegression, or for entire Pipelines which include multiple algorithms, featurization, and other steps. Users can tune an entire Pipeline at once, rather than tuning each element in the Pipeline separately. MLlib supports model selection tools, such as <code>CrossValidator</code>. These tools require the following items:</p>
<ul>
<li>Estimator: algorithm or Pipeline to tune (<code>setEstimator</code>)</li>
<li>Set of ParamMaps: parameters to choose from, sometimes called a "parameter grid" to search over (<code>setEstimatorParamMaps</code>)</li>
<li>Evaluator: metric to measure how well a fitted Model does on held-out test data (<code>setEvaluator</code>)</li>
</ul>
<p><code>CrossValidator</code> begins by splitting the dataset into a set of folds, which are used as separate training and test datasets. For example with <code>k=3</code> folds, <code>CrossValidator</code> will generate 3 (training, test) dataset pairs, each of which uses 2/3 of the data for training and 1/3 for testing. To evaluate a particular <code>ParamMap</code>, <code>CrossValidator</code> computes the average evaluation metric for the 3 Models produced by fitting the Estimator on the 3 different (training, test) dataset pairs. After identifying the best <code>ParamMap</code>, <code>CrossValidator</code> finally re-fits the Estimator using the best ParamMap and the entire dataset.</p>
<p>Below, use the <code>CrossValidator</code> to select the best Random Forest model. To do so, you need to define a grid of parameters. Let's say we want to do the search among the different number of trees (1, 5, and 10), and different tree depth (5, 10, and 15).</p>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436344"><i class="fa fa-link" style="text-align: center;"></i>Cmd 62</a><div class="new-notebook command mainCommand command-finished cellIndex-61 cell-475989419436282-475989419436344" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-61 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span class="cm-operator">%</span><span class="cm-variable">python</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-operator">/</span><span class="cm-operator">/</span><span> </span><span class="cm-variable">TODO</span><span>:</span><span> </span><span class="cm-variable">Replace</span><span> </span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span> </span><span class="cm-keyword">with</span><span> </span><span class="cm-variable">appropriate</span><span> </span><span class="cm-variable">code</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">tuning</span><span>.</span><span class="cm-property">ParamGridBuilder</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">evaluation</span><span>.</span><span class="cm-property">RegressionEvaluator</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-keyword">import</span><span> </span><span class="cm-variable">org</span><span>.</span><span class="cm-property">apache</span><span>.</span><span class="cm-property">spark</span><span>.</span><span class="cm-property">ml</span><span>.</span><span class="cm-property">tuning</span><span>.</span><span class="cm-property">CrossValidator</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">paramGrid</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">ParamGridBuilder</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">evaluator</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">RegressionEvaluator</span><span>(</span><span>)</span><span>.</span><span class="cm-property">setLabelCol</span><span>(</span><span class="cm-string">"label"</span><span>)</span><span>.</span><span class="cm-property">setPredictionCol</span><span>(</span><span class="cm-string">"prediction"</span><span>)</span><span>.</span><span class="cm-property">setMetricName</span><span>(</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">cv</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">new</span><span> </span><span class="cm-variable">CrossValidator</span><span>(</span><span>)</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">12</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">cvModel</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">cv</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">13</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">14</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">predictions</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">cvModel</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">15</div></div><span class="cm-variable">predictions</span><span>.</span><span class="cm-property">select</span><span>(</span><span class="cm-string">"prediction"</span><span>,</span><span> </span><span class="cm-string">"label"</span><span>,</span><span> </span><span class="cm-string">"features"</span><span>)</span><span>.</span><span class="cm-property">show</span><span>(</span><span class="cm-number">5</span><span>)</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">16</div></div><span> </span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">17</div></div><span class="cm-variable">val</span><span> </span><span class="cm-variable">rmse</span><span> </span><span class="cm-operator">=</span><span> </span><span class="cm-variable">evaluator</span><span>.</span><span class="cm-operator">&lt;</span><span class="cm-variable">FILL</span><span> </span><span class="cm-variable">IN</span><span class="cm-operator">&gt;</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">18</div></div><span class="cm-variable">println</span><span>(</span><span class="cm-variable">s</span><span class="cm-string">"Root Mean Squared Error (RMSE) on test data = $rmse"</span><span>)</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436345"><i class="fa fa-link" style="text-align: center;"></i>Cmd 63</a><div class="new-notebook command mainCommand command-finished cellIndex-62 cell-475989419436282-475989419436345" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="dashboard-button dashboard-button-62 command-button" title="Show in Dashboard Menu"><i aria-hidden="true" class="fa fa-bar-chart fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-62 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt"><div class="command-text hidden command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span>%md</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">2</div></div><span class="cm-hr">---</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">3</div></div><span class="cm-header header-1"># </span><span class="cm-header header-1">7.</span><span class="cm-header header-1"> </span><span class="cm-header header-1">An</span><span class="cm-header header-1"> </span><span class="cm-header header-1">End-to-End</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Classification</span><span class="cm-header header-1"> </span><span class="cm-header header-1">Test</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">4</div></div><span>As</span><span> </span><span>the</span><span> </span><span>last</span><span> </span><span>step,</span><span> </span><span>you</span><span> </span><span>are</span><span> </span><span>given</span><span> </span><span>a</span><span> </span><span>dataset</span><span> </span><span>called</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">data/ccdefault.csv</span><span class="cm-comment">`</span><span>.</span><span> </span><span>The</span><span> </span><span>dataset</span><span> </span><span>represents</span><span> </span><span>default</span><span> </span><span>of</span><span> </span><span>credit</span><span> </span><span>card</span><span> </span><span>clients.&nbsp;It</span><span> </span><span>has</span><span> </span><span>30,000</span><span> </span><span>cases</span><span> </span><span>and</span><span> </span><span>24</span><span> </span><span>different</span><span> </span><span>attributes.</span><span> </span><span>More</span><span> </span><span>details</span><span> </span><span>about</span><span> </span><span>the</span><span> </span><span>dataset</span><span> </span><span>is</span><span> </span><span>available</span><span> </span><span>at</span><span> </span><span class="cm-comment">`</span><span class="cm-comment">data/ccdefault.txt</span><span class="cm-comment">`</span><span>.</span><span> </span><span>In</span><span> </span><span>this</span><span> </span><span>task</span><span> </span><span>you</span><span> </span><span>should</span><span> </span><span>make</span><span> </span><span>three</span><span> </span><span>models,</span><span> </span><span>compare</span><span> </span><span>their</span><span> </span><span>results</span><span> </span><span>and</span><span> </span><span>conclude</span><span> </span><span>the</span><span> </span><span>ideal</span><span> </span><span>solution.</span><span> </span><span>Here</span><span> </span><span>are</span><span> </span><span>the</span><span> </span><span>suggested</span><span> </span><span>steps</span><span>:</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">5</div></div><span class="cm-variable-2">1. </span><span class="cm-variable-2">Load</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data.</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">6</div></div><span class="cm-variable-2">2. </span><span class="cm-variable-2">Carry</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">out</span><span class="cm-variable-2"> </span><span class="cm-variable-2">some</span><span class="cm-variable-2"> </span><span class="cm-variable-2">exploratory</span><span class="cm-variable-2"> </span><span class="cm-variable-2">analyses</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">e.g.,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">how</span><span class="cm-variable-2"> </span><span class="cm-variable-2">various</span><span class="cm-variable-2"> </span><span class="cm-variable-2">features</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">target</span><span class="cm-variable-2"> </span><span class="cm-variable-2">variable</span><span class="cm-variable-2"> </span><span class="cm-variable-2">are</span><span class="cm-variable-2"> </span><span class="cm-variable-2">distributed).</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">7</div></div><span class="cm-variable-2">3. </span><span class="cm-variable-2">Train</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">predict</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the&nbsp;target</span><span class="cm-variable-2"> </span><span class="cm-variable-2">variable</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">risk</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-comment variable-2">`</span><span class="cm-comment variable-2">default</span><span class="cm-comment variable-2">`</span><span class="cm-variable-2">).</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">8</div></div><span>  </span><span class="cm-variable-2">- </span><span class="cm-variable-2">Employ</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">three</span><span class="cm-variable-2"> </span><span class="cm-variable-2">different</span><span class="cm-variable-2"> </span><span class="cm-variable-2">models</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">logistic</span><span class="cm-variable-2"> </span><span class="cm-variable-2">regression,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">decision</span><span class="cm-variable-2"> </span><span class="cm-variable-2">tree,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">random</span><span class="cm-variable-2"> </span><span class="cm-variable-2">forest).</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">9</div></div><span>  </span><span class="cm-variable-2">- </span><span class="cm-variable-2">Compare</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">models</span><span class="cm-variable-2">'</span><span class="cm-variable-2"> </span><span class="cm-variable-2">performances</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">e.g.,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">AUC).</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">10</div></div><span>  </span><span class="cm-variable-2">- </span><span class="cm-variable-2">Defend</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">your</span><span class="cm-variable-2"> </span><span class="cm-variable-2">choice</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">best</span><span class="cm-variable-2"> </span><span class="cm-variable-2">model</span><span class="cm-variable-2"> </span><span class="cm-variable-2">(</span><span class="cm-variable-2">e.g.,</span><span class="cm-variable-2"> </span><span class="cm-variable-2">what</span><span class="cm-variable-2"> </span><span class="cm-variable-2">are</span><span class="cm-variable-2"> </span><span class="cm-variable-2">the</span><span class="cm-variable-2"> </span><span class="cm-variable-2">strength</span><span class="cm-variable-2"> </span><span class="cm-variable-2">and</span><span class="cm-variable-2"> </span><span class="cm-variable-2">weaknesses</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">each</span><span class="cm-variable-2"> </span><span class="cm-variable-2">of</span><span class="cm-variable-2"> </span><span class="cm-variable-2">these</span><span class="cm-variable-2"> </span><span class="cm-variable-2">models?).</span></pre><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">11</div></div><span class="cm-variable-2">4. </span><span class="cm-variable-2">What</span><span class="cm-variable-2"></span><span class="cm-variable-2"> </span><span class="cm-variable-2">more</span><span class="cm-variable-2"> </span><span class="cm-variable-2">would</span><span class="cm-variable-2"> </span><span class="cm-variable-2">you</span><span class="cm-variable-2"> </span><span class="cm-variable-2">do</span><span class="cm-variable-2"> </span><span class="cm-variable-2">with</span><span class="cm-variable-2"> </span><span class="cm-variable-2">this</span><span class="cm-variable-2"> </span><span class="cm-variable-2">data?</span><span class="cm-variable-2"> </span><span class="cm-variable-2">Anything</span><span class="cm-variable-2"> </span><span class="cm-variable-2">to</span><span class="cm-variable-2"> </span><span class="cm-variable-2">help</span><span class="cm-variable-2"> </span><span class="cm-variable-2">you</span><span class="cm-variable-2"> </span><span class="cm-variable-2">devise</span><span class="cm-variable-2"> </span><span class="cm-variable-2">a</span><span class="cm-variable-2"> </span><span class="cm-variable-2">better</span><span class="cm-variable-2"> </span><span class="cm-variable-2">solution?</span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div><div class="results dashboard"><div class="dashboard"><div style="width: auto; position: relative; margin-top: 0px;"><div><div class="widget" data-guid="381c7de9-c1b3-43a1-a54e-7383132c1779" style="left: 0px; top: 0px; width: auto; height: auto; box-sizing: content-box; --plotWarningHeight:0px;"><div class="widget-content dashboard"><div class="results"><div class="markdown"><hr>
<h1>7. An End-to-End Classification Test</h1>
<p>As the last step, you are given a dataset called <code>data/ccdefault.csv</code>. The dataset represents default of credit card clients. It has 30,000 cases and 24 different attributes. More details about the dataset is available at <code>data/ccdefault.txt</code>. In this task you should make three models, compare their results and conclude the ideal solution. Here are the suggested steps:</p>
<ol>
<li>Load the data.</li>
<li>Carry out some exploratory analyses (e.g., how various features and the target variable are distributed).</li>
<li>Train a model to predict the target variable (risk of <code>default</code>).<ul>
<li>Employ three different models (logistic regression, decision tree, and random forest).</li>
<li>Compare the models' performances (e.g., AUC).</li>
<li>Defend your choice of best model (e.g., what are the strength and weaknesses of each of these models?).</li>
</ul>
</li>
<li>What more would you do with this data? Anything to help you devise a better solution?</li>
</ol>
</div></div><div></div><div></div></div></div></div></div></div></div></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div><div class="heading-command-wrapper heading-command-wrapper-not-focused"><div class="heading-toggler"></div><div class="command-with-number"><a class="command-number" href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282/command/475989419436346"><i class="fa fa-link" style="text-align: center;"></i>Cmd 64</a><div class="new-notebook command mainCommand command-finished cellIndex-63 cell-475989419436282-475989419436346" data-testid="CommandView"><div class="command-comments-wrapper"></div><a class="move-command-btn" draggable="true"><i class="fa fa-sort" style="text-align: center;"></i></a><div class="command-buttons"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="run-command-button command-button" title="Run Cell"><i aria-hidden="true" class="fa fa-play fa-fw" style="text-align: center;"></i><i aria-hidden="true" class="fa fa-caret-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="edit-button edit-button-63 command-button" title="Edit Menu"><i aria-hidden="true" class="fa fa-chevron-down fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="toggle-collapse-button command-button" title="Minimize"><i aria-hidden="true" class="fa fa-minus fa-fw" style="text-align: center;"></i></a><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="remove-button command-button" title="Delete"><i aria-hidden="true" class="fa fa-remove fa-fw" style="text-align: center;"></i></a></div><div><div class="command-input previousPrompt primaryPrompt"><div class="command-text command-text-finished"><div class="command-box wrappable"><div class="codemirror-preview CodeMirror CodeMirror-wrap cm-s-eclipse-focus" data-testid="CommandInput"><div><div class="CodeMirror-gutters"></div><div class="CodeMirror-sizer"><div class="CodeMirror-lines"><pre class="CodeMirror-line"><div class="CodeMirror-gutter-wrapper"><div class="CodeMirror-linenumber">1</div></div><span> </span></pre></div></div></div></div></div></div></div><div class="results-and-comments"><div class="command-result-wrapper"><div class="command-result"><div class="spinner"></div></div></div><div style="clear: both;"></div></div></div></div></div></div></div><div class="command-cell-drop-zone"><div class="heading-command-wrapper"><div class="command divider"><a class="btn btn-default btn-circle insert-command-btn" title="Insert a new cell" tabindex="0" data-testid="AddCommandButton"><i class="fa fa-plus fa-fw" style="text-align: center;"></i></a><a class="btn btn-default btn-circle paste-command-btn hidden" title="Paste cell here"><i class="fa fa-paste fa-fw" style="text-align: center;"></i></a></div></div></div><div class="submit-hint">Shift+Enter to run&nbsp;&nbsp;&nbsp;</div><div class="contentSpacer" style="background: rgb(255, 255, 255); height: 0px;"></div><div style="min-height: 304.5px;"></div></div><div class="notebook-footer"></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="SideMenu"></uses-legacy-bootstrap></main></section><uses-legacy-bootstrap data-wrapped-element-id="CommandSelectionPopover"><div id="selection-popover" class="hidden add-comment" style="top: 268.667px; right: 50px;"><a class="btn btn-default btn-circle"><i class="fa fa-comment-o fa-fw webapp-css-20rwj2" style="text-align: center;"></i></a></div></uses-legacy-bootstrap></div></div></div></div>
    </div><uses-legacy-bootstrap data-wrapped-element-id="filebrowser-popup"><div id="filebrowser-popup" style="width: 532px; left: -476px; display: none;"><a class="ft-pin-button" href="https://community.cloud.databricks.com/?o=51032147687641#" title="Pin side panels"></a><div class="filebrowser-header">
        <span class="file-browser-header-text" title="Workspace">
          Workspace
        </span>
        <a class="btn btn-secondary file-browser-header-button js-home-button"><i class="fa fa-home fa-fw"></i> Home</a>
      </div><div class="filebrowser filetree" style="display: none;" data-state="invisible" data-history-size="30"><div class="inner"><nav class="ft-panel ui-droppable ui-resizable" aria-label="Workspace" data-panel="Workspace" style="width: 266px;"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="filetree-link" title="Workspace"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Workspace</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="filetree-link ui-droppable" title="Shared"><i class="fa fa-share-alt-square fa-fw"></i><span class="filetree-display-name">Shared</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu selected"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="filetree-link ui-droppable" title="Users"><i class="fa fa-users fa-fw"></i><span class="filetree-display-name">Users</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></nav><nav class="ft-panel ui-droppable ui-resizable" aria-label="Users" data-panel="Users" style="width: 0px;"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="filetree-link" title="Users"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">Users</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item home-folder has-menu selected"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="home-folder filetree-link ui-droppable" title="tuccio@kth.se"><i class="fa fa-home fa-fw"></i><span class="filetree-display-name"><span class="email-name">tuccio</span><span class="email-domain">@kth.se</span></span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></nav><nav class="ft-panel ui-droppable ui-resizable" aria-label="tuccio@kth.se" data-panel="tuccio@kth.se" style="width: 0px;"><ul class="ft-panel-list"><li class="filetree-list-item top-link has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#" role="button" class="filetree-link" title="tuccio@kth.se"><i class="fa fa-databricks-does-not-exist fa-fw"></i><span class="filetree-display-name">tuccio@kth.se</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-chevron-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#notebook/143751728534977" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="Quickstart Notebook (1)"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="false"></i><span class="filetree-display-name">Quickstart Notebook (1)</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#notebook/143751728534995" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="Quickstart Notebook (2)"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="false"></i><span class="filetree-display-name">Quickstart Notebook (2)</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu"><a href="https://community.cloud.databricks.com/?o=51032147687641#notebook/143751728535013" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="Quickstart Notebook (3)"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="false"></i><span class="filetree-display-name">Quickstart Notebook (3)</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li><li class="filetree-list-item has-menu selected"><a href="https://community.cloud.databricks.com/?o=51032147687641#notebook/475989419436282" role="button" class="filetree-link ui-draggable ui-draggable-handle" title="sparkml_lab"><i class="fa fa-file-text-o fa-fw" data-cluster-ready="true"></i><span class="filetree-display-name">sparkml_lab</span><div class="dropdown" tabindex="0" role="button"><i class="fa fa-caret-down"></i></div></a></li></ul><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></nav></div></div><a class="ft-scroll-angle-left" href="https://community.cloud.databricks.com/?o=51032147687641#" title="Scroll to left"><i class="fa fa-angle-left"></i></a><a class="ft-scroll-angle-right hidden" href="https://community.cloud.databricks.com/?o=51032147687641#" title="Scroll to right"><i class="fa fa-angle-right"></i></a></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="projects-filebrowser-popup"><div id="projects-filebrowser-popup" style="display: none"><div class="filebrowser" style="display: none"></div></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="searchpanel-popup"><div id="searchpanel-popup"><div class="searchpanel ui-resizable" data-panel="Search" style="display: none" data-state="invisible"><div class="search-panel-content"><a class="ft-pin-button" title="Pin side panels"></a><div class="newsearch"><input title="Search Workspace" class="newsearch searchbox" type="text" placeholder="Search Workspace" aria-label="Search Workspace"><span class="search-mixin-spinner"><i class="fa fa-spinner fa-spin" style="text-align: center;"></i></span></div><ul aria-live="polite"></ul></div><div class="ui-resizable-handle ui-resizable-e" style="z-index: 90;"></div></div></div></uses-legacy-bootstrap><div id="search-root"></div><uses-legacy-bootstrap data-wrapped-element-id="title-menu"><div id="title-menu" class="tb-title-menu dropdown-menu" role="menu"></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="hidden"><div id="hidden" style="display: none"></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="history"><div id="history" style="display: none"><div id="history-head">
  
  <h3 class="history-title">
    Recent Activity
    <i class="hide-recent-activity remove-button fa fa-remove fa-fw"></i>
  </h3>
  
</div>

<div id="history-list">
  <ul>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:45:55</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:45:21</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:44:42</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:44:14</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:41:11</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:39:53</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:39:17</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:39:00</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:37:48</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:37:24</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:37:06</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:36:38</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:36:27</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:36:14</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:35:19</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:34:56</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:34:51</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:34:23</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:32:24</p>
      </div>
    </li>
    
    <li class="history-item">
      <div class="history-user-avatar" style="background-color: #1f77b4">
        T
      </div>
      <div class="history-item-action">
        <p class="user-name">tuccio@kth.se:</p>
        <p class="user-message">Ran a command</p>
      </div>
      <div class="history-item-timestamp">
        <p>2021-11-12 10:31:52</p>
      </div>
    </li>
    
  </ul>
</div>
</div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="proxy-endpoints-conn-test-iframe"><div id="proxy-endpoints-conn-test-iframe" style="display: none"><iframe src="./sparkml_lab - Databricks Community Edition_files/proxy-endpoints-domain-conn-test.html" height="0" width="0" tabindex="-1" title="empty" class="hidden"></iframe></div></uses-legacy-bootstrap><uses-legacy-bootstrap data-wrapped-element-id="debugHelper"><div id="debugHelper" style="z-index: 1000; display: none; position: fixed; right: 190px; bottom: 0px"><div id="debugRoute" style="position: fixed; right: 190px; bottom: 40px"></div><div id="debugCounters" style="color: var(--primary-text-color); position: fixed; right: 50px; bottom: 20px"></div><a href="https://community.cloud.databricks.com/ops/">[OPS]</a> <a href="https://community.cloud.databricks.com/ops/debug">Debug</a> <a href="https://community.cloud.databricks.com/ops/metrics">Metrics</a> <a href="https://community.cloud.databricks.com/ops/requests">Requests</a></div></uses-legacy-bootstrap><script>function addPrefetches(paths) {
        paths.forEach(path => {
          var element = document.createElement('link');
          element.rel = 'prefetch';
          element.href = path;
          document.getElementsByTagName('head')[0].appendChild(element);
        })
      }
      setTimeout(() => {
        addPrefetches(["/media/spinner_green.b9455049.svg","/media/spinner_red.e709549b.svg","/media/pin-inactive.20f63293.svg","/media/pin-active.b76ded7a.svg","/media/jupyter_favicon.3567d082.svg","/media/azure_devops_logo_hover.4f1e3fd4.svg","/media/azure_devops_logo.8e2ba35d.svg","/media/glyphicons-halflings.25163399.png","/media/newslablight-webfont.9b543473.eot","/media/newslablight-webfont.69cfbff8.woff2","/media/newslablight-webfont.a432b296.woff","/media/newslablight-webfont.ac42ae0f.ttf","/media/newslablight-webfont.947cf4d7.svg","/media/databricks-regular-webfont.421acd19.eot","/media/databricks-regular-webfont.ffd92669.woff","/media/databricks-regular-webfont.ab15115e.ttf","/media/databricks-regular-webfont.9c3c6e3b.svg","/media/fontawesome-webfont.f7c2b4b7.eot","/media/fontawesome-webfont.d9ee23d5.woff","/media/fontawesome-webfont.706450d7.ttf","/media/fontawesome-webfont.29800836.svg","/media/fontawesome-webfont.674f50d2.eot","/media/fontawesome-webfont.af7ae505.woff2","/media/fontawesome-webfont.fee66e71.woff","/media/fontawesome-webfont.b06871f2.ttf","/media/fontawesome-webfont.912ec66d.svg","/media/KaTeX_AMS-Regular.3d8245dc.woff2","/media/KaTeX_AMS-Regular.ac1d46d9.woff","/media/KaTeX_AMS-Regular.c67be87a.ttf","/media/KaTeX_Caligraphic-Bold.970d3e76.woff2","/media/KaTeX_Caligraphic-Bold.445f96a3.woff","/media/KaTeX_Caligraphic-Bold.3f61a84d.ttf","/media/KaTeX_Caligraphic-Regular.0ef0f2e3.woff2","/media/KaTeX_Caligraphic-Regular.74f6918c.woff","/media/KaTeX_Caligraphic-Regular.c3bc8fce.ttf","/media/KaTeX_Fraktur-Bold.950649ba.woff2","/media/KaTeX_Fraktur-Bold.1aca7ef7.woff","/media/KaTeX_Fraktur-Bold.e11e6bf0.ttf","/media/KaTeX_Fraktur-Regular.135ccd74.woff2","/media/KaTeX_Fraktur-Regular.c5b430bf.woff","/media/KaTeX_Fraktur-Regular.a9509497.ttf","/media/KaTeX_Main-Bold.82bce349.woff2","/media/KaTeX_Main-Bold.29d4b276.woff","/media/KaTeX_Main-Bold.db576c7d.ttf","/media/KaTeX_Main-BoldItalic.13900e55.woff2","/media/KaTeX_Main-BoldItalic.3f3be43b.woff","/media/KaTeX_Main-BoldItalic.cec43f72.ttf","/media/KaTeX_Main-Italic.b488f60f.woff2","/media/KaTeX_Main-Italic.f8a75448.woff","/media/KaTeX_Main-Italic.85b3329f.ttf","/media/KaTeX_Main-Regular.999cd6ba.woff2","/media/KaTeX_Main-Regular.485696cf.woff","/media/KaTeX_Main-Regular.f4fe6dca.ttf","/media/KaTeX_Math-Italic.7a31741a.woff2","/media/KaTeX_Math-Italic.8eb56b3f.woff","/media/KaTeX_Math-Italic.10740d74.ttf","/media/KaTeX_SansSerif-Bold.0d0f967a.woff2","/media/KaTeX_SansSerif-Bold.99bd8743.woff","/media/KaTeX_SansSerif-Bold.771a1f95.ttf","/media/KaTeX_SansSerif-Italic.b1ac79b9.woff2","/media/KaTeX_SansSerif-Italic.9c3f03ec.woff","/media/KaTeX_SansSerif-Italic.cb729d47.ttf","/media/KaTeX_SansSerif-Regular.23f1730f.woff2","/media/KaTeX_SansSerif-Regular.fc908397.woff","/media/KaTeX_SansSerif-Regular.43b0cb92.ttf","/media/KaTeX_Script-Regular.ae1fad1f.woff2","/media/KaTeX_Script-Regular.60febfa1.woff","/media/KaTeX_Script-Regular.e9169ca7.ttf","/media/KaTeX_Size1-Regular.fda0824e.woff2","/media/KaTeX_Size1-Regular.1d6cf6b8.woff","/media/KaTeX_Size1-Regular.f2e296ef.ttf","/media/KaTeX_Size2-Regular.a7a0eb93.woff2","/media/KaTeX_Size2-Regular.f48e83b7.woff","/media/KaTeX_Size2-Regular.0767ede6.ttf","/media/KaTeX_Size3-Regular.397bd687.woff2","/media/KaTeX_Size3-Regular.0387ab38.woff","/media/KaTeX_Size3-Regular.882f7234.ttf","/media/KaTeX_Size4-Regular.3c14ed11.woff2","/media/KaTeX_Size4-Regular.726db3bd.woff","/media/KaTeX_Size4-Regular.27901d5c.ttf","/media/KaTeX_Typewriter-Regular.895baecf.woff2","/media/KaTeX_Typewriter-Regular.696705de.woff","/media/KaTeX_Typewriter-Regular.6374f53e.ttf","/media/mrl8jkM18OlOQN8JLgasD4a1YDtoarzwSXxTHggEXMw.38bca7eb.woff2","/media/mrl8jkM18OlOQN8JLgasD5bPFduIYtoLzwST68uhz_Y.72b61933.woff2","/media/leqv3v-yTsJNC7nFznSMqe4s1Ux4PuImWPk5fSr6HPL3rGVtsTkPsbDajuO5ueQw.e82262e6.woff2","/media/leqv3v-yTsJNC7nFznSMqZkF8H8ye47wsfpWywda8og.5e7f98de.woff2","/media/spritemap.a012b1b1.png","/media/spritemap@2x.cfe9d800.png","/media/bmt-favicon.24e70a2e.ico","/media/spinner.7eb0071e.svg","/media/BMT_logo_large.55205282.svg","/media/databricks_community_edition.4b5df8f5.png","/media/ml_dashboard_ill_reference_solutions.c74a54c9.svg","/media/ml_dashboard_ill_notebook.db945e2d.svg","/media/ml_dashboard_ill_training.18f44263.svg","/media/ml_dashboard_ill_automl.69cb20ad.svg","/media/persona_nav.d621ebcf.gif","/media/import_illustration.a8f8f5b5.svg","/media/notebook_illustration.0ed82de6.svg","/media/quickstart_illustration.8855f289.svg","/media/references_illustration.dfe73a7e.svg","/media/mlflow_notebook_revision_icon.fb30c75b.svg","/media/mlflow_cluster_spec_icon.e1a9d318.svg","/media/mlflow_cluster_libraries_icon.1e1bbbe8.svg","/media/if_lightbulb.32b79969.svg","/media/ellipse-2s-30px.d5e7584e.gif","/media/us-map.be17f64a.json","/media/world-map.733c99c2.json","/media/countries.geo.5db0e8c2.json","/media/usa-albers.geo.1cf0a200.json","/media/japan.prefectures.geo.069f1b22.json","/media/General_icon.e1d0c7d0.svg","/media/Python_icon.26f13d73.svg","/media/R_icon.9b70c497.svg","/media/Scala_icon.bf5e6302.svg","/media/add_data_icon.84c14774.svg","/media/code_icon.db13a367.svg","/media/help_doc_icon.cc60a36f.svg","/media/icon-import-data.e32bacc6.svg","/media/icon-new-notebook.b1dacb7d.svg","/media/icon-quickstart-notebook.6697345f.svg","/media/icon-upload-data-non-drop-zone.a8a27e15.svg","/media/icon-upload-data.38e1c933.svg","/media/antd.bcd37934.css","/media/collapsingAllIcon.ea2ba3e2.svg","/media/expandingAllIcon.283f7837.svg","/media/fa-table.2e493944.svg","/media/fa-columns.5d83e3d5.svg","/media/circle_error.8849b329.svg","/media/spinner_blue.5bbd1389.svg","/media/book.62733eae.svg","/media/cloud.1390841c.svg","/media/cluster.86641204.svg","/media/folder.3e1ec9d1.svg","/media/table.7d5d5c93.svg","/media/blocked.45685ab0.svg","/media/cancelled.4bc27f62.svg","/media/failed.c99465d9.svg","/media/paused.8a47333a.svg","/media/pending.d8c4da3b.svg","/media/running.e7c53db1.svg","/media/skipped.aef55ce4.svg","/media/success.3e049e69.svg","/media/terminated.f4228a0e.svg","/media/timed_out.d157a510.svg","/media/waiting.f0a3fcaf.svg","/media/warning.1bba9d60.svg","/media/filled-green-circle.9c2a21ef.svg","/media/filled-gray-circle.e6721f2a.svg","/media/data-quality.c8deeaa9.svg","/media/stitch.ef1319b5.svg","/media/fivetran.3e6c82f5.png","/media/qlik.87633461.png","/media/infoworks.ad724fa0.png","/media/streamsets.b85b03e8.png","/media/syncsort.11608e03.jpg","/media/placeholder_pic.4788048f.png","/media/view_notebook_revision.60fa88c5.svg","/media/logged_model.52a4e455.svg","/media/registered_model.8745ea83.svg","/login/login.01615f82.js","/js/main.04ca75c7.js","/js/metrics-graphics.8c6e7309.js","/static/media/spinner.gif","/login/DB_Azure_Lockup_2x.png","/login/bootstrap.min.css","/login/databricks_ce_icon.svg","/login/databricks_logoTM_rgb_TM.svg","/login/favicon.ico","/login/logo_2020/azure_databricks.png","/login/logo_2020/databricks.svg","/login/logo_2020/databricks_community_edition.png","/delta_sharing/databricks.svg","/delta_sharing/download.svg","/delta_sharing/retrieve_config.html","/delta_sharing/sharing.css","/delta_sharing/sharing.js","/delta_sharing/logo/apachespark.png","/delta_sharing/logo/atscale.png","/delta_sharing/logo/azuresynapse.png","/delta_sharing/logo/bigquery.png","/delta_sharing/logo/databricks.png","/delta_sharing/logo/dremio.png","/delta_sharing/logo/looker.png","/delta_sharing/logo/pandas.png","/delta_sharing/logo/powerbi.png","/delta_sharing/logo/presto.png","/delta_sharing/logo/python.png","/delta_sharing/logo/qlik.png","/delta_sharing/logo/starburst.png","/delta_sharing/logo/tableau.png","/delta_sharing/logo/trino.png","/static/iframe.html","/static/css/sparkui-iframe.css","/static/js/heap/heap-1473692602.js","/static/js/heap/heap-210092139.js","/static/js/heap/heap-3428506230.js","/login/3077.b927db57.chunk.css","/css/2651.8f007618.chunk.css","/login/7350.5e4b0092.chunk.js","/login/737.70b5f1a6.chunk.js","/css/6098.66f4e205.chunk.css","/css/5463.7317c73b.chunk.css","/css/GraphqlClustersGetPage.e5ed6c09.chunk.css","/css/NewClustersEditPage.f9d27361.chunk.css","/css/ClustersMainPage.5bac6c88.chunk.css","/css/SimpleClusterCreatePage.f9d27361.chunk.css","/css/ClustersCreatePage.f9d27361.chunk.css","/css/PoolRoutesPages.2d460e38.chunk.css","/css/ClusterPoliciesRouteUtils.5bac6c88.chunk.css","/css/AdminConsoleView.588802ae.chunk.css","/css/UserSettingsView.b3d41c61.chunk.css","/css/LibraryView.422f590b.chunk.css","/css/ClustersGetMetricsPage.f9d27361.chunk.css","/css/JobCreatePage.ca65da6a.chunk.css","/css/JobClusterPage.f9d27361.chunk.css","/css/QueryJobDetailsPage.ca65da6a.chunk.css","/css/JobViewWithGraphql.f9d27361.chunk.css","/css/JobsMainPage.9edf7d02.chunk.css","/css/PipelineDetailsPage.b7ebe9a2.chunk.css","/css/MLDashboardPage.2dffe569.chunk.css","/css/ExperimentObservatoryPage.79e545d3.chunk.css","/css/AutoMLConfigurationPage.a5fb753e.chunk.css","/css/CreateMlflowExperimentPage.93e07247.chunk.css","/css/LatestJobRunViewContainer.20334262.chunk.css","/css/JobRunView.20334262.chunk.css","/css/ReactNotebookView.c32ea7d2.chunk.css","/css/ScheduleLink.b6cfefd1.chunk.css","/css/DashboardEditView.5eb76997.chunk.css","/css/DashboardPresentView.de6a5e8b.chunk.css","/css/TableGetPage.a5fb753e.chunk.css","/css/8848.f9d27361.chunk.css","/css/9708.a5fb753e.chunk.css","/css/2694.18fe782c.chunk.css","/css/4473.18fe782c.chunk.css","/css/3641.7d0a57ea.chunk.css","/css/6662.035b535e.chunk.css","/css/5061.3223f1fe.chunk.css","/css/2510.90a8b767.chunk.css","/css/9749.e636248e.chunk.css","/css/7236.f0a63aed.chunk.css","/css/5334.6c0c1860.chunk.css","/login/9135.615fe693.chunk.css","/css/554.3d36fa44.chunk.css","/css/7856.670e4c0b.chunk.css","/login/9624.7d6c7d60.chunk.css","/login/3077.a124ec08.chunk.js","/login/8188.c7a4b3b5.chunk.js","/login/4963.872a6506.chunk.js","/js/2651.e758324e.chunk.js","/login/2176.385c81d2.chunk.js","/login/8705.e5c47eb7.chunk.js","/js/2542.451b603d.chunk.js","/js/6098.016214ed.chunk.js","/js/5463.9b84f06c.chunk.js","/js/6471.92998f3a.chunk.js","/js/4602.68fc4997.chunk.js","/js/2851.a800e6b3.chunk.js","/js/7028.b63f75b7.chunk.js","/js/9463.543cce73.chunk.js","/js/7274.76443fa2.chunk.js","/js/8540.3771363c.chunk.js","/js/3235.c207d1ec.chunk.js","/js/5198.e9a1d977.chunk.js","/js/9152.3e58f157.chunk.js","/js/6362.33242795.chunk.js","/js/7032.28b1c9d1.chunk.js","/js/2662.7f44c2cc.chunk.js","/js/1511.d6892fe7.chunk.js","/js/5355.41580bc9.chunk.js","/js/7176.52b8c28a.chunk.js","/js/9946.a5cdd01e.chunk.js","/js/1730.1851bdf0.chunk.js","/js/2532.fb6dde15.chunk.js","/js/5489.e65cb5a3.chunk.js","/js/8513.729f6df8.chunk.js","/js/7676.eff12f55.chunk.js","/js/3214.e1a18c35.chunk.js","/js/2667.5a9cca2f.chunk.js","/js/3637.c0e05156.chunk.js","/js/2689.36e72a21.chunk.js","/js/9981.51246884.chunk.js","/js/5197.446dac22.chunk.js","/js/8732.a800484c.chunk.js","/js/3449.b623cf26.chunk.js","/js/199.9e607c2d.chunk.js","/js/3345.506cffce.chunk.js","/js/8553.1415e205.chunk.js","/js/6595.e1de59c8.chunk.js","/js/419.e11acb40.chunk.js","/js/2380.d15f58d8.chunk.js","/js/80.d7d62d5c.chunk.js","/js/5070.9a493618.chunk.js","/js/8571.828d2cb0.chunk.js","/js/7749.e9e838df.chunk.js","/js/9957.79ba18a5.chunk.js","/js/7994.68bbe55c.chunk.js","/js/2882.225d0ae8.chunk.js","/js/8985.0b5a78e1.chunk.js","/js/4227.c0d821b6.chunk.js","/js/8848.89a705c0.chunk.js","/js/9708.344870d5.chunk.js","/js/4473.e8f4094b.chunk.js","/js/6808.208fe661.chunk.js","/js/5225.29d1a599.chunk.js","/js/6439.09246fa7.chunk.js","/js/6665.c1e21397.chunk.js","/js/5896.ee48b333.chunk.js","/js/3878.9114c018.chunk.js","/js/4724.05d6c913.chunk.js","/js/2135.b0757e86.chunk.js","/js/8671.8fbf1327.chunk.js","/js/3814.c1c32bef.chunk.js","/js/3837.5f26bfe8.chunk.js","/js/2510.517b95f1.chunk.js","/js/9424.2d099a91.chunk.js","/js/8590.6abf8139.chunk.js","/js/1076.a1004b85.chunk.js","/js/8917.7b705201.chunk.js","/js/7945.c1c01e0c.chunk.js","/js/6699.c1fa4397.chunk.js","/js/4424.3b97b4b6.chunk.js","/js/239.dddbc557.chunk.js","/js/810.24654a4d.chunk.js","/login/9135.f3a6fd9c.chunk.js","/js/5755.00c3d7c1.chunk.js","/js/7856.2b700517.chunk.js","/js/4814.44e1d203.chunk.js","/js/4039.3d72e643.chunk.js","/js/2995.49181536.chunk.js","/js/589.25332a71.chunk.js","/login/5847.617d845e.chunk.js","/js/2614.e606d2aa.chunk.js","/js/9063.605b3b0f.chunk.js","/js/5039.68fdfb2f.chunk.js","/js/7504.e6165f62.chunk.js","/js/7989.4625af04.chunk.js","/js/9465.f3abc6f9.chunk.js","/js/4395.7fd1a817.chunk.js","/js/4176.6618c416.chunk.js","/js/1015.0c049aee.chunk.js","/js/4612.72dbb94d.chunk.js","/js/4202.0b476fbb.chunk.js","/js/5785.72eb2ef7.chunk.js","/js/1317.8e8215d5.chunk.js","/js/1829.edc5b96f.chunk.js","/js/17.7178e9c7.chunk.js","/js/1415.5ec956fc.chunk.js","/js/3710.3c677576.chunk.js","/js/6189.65c23c24.chunk.js","/js/4903.c29ec2c8.chunk.js","/js/3517.7bd3284b.chunk.js","/js/2953.130798dd.chunk.js","/js/9994.398a6187.chunk.js","/js/5433.00ecc46e.chunk.js","/js/423.8bd9f204.chunk.js","/js/1418.9ac5becd.chunk.js","/js/8973.cd76cfcf.chunk.js","/js/6985.08417690.chunk.js","/js/2861.e9d0323e.chunk.js","/js/3749.2cc88e07.chunk.js","/login/9624.1f3899a9.chunk.js","/js/3152.621b63d8.chunk.js","/js/3184.565dbfbe.chunk.js","/js/1280.f7706909.chunk.js","/js/6446.53621af3.chunk.js","/js/3143.d47d85d7.chunk.js","/js/7784.9f9181d8.chunk.js","/js/7807.5048a39e.chunk.js","/js/8055.bb245188.chunk.js","/js/9013.da3ad328.chunk.js","/favicon.ico","/login.html",])
      }, 30000)</script><div id="emotion-container-webapp-css"><style data-emotion="webapp-css" data-s=""></style><style data-emotion="webapp-css" data-s=""></style></div><script src="./sparkml_lab - Databricks Community Edition_files/main.04ca75c7.js.download"></script><uses-legacy-bootstrap><div class="filebrowser-context-menu dropdown-menu active" tabindex="-1" data-id="475989419436275" role="menu" style="display: none; left: 688px; top: 114px;"><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Clone">Clone</a></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Rename">Rename</a></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Move">Move</a></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Delete">Delete</a></li><li class="dropdown-submenu"><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Export">Export</a><ul class="dropdown-menu"><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="DBC Archive">DBC Archive</a></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Source File">Source File</a></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="HTML">HTML</a></li></ul></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Permissions" disabled="true">Permissions</a></li><li role="separator" class="divider"></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Copy File Path">Copy File Path</a></li><li><a href="https://community.cloud.databricks.com/?o=51032147687641#" data-name="Open in New Tab">Open in New Tab<span class="shortcut">CTRL+CLICK</span></a></li></div></uses-legacy-bootstrap><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><input type="file" class="dz-hidden-input" accept=".dbc, .scala, .py, .sql, .r, .ipynb, .Rmd, .html, .zip" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><input type="file" multiple="multiple" class="dz-hidden-input" style="visibility: hidden; position: absolute; top: 0px; left: 0px; height: 0px; width: 0px;"><div class="ReactModalPortal"></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="rc-tooltip rc-tooltip-placement-bottom  rc-tooltip-hidden" style="left: 27px; top: 76px;"><div class="rc-tooltip-content"><div class="rc-tooltip-arrow"></div><div class="rc-tooltip-inner" role="tooltip">Attached to cluster: lab1_scala, 15.25 GB | 2 Cores | DBR 10.0 ML | Spark 3.2.0 | Scala 2.12</div></div></div></div></div><uses-legacy-bootstrap>
          
        </uses-legacy-bootstrap><style></style></body></html>